<!DOCTYPE html><html lang="zh-CN"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><meta name="author" content="垚"><title>一些有用的文档：2020-5-12 %版 · 无存在感小透明</title><meta name="description" content="GitHub地址
公式部分请见Github
2020.5.12
2023.4.23

前言一份可以用于 ACM 和 OI 的模版，有问题或建议请留言QAQ
不断更新（挖坑）中
感谢付老师、小黄老师、郑老师和 QDD 的大力滋兹，Orz%%%

目录
2020-5-12 %版
前言
目录
基础
通用模"><meta name="keywords"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="mobile-web-app-capable"><meta content="black" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="renderer" content="webkit"><link rel="short icon" href="/images/favicon.png" type="image/x-icon"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/blog_basic.css"><link rel="stylesheet" href="/css/font-awesome.min.css"><link rel="alternate" type="application/atom+xml" title="ATOM 1.0" href="/atom.xml"><meta name="generator" content="Hexo 4.2.1"></head><body><div class="sidebar animated fadeInDown"><div class="logo-title"><div class="title"><img src="/images/logo.png" style="width:180px;"><h3 title=""><a href="/">无存在感小透明</a></h3><div class="description"><p>(✿╹◡╹) 相信的心就是你的魔法 (╹◡╹✿)</p></div></div></div><ul class="social-links"><li><a href="https://twitter.com/dongshunyao" target="_blank" rel="noopener"><i class="fa fa-twitter"></i></a></li><li><a href="https://github.com/dongshunyao" target="_blank" rel="noopener"><i class="fa fa-github"></i></a></li><li><a href="https://t.me/yao2333" target="_blank" rel="noopener"><i class="fa fa-telegram"></i></a></li><li><a href="mailto:dongshunyao@qq.com"><i class="fa fa-envelope"></i></a></li><li><a href="/rss2.xml"><i class="fa fa-rss"></i></a></li><li><a href="/atom.xml"><i class="fa fa-rss-square"></i></a></li></ul><div class="footer"><span>Time To</span><div class="by_farbox"><span>Mix Drink && Change Life</span></div></div></div><div class="main"><div class="page-top animated fadeInDown"><div class="nav"><li><a href="/">首页</a></li><li><a href="/archives">文章</a></li><li><a href="/about">关于</a></li><li><a href="/links">友链</a></li></div><div class="information"><div class="back_btn"><li><a class="fa fa-chevron-left" onclick="window.history.go(-1)"> </a></li></div><div class="avatar"><img src="/images/favicon.png"></div></div></div><div class="autopagerize_page_element"><div class="content"><div class="post-page"><div class="post animated fadeInDown"><div class="post-title"><h2><a>一些有用的文档：2020-5-12 %版</a></h2></div><div class="post-content"><p><a href="https://github.com/dongshunyao/some-useful-documents" target="_blank" rel="noopener">GitHub地址</a></p>
<p><strong>公式部分请见Github</strong></p>
<p><em>2020.5.12</em></p>
<p><em>2023.4.23</em></p>
<hr>
<h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p><em>一份可以用于 ACM 和 OI 的模版，有问题或建议请留言QAQ</em></p>
<p><em>不断更新（<del>挖坑</del>）中</em></p>
<p><em>感谢付老师、小黄老师、郑老师和 QDD 的大力滋兹，Orz%%%</em></p>
<hr>
<h3 id="目录"><a href="#目录" class="headerlink" title="目录"></a>目录</h3><ul>
<li><a href="#2020-5-12-版">2020-5-12 %版</a><ul>
<li><a href="#前言">前言</a></li>
<li><a href="#目录">目录</a></li>
<li><a href="#基础">基础</a><ul>
<li><a href="#通用模版">通用模版</a></li>
<li><a href="#性能测试">性能测试</a></li>
<li><a href="#玄学优化">玄学优化</a></li>
<li><a href="#手动扩栈">手动扩栈</a></li>
<li><a href="#输入输出">输入输出</a><ul>
<li><a href="#特殊格式与转换">特殊格式与转换</a></li>
<li><a href="#精度控制">精度控制</a></li>
<li><a href="#挂">挂</a></li>
</ul>
</li>
<li><a href="#参考">参考</a><ul>
<li><a href="#ascii表">ASCII表</a></li>
<li><a href="#常用数表">常用数表</a></li>
<li><a href="#时间复杂度与数据规模">时间复杂度与数据规模</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#数学">数学</a><ul>
<li><a href="#常用网站">常用网站</a></li>
<li><a href="#数学理论">数学理论</a><ul>
<li><a href="#负数求余">负数求余</a></li>
<li><a href="#组合数">组合数</a></li>
<li><a href="#错位排列数">错位排列数</a></li>
<li><a href="#威尔逊定理">威尔逊定理</a></li>
<li><a href="#费马小定理">费马小定理</a></li>
<li><a href="#费马大定理">费马大定理</a></li>
<li><a href="#哥德巴赫猜想">哥德巴赫猜想</a></li>
<li><a href="#勾股数">勾股数</a></li>
<li><a href="#抽屉原理">抽屉原理</a></li>
<li><a href="#欧拉公式">欧拉公式</a></li>
</ul>
</li>
<li><a href="#欧几里德算法">欧几里德算法</a><ul>
<li><a href="#最大公约数-gcd">最大公约数 GCD</a></li>
<li><a href="#扩展欧几里德算法-exgcd">扩展欧几里德算法 EXGCD</a></li>
</ul>
</li>
<li><a href="#欧拉">欧拉</a><ul>
<li><a href="#欧拉函数">欧拉函数</a><ul>
<li><a href="#定义">定义</a></li>
<li><a href="#性质">性质</a></li>
<li><a href="#求法">求法</a><ul>
<li><a href="#直接求">直接求</a></li>
<li><a href="#线性筛法">线性筛法</a></li>
<li><a href="#递推法">递推法</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#欧拉定理">欧拉定理</a></li>
<li><a href="#欧拉降幂">欧拉降幂</a></li>
<li><a href="#欧拉路径">欧拉路径</a><ul>
<li><a href="#欧拉回路">欧拉回路</a></li>
<li><a href="#欧拉路径-1">欧拉路径</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#杜教筛">杜教筛</a></li>
<li><a href="#扩展大步小步-baby-steps-giant-steps">扩展大步小步 Baby Steps Giant Steps</a></li>
<li><a href="#二次剩余">二次剩余</a></li>
<li><a href="#快速傅里叶变换-fft">快速傅里叶变换 FFT</a><ul>
<li><a href="#多项式乘法">多项式乘法</a></li>
<li><a href="#相同位数整数乘法">相同位数整数乘法</a></li>
<li><a href="#任意整数乘法">任意整数乘法</a></li>
</ul>
</li>
<li><a href="#快速幂">快速幂</a></li>
<li><a href="#斐波那契数列">斐波那契数列</a></li>
<li><a href="#素数">素数</a><ul>
<li><a href="#试商法">试商法</a></li>
<li><a href="#打表法">打表法</a></li>
</ul>
</li>
<li><a href="#素因子">素因子</a><ul>
<li><a href="#直接求-1">直接求</a></li>
<li><a href="#打表法-1">打表法</a></li>
</ul>
</li>
<li><a href="#逆元">逆元</a><ul>
<li><a href="#定义-1">定义</a></li>
<li><a href="#求法-1">求法</a><ul>
<li><a href="#费马小定理-1">费马小定理</a></li>
<li><a href="#扩展欧几里得法">扩展欧几里得法</a></li>
<li><a href="#打表法-2">打表法</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#中国剩余定理">中国剩余定理</a></li>
<li><a href="#整数运算">整数运算</a><ul>
<li><a href="#大整数">大整数</a></li>
<li><a href="#自动取模">自动取模</a></li>
</ul>
</li>
<li><a href="#求n的最后一位的非0数">求N!的最后一位的非0数</a></li>
<li><a href="#星期问题">星期问题</a></li>
<li><a href="#计算几何">计算几何</a><ul>
<li><a href="#pick-公式">Pick 公式</a></li>
<li><a href="#已知圆锥表面积s求最大体积v">已知圆锥表面积S求最大体积V</a></li>
<li><a href="#常用">常用</a></li>
<li><a href="#凸多边形宽度">凸多边形宽度</a></li>
<li><a href="#凸包图形交点交线数学半平面交">凸包,图形,交点,交线,数学,半平面交</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#二进制">二进制</a><ul>
<li><a href="#状态压缩">状态压缩</a></li>
<li><a href="#lowbit函数">lowbit函数</a></li>
</ul>
</li>
<li><a href="#动态规划-dp">动态规划 DP</a></li>
<li><a href="#二分">二分</a></li>
<li><a href="#三分">三分</a></li>
<li><a href="#数据结构">数据结构</a><ul>
<li><a href="#并查集">并查集</a></li>
<li><a href="#单调栈">单调栈</a></li>
<li><a href="#区间最值查询-rmq">区间最值查询 RMQ</a></li>
</ul>
</li>
<li><a href="#字符串">字符串</a><ul>
<li><a href="#最长回文串">最长回文串</a></li>
<li><a href="#hash处理">Hash处理</a><ul>
<li><a href="#全字符集">全字符集</a></li>
<li><a href="#小写字母集">小写字母集</a></li>
</ul>
</li>
<li><a href="#字符串匹配">字符串匹配</a><ul>
<li><a href="#kmp">KMP</a></li>
<li><a href="#扩展kmp">扩展KMP</a></li>
<li><a href="#ac自动机">AC自动机</a><ul>
<li><a href="#快速版">快速版</a></li>
<li><a href="#完整版">完整版</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#最长上升子序列-lis">最长上升子序列 LIS</a><ul>
<li><a href="#动态规划">动态规划</a></li>
<li><a href="#二分查找优化">二分查找优化</a></li>
</ul>
</li>
<li><a href="#后缀数组">后缀数组</a></li>
<li><a href="#编辑距离">编辑距离</a><ul>
<li><a href="#定义-2">定义</a></li>
<li><a href="#解法">解法</a></li>
<li><a href="#实现">实现</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#排序">排序</a><ul>
<li><a href="#快速排序">快速排序</a></li>
<li><a href="#归并排序">归并排序</a></li>
</ul>
</li>
<li><a href="#搜索">搜索</a><ul>
<li><a href="#n皇后">N皇后</a></li>
<li><a href="#bfs-队列版本">BFS 队列版本</a></li>
</ul>
</li>
<li><a href="#c">C++</a><ul>
<li><a href="#引用">引用</a></li>
<li><a href="#范围for">范围for</a></li>
<li><a href="#列表">列表</a></li>
<li><a href="#二进制读写">二进制读写</a></li>
<li><a href="#头文件">头文件</a><ul>
<li><a href="#-__builtin--内建函数">&lt; __builtin &gt; 内建函数</a></li>
<li><a href="#-cmath--数学函数">&lt; cmath &gt; 数学函数</a></li>
<li><a href="#-random--随机函数">&lt; random &gt; 随机函数</a></li>
<li><a href="#-cctype--字符类型">&lt; cctype &gt; 字符类型</a></li>
<li><a href="#-cstring--c字符串">&lt; cstring &gt; C字符串</a></li>
<li><a href="#-algorithm--算法">&lt; algorithm &gt; 算法</a></li>
<li><a href="#-numeric--数值序列">&lt; numeric &gt; 数值序列</a></li>
<li><a href="#-utility--二元组">&lt; utility &gt; 二元组</a></li>
<li><a href="#-string--字符串">&lt; string &gt; 字符串</a></li>
<li><a href="#-bitset--01数组">&lt; bitset &gt; 01数组</a></li>
<li><a href="#-iterator--迭代器">&lt; iterator &gt; 迭代器</a></li>
<li><a href="#-vector--动态数组">&lt; vector &gt; 动态数组</a></li>
<li><a href="#-map--映射表">&lt; map &gt; 映射表</a></li>
<li><a href="#-set--集合">&lt; set &gt; 集合</a></li>
<li><a href="#-stack--栈">&lt; stack &gt; 栈</a></li>
<li><a href="#-queue-队列">&lt; queue&gt; 队列</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#python">Python</a><ul>
<li><a href="#输入">输入</a></li>
</ul>
</li>
<li><a href="#留坑">留坑</a></li>
</ul>
</li>
</ul>
<hr>
<h3 id="基础"><a href="#基础" class="headerlink" title="基础"></a>基础</h3><h4 id="通用模版"><a href="#通用模版" class="headerlink" title="通用模版"></a>通用模版</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> endl <span class="meta-string">"\n"</span> <span class="comment">//防止卡endl</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rg register int <span class="comment">//循环变量专用</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> GCC optimize(<span class="meta-string">"Ofast,no-stack-protector"</span>) <span class="comment">//神仙优化，比较假</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stack&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;map&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;ctime&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    freopen(<span class="string">"input.in"</span>, <span class="string">"r"</span>, <span class="built_in">stdin</span>);</span><br><span class="line">    freopen(<span class="string">"output.out"</span>, <span class="string">"w"</span>, <span class="built_in">stdout</span>);</span><br><span class="line">    </span><br><span class="line">    ios::sync_with_stdio(<span class="literal">false</span>); <span class="comment">//cin、cout不能与scanf、printf混用 </span></span><br><span class="line">    <span class="built_in">cin</span>.tie(<span class="number">0</span>); <span class="comment">//输入一定要在输出之前</span></span><br><span class="line">    <span class="built_in">cout</span>.tie(<span class="number">0</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%.5lf"</span>, (<span class="keyword">double</span>)clock() / CLOCKS_PER_SEC);<span class="comment">//输出时间</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<hr>
<h4 id="性能测试"><a href="#性能测试" class="headerlink" title="性能测试"></a>性能测试</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//用已经AC了的题交这个代码，以测试评测机性能</span></span><br><span class="line"><span class="keyword">int</span> a;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">1000000000</span>; i++) a ^= i;</span><br><span class="line"><span class="built_in">cout</span> &lt;&lt; a;</span><br></pre></td></tr></table></figure>

<hr>
<h4 id="玄学优化"><a href="#玄学优化" class="headerlink" title="玄学优化"></a>玄学优化</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> GCC optimize (<span class="meta-string">"O3"</span>) <span class="comment">//开O3</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> GCC -mcmodle=large <span class="comment">//开巨型数组不RE(编译时间变长)</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 以下慎用</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> GCC optimize(2)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> GCC optimize(3)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> GCC optimize(<span class="meta-string">"Ofast"</span>)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> GCC optimize(<span class="meta-string">"inline"</span>)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> GCC optimize(<span class="meta-string">"-fgcse"</span>)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> GCC optimize(<span class="meta-string">"-fgcse-lm"</span>)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> GCC optimize(<span class="meta-string">"-fipa-sra"</span>)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> GCC optimize(<span class="meta-string">"-ftree-pre"</span>)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> GCC optimize(<span class="meta-string">"-ftree-vrp"</span>)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> GCC optimize(<span class="meta-string">"-fpeephole2"</span>)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> GCC optimize(<span class="meta-string">"-ffast-math"</span>)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> GCC optimize(<span class="meta-string">"-fsched-spec"</span>)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> GCC optimize(<span class="meta-string">"unroll-loops"</span>)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> GCC optimize(<span class="meta-string">"-falign-jumps"</span>)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> GCC optimize(<span class="meta-string">"-falign-loops"</span>)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> GCC optimize(<span class="meta-string">"-falign-labels"</span>)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> GCC optimize(<span class="meta-string">"-fdevirtualize"</span>)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> GCC optimize(<span class="meta-string">"-fcaller-saves"</span>)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> GCC optimize(<span class="meta-string">"-fcrossjumping"</span>)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> GCC optimize(<span class="meta-string">"-fthread-jumps"</span>)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> GCC optimize(<span class="meta-string">"-funroll-loops"</span>)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> GCC optimize(<span class="meta-string">"-freorder-blocks"</span>)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> GCC optimize(<span class="meta-string">"-fschedule-insns"</span>)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> GCC optimize(<span class="meta-string">"inline-functions"</span>)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> GCC optimize(<span class="meta-string">"-ftree-tail-merge"</span>)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> GCC optimize(<span class="meta-string">"-fschedule-insns2"</span>)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> GCC optimize(<span class="meta-string">"-fstrict-aliasing"</span>)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> GCC optimize(<span class="meta-string">"-falign-functions"</span>)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> GCC optimize(<span class="meta-string">"-fcse-follow-jumps"</span>)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> GCC optimize(<span class="meta-string">"-fsched-interblock"</span>)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> GCC optimize(<span class="meta-string">"-fpartial-inlining"</span>)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> GCC optimize(<span class="meta-string">"no-stack-protector"</span>)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> GCC optimize(<span class="meta-string">"-freorder-functions"</span>)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> GCC optimize(<span class="meta-string">"-findirect-inlining"</span>)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> GCC optimize(<span class="meta-string">"-fhoist-adjacent-loads"</span>)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> GCC optimize(<span class="meta-string">"-frerun-cse-after-loop"</span>)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> GCC optimize(<span class="meta-string">"inline-small-functions"</span>)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> GCC optimize(<span class="meta-string">"-finline-small-functions"</span>)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> GCC optimize(<span class="meta-string">"-ftree-switch-conversion"</span>)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> GCC optimize(<span class="meta-string">"-foptimize-sibling-calls"</span>)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> GCC optimize(<span class="meta-string">"-fexpensive-optimizations"</span>)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> GCC optimize(<span class="meta-string">"inline-functions-called-once"</span>)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> GCC optimize(<span class="meta-string">"-fdelete-null-pointer-checks"</span>)</span></span><br></pre></td></tr></table></figure>

<hr>
<h4 id="手动扩栈"><a href="#手动扩栈" class="headerlink" title="手动扩栈"></a>手动扩栈</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//C++使用，在开头写</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> comment(linker, <span class="meta-string">"/STACK:1024000000,1024000000"</span>)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//G++使用</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">extern</span> <span class="keyword">void</span> <span class="title">MAIN</span><span class="params">(<span class="keyword">void</span>)</span> __<span class="title">asm__</span><span class="params">(<span class="string">"MAIN"</span>)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">MAIN</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">//在这里写代码</span></span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">long</span> <span class="keyword">long</span> size = <span class="number">4096l</span>l &lt;&lt; <span class="number">20</span>; <span class="comment">// 4096 MB</span></span><br><span class="line">    <span class="keyword">char</span>* p = <span class="keyword">new</span> <span class="keyword">char</span>[size] + size;</span><br><span class="line">    __asm__ __volatile__(</span><br><span class="line">        <span class="string">"movq %0, %%rsp\n"</span></span><br><span class="line">        <span class="string">"pushq $exit\n"</span></span><br><span class="line">        <span class="string">"jmp MAIN\n"</span></span><br><span class="line">        ::<span class="string">"r"</span>(p));</span><br><span class="line">    MAIN();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<hr>
<h4 id="输入输出"><a href="#输入输出" class="headerlink" title="输入输出"></a>输入输出</h4><h5 id="特殊格式与转换"><a href="#特殊格式与转换" class="headerlink" title="特殊格式与转换"></a>特殊格式与转换</h5><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">char</span> s[MAX];</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">" %[^\n]"</span>, s);    <span class="comment">//遇到回车结束（读一整行）</span></span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">" %[^#]"</span>, s);     <span class="comment">//遇到#结束     </span></span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">" %[^ ]"</span>, s);     <span class="comment">//遇到空格结束</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">char</span> str[<span class="number">20</span>];</span><br><span class="line"><span class="built_in">cin</span>.getline(name); <span class="comment">//读入一行</span></span><br><span class="line"><span class="built_in">cin</span>.getline(name, <span class="number">20</span>); <span class="comment">//读入一行，指定长度</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">string</span> s;</span><br><span class="line">getline(<span class="built_in">cin</span>, s); <span class="comment">//string的读入一行</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//读到文件尾</span></span><br><span class="line"><span class="keyword">while</span> (<span class="built_in">cin</span>) &#123;&#125;</span><br><span class="line"><span class="keyword">while</span>(~<span class="built_in">scanf</span>) &#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 输出为二进制</span></span><br><span class="line"><span class="built_in">cout</span> &lt;&lt; <span class="string">"x = "</span> &lt;&lt; <span class="built_in">bitset</span>&lt;32&gt;(x) &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 十进制转换十六进制</span></span><br><span class="line"><span class="built_in">stringstream</span> ss;</span><br><span class="line">ss &lt;&lt; hex &lt;&lt; stol(<span class="string">"123"</span>);</span><br><span class="line"><span class="built_in">string</span> hex_num = ss.str();</span><br></pre></td></tr></table></figure>

<hr>
<h5 id="精度控制"><a href="#精度控制" class="headerlink" title="精度控制"></a>精度控制</h5><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//设置有效数字位数。</span></span><br><span class="line"><span class="built_in">cout</span> &lt;&lt; setprecision(位数) &lt;&lt; number &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//设置小数精度(小数点后的有效位数)</span></span><br><span class="line"><span class="built_in">cout</span> &lt;&lt;setiosflags(ios::fixed);    </span><br><span class="line"><span class="built_in">cout</span> &lt;&lt; setprecision(位数) &lt;&lt; number &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//设置小数精度(小数点后的有效位数)</span></span><br><span class="line"><span class="built_in">cout</span> &lt;&lt; fixed &lt;&lt; setprecision(<span class="number">10</span>) &lt;&lt; number &lt;&lt; <span class="built_in">endl</span>;</span><br></pre></td></tr></table></figure>

<hr>
<h5 id="挂"><a href="#挂" class="headerlink" title="挂"></a>挂</h5><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 本机测试需要EOF才能看到输出结果</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 快速输入挂</span></span><br><span class="line"><span class="comment">// 读入1e7 大约0.4s</span></span><br><span class="line"><span class="keyword">namespace</span> fastinput</span><br><span class="line">&#123;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> BUF_SIZE 1048576</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="keyword">char</span> <span class="title">nc</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">static</span> <span class="keyword">char</span> buf[BUF_SIZE], *p1 = buf + BUF_SIZE, *pend = buf + BUF_SIZE;</span><br><span class="line">        <span class="keyword">if</span> (p1 == pend)</span><br><span class="line">        &#123;</span><br><span class="line">            p1 = buf;</span><br><span class="line">            pend = buf + fread(buf, <span class="number">1</span>, BUF_SIZE, <span class="built_in">stdin</span>);</span><br><span class="line">            assert(pend != p1);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> *p1++;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="keyword">bool</span> <span class="title">blank</span><span class="params">(<span class="keyword">char</span> c)</span> </span>&#123; <span class="keyword">return</span> c == <span class="string">' '</span> || c == <span class="string">'\n'</span> || c == <span class="string">'\r'</span> || c == <span class="string">'\t'</span>; &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// non-negative integer</span></span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">get_unsigned_int</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> x = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">char</span> c = nc();</span><br><span class="line">        <span class="keyword">while</span> (blank(c)) c = nc();</span><br><span class="line">        <span class="keyword">for</span> (; c &gt;= <span class="string">'0'</span> &amp;&amp; c &lt;= <span class="string">'9'</span>; c = nc()) x = x * <span class="number">10</span> + c - <span class="string">'0'</span>;</span><br><span class="line">        <span class="keyword">return</span> x;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// integer</span></span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">get_int</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> x = <span class="number">0</span>, sgn = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">char</span> c = nc();</span><br><span class="line">        <span class="keyword">while</span> (blank(c)) c = nc();</span><br><span class="line">        <span class="keyword">if</span> (c == <span class="string">'-'</span>) sgn = <span class="number">-1</span>, c = nc();</span><br><span class="line">        <span class="keyword">for</span> (; c &gt;= <span class="string">'0'</span> &amp;&amp; c &lt;= <span class="string">'9'</span>; c = nc()) x = x * <span class="number">10</span> + c - <span class="string">'0'</span>;</span><br><span class="line">        <span class="keyword">return</span> sgn * x;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">undef</span> BUF_SIZE</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">//使用</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> fastinput;</span><br><span class="line"><span class="keyword">int</span> n = get_int();</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">int</span> n = get_unsigned_int();</span><br><span class="line"></span><br><span class="line"><span class="comment">//输入输出挂</span></span><br><span class="line"><span class="keyword">namespace</span> fastIO</span><br><span class="line">&#123;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> BUF_SIZE 100000</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> OUT_SIZE 100000</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ll long long</span></span><br><span class="line">    <span class="comment">//fread-&gt;read</span></span><br><span class="line">    <span class="keyword">bool</span> IOerror = <span class="number">0</span>;</span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="keyword">char</span> <span class="title">nc</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">static</span> <span class="keyword">char</span> buf[BUF_SIZE], *p1 = buf + BUF_SIZE, *pend = buf + BUF_SIZE;</span><br><span class="line">        <span class="keyword">if</span> (p1 == pend)</span><br><span class="line">        &#123;</span><br><span class="line">            p1 = buf; pend = buf + fread(buf, <span class="number">1</span>, BUF_SIZE, <span class="built_in">stdin</span>);</span><br><span class="line">            <span class="keyword">if</span> (pend == p1) &#123; IOerror = <span class="number">1</span>; <span class="keyword">return</span> <span class="number">-1</span>; &#125;</span><br><span class="line">            <span class="comment">//&#123;printf("IO error!\n"); system("pause"); for (;;); exit(0);&#125;</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> *p1++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="keyword">bool</span> <span class="title">blank</span><span class="params">(<span class="keyword">char</span> ch)</span> </span>&#123; <span class="keyword">return</span> ch == <span class="string">' '</span> || ch == <span class="string">'\n'</span> || ch == <span class="string">'\r'</span> || ch == <span class="string">'\t'</span>; &#125;</span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">read</span><span class="params">(<span class="keyword">int</span> &amp;x)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">bool</span> sign = <span class="number">0</span>; <span class="keyword">char</span> ch = nc(); x = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (; blank(ch); ch = nc());</span><br><span class="line">        <span class="keyword">if</span> (IOerror) <span class="keyword">return</span>;</span><br><span class="line">        <span class="keyword">if</span> (ch == <span class="string">'-'</span>) sign = <span class="number">1</span>, ch = nc();</span><br><span class="line">        <span class="keyword">for</span> (; ch &gt;= <span class="string">'0'</span>&amp;&amp;ch &lt;= <span class="string">'9'</span>; ch = nc()) x = x * <span class="number">10</span> + ch - <span class="string">'0'</span>;</span><br><span class="line">        <span class="keyword">if</span> (sign) x = -x;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">read</span><span class="params">(ll &amp;x)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">bool</span> sign = <span class="number">0</span>; <span class="keyword">char</span> ch = nc(); x = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (; blank(ch); ch = nc());</span><br><span class="line">        <span class="keyword">if</span> (IOerror) <span class="keyword">return</span>;</span><br><span class="line">        <span class="keyword">if</span> (ch == <span class="string">'-'</span>) sign = <span class="number">1</span>, ch = nc();</span><br><span class="line">        <span class="keyword">for</span> (; ch &gt;= <span class="string">'0'</span>&amp;&amp;ch &lt;= <span class="string">'9'</span>; ch = nc()) x = x * <span class="number">10</span> + ch - <span class="string">'0'</span>;</span><br><span class="line">        <span class="keyword">if</span> (sign) x = -x;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">read</span><span class="params">(<span class="keyword">double</span> &amp;x)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">bool</span> sign = <span class="number">0</span>; <span class="keyword">char</span> ch = nc(); x = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (; blank(ch); ch = nc());</span><br><span class="line">        <span class="keyword">if</span> (IOerror) <span class="keyword">return</span>;</span><br><span class="line">        <span class="keyword">if</span> (ch == <span class="string">'-'</span>) sign = <span class="number">1</span>, ch = nc();</span><br><span class="line">        <span class="keyword">for</span> (; ch &gt;= <span class="string">'0'</span>&amp;&amp;ch &lt;= <span class="string">'9'</span>; ch = nc()) x = x * <span class="number">10</span> + ch - <span class="string">'0'</span>;</span><br><span class="line">        <span class="keyword">if</span> (ch == <span class="string">'.'</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">double</span> tmp = <span class="number">1</span>; ch = nc();</span><br><span class="line">            <span class="keyword">for</span> (; ch &gt;= <span class="string">'0'</span>&amp;&amp;ch &lt;= <span class="string">'9'</span>; ch = nc())tmp /= <span class="number">10.0</span>, x += tmp * (ch - <span class="string">'0'</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (sign) x = -x;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">read</span><span class="params">(<span class="keyword">char</span> *s)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">char</span> ch = nc();</span><br><span class="line">        <span class="keyword">for</span> (; blank(ch); ch = nc());</span><br><span class="line">        <span class="keyword">if</span> (IOerror) <span class="keyword">return</span>;</span><br><span class="line">        <span class="keyword">for</span> (; !blank(ch) &amp;&amp; !IOerror; ch = nc()) *s++ = ch;</span><br><span class="line">        *s = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">read</span><span class="params">(<span class="keyword">char</span> &amp;c)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (c = nc(); blank(c); c = nc());</span><br><span class="line">        <span class="keyword">if</span> (IOerror) &#123; c = <span class="number">-1</span>; <span class="keyword">return</span>; &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//fwrite-&gt;write</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">Ostream_fwrite</span></span></span><br><span class="line"><span class="class">    &#123;</span></span><br><span class="line">        <span class="keyword">char</span> *buf, *p1, *pend;</span><br><span class="line">        Ostream_fwrite() &#123; buf = <span class="keyword">new</span> <span class="keyword">char</span>[BUF_SIZE]; p1 = buf; pend = buf + BUF_SIZE; &#125;</span><br><span class="line">        <span class="function"><span class="keyword">void</span> <span class="title">out</span><span class="params">(<span class="keyword">char</span> ch)</span></span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            <span class="keyword">if</span> (p1 == pend) &#123; fwrite(buf, <span class="number">1</span>, BUF_SIZE, <span class="built_in">stdout</span>); p1 = buf; &#125;</span><br><span class="line">            *p1++ = ch;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function"><span class="keyword">void</span> <span class="title">print</span><span class="params">(<span class="keyword">int</span> x)</span></span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            <span class="keyword">static</span> <span class="keyword">char</span> s[<span class="number">15</span>], *s1; s1 = s;</span><br><span class="line">            <span class="keyword">if</span> (!x) *s1++ = <span class="string">'0'</span>; <span class="keyword">if</span> (x &lt; <span class="number">0</span>) out(<span class="string">'-'</span>), x = -x;</span><br><span class="line">            <span class="keyword">while</span> (x) *s1++ = x % <span class="number">10</span> + <span class="string">'0'</span>, x /= <span class="number">10</span>;</span><br><span class="line">            <span class="keyword">while</span> (s1-- != s) out(*s1);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function"><span class="keyword">void</span> <span class="title">println</span><span class="params">(<span class="keyword">int</span> x)</span></span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            <span class="keyword">static</span> <span class="keyword">char</span> s[<span class="number">15</span>], *s1; s1 = s;</span><br><span class="line">            <span class="keyword">if</span> (!x) *s1++ = <span class="string">'0'</span>; <span class="keyword">if</span> (x &lt; <span class="number">0</span>) out(<span class="string">'-'</span>), x = -x;</span><br><span class="line">            <span class="keyword">while</span> (x) *s1++ = x % <span class="number">10</span> + <span class="string">'0'</span>, x /= <span class="number">10</span>;</span><br><span class="line">            <span class="keyword">while</span> (s1-- != s) out(*s1); out(<span class="string">'\n'</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function"><span class="keyword">void</span> <span class="title">print</span><span class="params">(ll x)</span></span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            <span class="keyword">static</span> <span class="keyword">char</span> s[<span class="number">25</span>], *s1; s1 = s;</span><br><span class="line">            <span class="keyword">if</span> (!x) *s1++ = <span class="string">'0'</span>; <span class="keyword">if</span> (x &lt; <span class="number">0</span>) out(<span class="string">'-'</span>), x = -x;</span><br><span class="line">            <span class="keyword">while</span> (x) *s1++ = x % <span class="number">10</span> + <span class="string">'0'</span>, x /= <span class="number">10</span>;</span><br><span class="line">            <span class="keyword">while</span> (s1-- != s) out(*s1);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function"><span class="keyword">void</span> <span class="title">println</span><span class="params">(ll x)</span></span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            <span class="keyword">static</span> <span class="keyword">char</span> s[<span class="number">25</span>], *s1; s1 = s;</span><br><span class="line">            <span class="keyword">if</span> (!x) *s1++ = <span class="string">'0'</span>; <span class="keyword">if</span> (x &lt; <span class="number">0</span>) out(<span class="string">'-'</span>), x = -x;</span><br><span class="line">            <span class="keyword">while</span> (x) *s1++ = x % <span class="number">10</span> + <span class="string">'0'</span>, x /= <span class="number">10</span>;</span><br><span class="line">            <span class="keyword">while</span> (s1-- != s) out(*s1); out(<span class="string">'\n'</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function"><span class="keyword">void</span> <span class="title">print</span><span class="params">(<span class="keyword">double</span> x, <span class="keyword">int</span> y)</span></span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            <span class="keyword">static</span> ll mul[] = &#123; <span class="number">1</span>,<span class="number">10</span>,<span class="number">100</span>,<span class="number">1000</span>,<span class="number">10000</span>,<span class="number">100000</span>,<span class="number">1000000</span>,<span class="number">10000000</span>,<span class="number">100000000</span>, <span class="number">1000000000</span>,<span class="number">10000000000L</span>L,<span class="number">100000000000L</span>L,<span class="number">1000000000000L</span>L,<span class="number">10000000000000L</span>L, <span class="number">100000000000000L</span>L,<span class="number">1000000000000000L</span>L,<span class="number">10000000000000000L</span>L,<span class="number">100000000000000000L</span>L &#125;;</span><br><span class="line">            <span class="keyword">if</span> (x &lt; <span class="number">-1e-12</span>) out(<span class="string">'-'</span>), x = -x; x *= mul[y];</span><br><span class="line">            ll x1 = (ll)<span class="built_in">floor</span>(x); <span class="keyword">if</span> (x - <span class="built_in">floor</span>(x) &gt;= <span class="number">0.5</span>) ++x1;</span><br><span class="line">            ll x2 = x1 / mul[y], x3 = x1 - x2 * mul[y]; print(x2);</span><br><span class="line">            <span class="keyword">if</span> (y &gt; <span class="number">0</span>) &#123; out(<span class="string">'.'</span>); <span class="keyword">for</span> (<span class="keyword">size_t</span> i = <span class="number">1</span>; i &lt; y&amp;&amp;x3*mul[i] &lt; mul[y]; out(<span class="string">'0'</span>), ++i); print(x3); &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function"><span class="keyword">void</span> <span class="title">println</span><span class="params">(<span class="keyword">double</span> x, <span class="keyword">int</span> y)</span> </span>&#123; print(x, y); out(<span class="string">'\n'</span>); &#125;</span><br><span class="line">        <span class="function"><span class="keyword">void</span> <span class="title">print</span><span class="params">(<span class="keyword">char</span> *s)</span> </span>&#123; <span class="keyword">while</span> (*s) out(*s++); &#125;</span><br><span class="line">        <span class="function"><span class="keyword">void</span> <span class="title">println</span><span class="params">(<span class="keyword">char</span> *s)</span> </span>&#123; <span class="keyword">while</span> (*s) out(*s++); out(<span class="string">'\n'</span>); &#125;</span><br><span class="line">        <span class="function"><span class="keyword">void</span> <span class="title">flush</span><span class="params">()</span> </span>&#123; <span class="keyword">if</span> (p1 != buf) &#123; fwrite(buf, <span class="number">1</span>, p1 - buf, <span class="built_in">stdout</span>); p1 = buf; &#125; &#125;</span><br><span class="line">        ~Ostream_fwrite() &#123; flush(); &#125;</span><br><span class="line">    &#125; Ostream;</span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">print</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123; Ostream.print(x); &#125;</span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">println</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123; Ostream.println(x); &#125;</span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">print</span><span class="params">(<span class="keyword">char</span> x)</span> </span>&#123; Ostream.out(x); &#125;</span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">println</span><span class="params">(<span class="keyword">char</span> x)</span> </span>&#123; Ostream.out(x); Ostream.out(<span class="string">'\n'</span>); &#125;</span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">print</span><span class="params">(ll x)</span> </span>&#123; Ostream.print(x); &#125;</span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">println</span><span class="params">(ll x)</span> </span>&#123; Ostream.println(x); &#125;</span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">print</span><span class="params">(<span class="keyword">double</span> x, <span class="keyword">int</span> y)</span> </span>&#123; Ostream.print(x, y); &#125;</span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">println</span><span class="params">(<span class="keyword">double</span> x, <span class="keyword">int</span> y)</span> </span>&#123; Ostream.println(x, y); &#125;</span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">print</span><span class="params">(<span class="keyword">char</span> *s)</span> </span>&#123; Ostream.print(s); &#125;</span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">println</span><span class="params">(<span class="keyword">char</span> *s)</span> </span>&#123; Ostream.println(s); &#125;</span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">println</span><span class="params">()</span> </span>&#123; Ostream.out(<span class="string">'\n'</span>); &#125;</span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">flush</span><span class="params">()</span> </span>&#123; Ostream.flush(); &#125;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">undef</span> ll</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">undef</span> OUT_SIZE</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">undef</span> BUF_SIZE</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">//使用</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> fastIO;</span><br><span class="line"><span class="keyword">int</span> n;</span><br><span class="line">read(n);</span><br><span class="line">print(n);</span><br><span class="line">println(n);</span><br></pre></td></tr></table></figure>

<hr>
<h4 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h4><h5 id="ASCII表"><a href="#ASCII表" class="headerlink" title="ASCII表"></a>ASCII表</h5><p><a href="https://cdn.luogu.org/upload/pic/28671.png" target="_blank" rel="noopener">这里</a></p>
<p><img src="https://cdn.luogu.org/upload/pic/28671.png" alt="ASCII表"></p>
<hr>
<h5 id="常用数表"><a href="#常用数表" class="headerlink" title="常用数表"></a>常用数表</h5><table>
<thead>
<tr>
<th>类型</th>
<th>数据</th>
</tr>
</thead>
<tbody><tr>
<td>char</td>
<td>-128 ~ 127</td>
</tr>
<tr>
<td>short</td>
<td>-32768 ~ 32767</td>
</tr>
<tr>
<td>int</td>
<td>-2147483648 ~ 2147483647(±2e9)</td>
</tr>
<tr>
<td>unsigned int</td>
<td>-0 ~ 4294967295(4e9)</td>
</tr>
<tr>
<td>long long</td>
<td>-9223372036854775808 ~ 9223372036854775807(±9e18)</td>
</tr>
<tr>
<td>unsigned long long</td>
<td>0 ~ 18446744073709551615(1e19)</td>
</tr>
<tr>
<td>double</td>
<td>± (1.7e-308 ~ 1.7e308)</td>
</tr>
<tr>
<td>long double</td>
<td>± (1.2e-4932 ~ 1.2e4932)</td>
</tr>
<tr>
<td>INF = 0x3f3f3f3f</td>
<td>1061109567</td>
</tr>
<tr>
<td>LINF = 0x3f3f3f3f3f3f3f3f</td>
<td>4557430888798830399</td>
</tr>
</tbody></table>
<hr>
<h5 id="时间复杂度与数据规模"><a href="#时间复杂度与数据规模" class="headerlink" title="时间复杂度与数据规模"></a>时间复杂度与数据规模</h5><p>评测机每秒约 $10^8$ 至 $1.5 \times 10^9$</p>
<p>1MB内存约 $2.5 \times 10^5$ 也就是 25万 个int（4个字节）</p>
<hr>
<h3 id="数学"><a href="#数学" class="headerlink" title="数学"></a>数学</h3><h4 id="常用网站"><a href="#常用网站" class="headerlink" title="常用网站"></a>常用网站</h4><ul>
<li><a href="http://oeis.org/" target="_blank" rel="noopener">OEIS</a></li>
<li><a href="https://zh.numberempire.com/" target="_blank" rel="noopener">数字帝国</a></li>
<li><a href="http://www.wolframalpha.com/" target="_blank" rel="noopener">WolframAlpha</a></li>
</ul>
<hr>
<h4 id="数学理论"><a href="#数学理论" class="headerlink" title="数学理论"></a>数学理论</h4><h5 id="负数求余"><a href="#负数求余" class="headerlink" title="负数求余"></a>负数求余</h5><p>负数的求余数仍为负数，有正负时使用<code>if (abs(x%2))</code>或者<code>if (x&amp;1)</code>判断是否为奇数</p>
<hr>
<h5 id="组合数"><a href="#组合数" class="headerlink" title="组合数"></a>组合数</h5><p>通项公式:</p>
<p>$$<br>C_{m}^{n}=\frac{m !}{n ! *(m-n) !}<br>$$</p>
<p>递推公式:</p>
<p>$$<br>C_{m}^{n}=C_{m-1}^{n}+C_{m-1}^{n-1}<br>$$</p>
<p>性质:</p>
<p>$$<br>C_{m+r+1}^{r}=\sum_{i=0}^{r} C_{m+i}^{i}<br>$$</p>
<p>$$<br>C_{m}^{n} * C_{n}^{r}=C_{m}^{r} * C_{m-r}^{n-r}<br>$$</p>
<p>$$<br>\sum_{i=0}^{m} C_{m}^{i} * x^{i}=(x+1)^{m}<br>$$</p>
<p>$$<br>C_{m}^{0}-C_{m}^{1}+C_{m}^{2}-\ldots \pm C_{m}^{m}=0<br>$$</p>
<p>$$<br>C_{m}^{0}+C_{m}^{2}+C_{m}^{4} \ldots=C_{m}^{1}+C_{m}^{3}+C_{m}^{5}+\ldots=2^{m-1}<br>$$</p>
<p>$$<br>C_{m+n}^{r}=C_{m}^{0} * C_{n}^{r}+C_{m}^{1} * C_{n}^{r-1}+\ldots+C_{m}^{r} * C_{n}^{0}<br>$$</p>
<p>$$<br>C_{m+n}^{n}=C_{m}^{0} * C_{n}^{0}+C_{m}^{1} * C_{n}^{1}+\ldots+C_{m}^{m} * C_{n}^{m}<br>$$</p>
<p>$$<br>n * C_{m}^{n}=m * C_{m-1}^{n-1}<br>$$</p>
<p>$$<br>\sum_{i=1}^{n} C_{n}^{i} * i=n * 2^{n-1}<br>$$</p>
<p>$$<br>\sum_{i=1}^{n} C_{n}^{i} * i^{2}=n *(n+1) * 2^{n-2}<br>$$</p>
<p>$$<br>\sum_{i=0}^{n}\left(C_{n}^{i}\right)^{2}=C_{2 n}^{n}<br>$$</p>
<p>奇偶性: 对于 $C_{n}^{k}$ ，若 <code>n &amp; k = k</code> 则 $C_{n}^{k}$ 为奇数，否则为偶数。</p>
<hr>
<h5 id="错位排列数"><a href="#错位排列数" class="headerlink" title="错位排列数"></a>错位排列数</h5><p>将数字1~n排成一列，且数字i不在第i位的方案数:</p>
<p>$$<br>D_1=0\ ,\ D_2=1<br>$$</p>
<p>$$<br>D_n=(n-1)(D_{n-1}+D_{n-2})<br>$$</p>
<hr>
<h5 id="威尔逊定理"><a href="#威尔逊定理" class="headerlink" title="威尔逊定理"></a>威尔逊定理</h5><p>当且仅当p为质数时，有</p>
<p>$$<br>(p-1) ! \equiv -1 \mod{p}<br>$$</p>
<p>$$<br>(p-1) ! \equiv p-1 \mod{p}<br>$$</p>
<hr>
<h5 id="费马小定理"><a href="#费马小定理" class="headerlink" title="费马小定理"></a>费马小定理</h5><p>若p是质数，则对于任意整数a，有</p>
<p>$$<br>a^{p-1}\equiv 1 \mod{p}<br>$$</p>
<p>$$<br>a^{p}\equiv a \mod{p}<br>$$</p>
<hr>
<h5 id="费马大定理"><a href="#费马大定理" class="headerlink" title="费马大定理"></a>费马大定理</h5><p>当整数 $n&gt;2$ 时，方程</p>
<p>$$<br>x^n+y^n=z^n<br>$$</p>
<p>无正整数解</p>
<hr>
<h5 id="哥德巴赫猜想"><a href="#哥德巴赫猜想" class="headerlink" title="哥德巴赫猜想"></a>哥德巴赫猜想</h5><p>任一大于2的偶数都可写成两个素数之和</p>
<p>任一大于5的奇数都可写成三个素数之和</p>
<hr>
<h5 id="勾股数"><a href="#勾股数" class="headerlink" title="勾股数"></a>勾股数</h5><p>$$<br>a^2+b^2=c^2<br>$$</p>
<p>当 $n&gt;1$ 时:</p>
<p>$$<br>a=2n+1,b=2n^2+2n,c=2n^2+2n+1<br>$$</p>
<p>$$<br>a=2n,b=n^2-1,c=n^2+1<br>$$</p>
<p>$$<br>a=4n,b=4n^2-1,c=4n^2+1\ (a,b,c 互质)<br>$$</p>
<hr>
<h5 id="抽屉原理"><a href="#抽屉原理" class="headerlink" title="抽屉原理"></a>抽屉原理</h5><p>原理一：把n+1个咕咕咕放到n个巢里，那么至少有两个咕咕咕在同一个巢里</p>
<p>原理二：把m*n-1个物体放入n个抽屉中，其中必定有一个抽屉中最多有m-1个物体 (例如：将3×5-1=14个物体放入5个抽屉中，则必定有一个抽屉中的物体数少于等于3-1=2)</p>
<hr>
<h5 id="欧拉公式"><a href="#欧拉公式" class="headerlink" title="欧拉公式"></a>欧拉公式</h5><p>对于简单多面体（或者投射），点-边+面=2</p>
<p>$$<br>V-E+F=2<br>$$</p>
<hr>
<h4 id="欧几里德算法"><a href="#欧几里德算法" class="headerlink" title="欧几里德算法"></a>欧几里德算法</h4><h5 id="最大公约数-GCD"><a href="#最大公约数-GCD" class="headerlink" title="最大公约数 GCD"></a>最大公约数 GCD</h5><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//欧几里德算法 gcd(a,b) == gcd(b,a%b)</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">gcd</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> </span>&#123; <span class="keyword">return</span> y ? gcd(y, x%y) : x; &#125;</span><br></pre></td></tr></table></figure>

<hr>
<h5 id="扩展欧几里德算法-EXGCD"><a href="#扩展欧几里德算法-EXGCD" class="headerlink" title="扩展欧几里德算法 EXGCD"></a>扩展欧几里德算法 EXGCD</h5><blockquote>
<p>裴蜀等式</p>
</blockquote>
<p>对任意两个整数a和b，关于未知数x和y的线性丢番图方程（裴蜀等式）：</p>
<p>$$<br>ax+by=m<br>$$</p>
<p>当且仅当m是gcd(a,b)的倍数时有整数解(x,y)。裴蜀等式有解时必然有无穷多个解。</p>
<p>推论：a,b互质时使得 $ax+by=1$ 有解（充要条件）</p>
<blockquote>
<p>扩展欧几里德算法</p>
</blockquote>
<p>用于求裴蜀等式的特解 $(x_0,y_0)$ ，即 $ax+by=gcd(a,b)$ 的解(绝对值之和最小的解)。</p>
<p>原式 $ax+by=m$ 的通解 k∈z</p>
<p>$$<br>x=\frac{m}{gcd(a,b)}x_0+k\frac{b}{gcd(a,b)}<br>$$</p>
<p>$$<br>y=\frac{m}{gcd(a,b)}y_0-k\frac{a}{gcd(a,b)}<br>$$</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//x,y为引用，返回值为gcd(a,b)</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">exgcd</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b, <span class="keyword">int</span> &amp;x, <span class="keyword">int</span> &amp;y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (b == <span class="number">0</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        x = <span class="number">1</span>;</span><br><span class="line">        y = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">return</span> a;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> r = exgcd(b, a%b, x, y);</span><br><span class="line">    <span class="keyword">int</span> t = y;</span><br><span class="line">    y = x - (a / b) * y;</span><br><span class="line">    x = t;</span><br><span class="line">    <span class="keyword">return</span> r;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<hr>
<h4 id="欧拉"><a href="#欧拉" class="headerlink" title="欧拉"></a>欧拉</h4><h5 id="欧拉函数"><a href="#欧拉函数" class="headerlink" title="欧拉函数"></a>欧拉函数</h5><h6 id="定义"><a href="#定义" class="headerlink" title="定义"></a>定义</h6><p>对于一个正整数x，小于x且和x互质的正整数（包括1）的个数，记作 $φ(x)$</p>
<p>$$<br>φ(x)=x\prod_{i=1}^{n}(1-\frac{1}{p_i})<br>$$</p>
<hr>
<h6 id="性质"><a href="#性质" class="headerlink" title="性质"></a>性质</h6><p>对于质数p， $φ(p)=p-1$ ，且 $φ(1)=1$</p>
<p>对于质数p，有 $n=p^k$ ，则 $φ(n)=p^k-p^{k-1}=(p-1)p^{k-1}$</p>
<p>对于奇数p， $φ(2p)=φ(p)$</p>
<p>对于一个正整数n，与其互质的数之和为 $φ(n)*n/2$</p>
<p>对于一个正整数n，对于所有n的正整数因子d (即 $d|n$ )，即 $\sum_{d|n} φ(d)=n$</p>
<p>对于一个正整数n，且a为n的质因数，则：</p>
<p>若 $n|a$ 且 $(n/a)|a$ ，则 $φ(n)=φ(n/a)*a$</p>
<p>若 $n|a$ 且 $(n/a) \nmid a$，则 $φ(n)=φ(n/a)*(a-1)$</p>
<p>积性函数：若m,n互质(即 $gcd(m,n)=1$ )，则 $φ(mn)=φ(m)φ(n)=(m-1)(n-1)$</p>
<hr>
<h6 id="求法"><a href="#求法" class="headerlink" title="求法"></a>求法</h6><blockquote>
<p>直接求</p>
</blockquote>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//O(sqrt())</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">phi</span><span class="params">(<span class="keyword">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> res = x, a = x;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i*i &lt;= a; i++)</span><br><span class="line">        <span class="keyword">if</span> (a%i == <span class="number">0</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            res = res / i * (i - <span class="number">1</span>);</span><br><span class="line">            <span class="keyword">while</span> (a%i == <span class="number">0</span>) a /= i;</span><br><span class="line">        &#125;</span><br><span class="line">    <span class="keyword">if</span> (a &gt; <span class="number">1</span>) res = res / a * (a - <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<hr>
<blockquote>
<p>线性筛法</p>
</blockquote>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//较快，O(n)</span></span><br><span class="line"><span class="comment">//更快的请参考杜教筛</span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">static</span> <span class="keyword">int</span> MAXN = <span class="number">50000</span> + <span class="number">100</span>;</span><br><span class="line"><span class="keyword">bool</span> check[MAXN];</span><br><span class="line"><span class="keyword">int</span> phi[MAXN] = &#123; <span class="number">0</span> &#125;, prime[MAXN] = &#123; <span class="number">0</span> &#125;;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">get_phi</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">memset</span>(check, <span class="literal">false</span>, <span class="keyword">sizeof</span>(check));</span><br><span class="line">    <span class="keyword">int</span> tot = <span class="number">0</span>;</span><br><span class="line">    phi[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= MAXN - <span class="number">100</span>; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (!check[i])</span><br><span class="line">        &#123;</span><br><span class="line">            prime[tot++] = i;</span><br><span class="line">            phi[i] = i - <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; tot; ++j)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (i * prime[j] &gt; MAXN - <span class="number">100</span>) <span class="keyword">break</span>;</span><br><span class="line">            check[i * prime[j]] = <span class="literal">true</span>;</span><br><span class="line">            <span class="keyword">if</span> (i % prime[j] == <span class="number">0</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                phi[i * prime[j]] = phi[i] * prime[j];</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> phi[i * prime[j]] = phi[i] * (prime[j] - <span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<hr>
<blockquote>
<p>递推法</p>
</blockquote>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//较慢</span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">static</span> <span class="keyword">int</span> MAXN = <span class="number">50000</span> + <span class="number">100</span>;</span><br><span class="line"><span class="keyword">int</span> phi[MAXN] = &#123; <span class="number">0</span> &#125;;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">get_phi</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    phi[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= MAXN - <span class="number">100</span>; i++)</span><br><span class="line">        <span class="keyword">if</span> (!phi[i])</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = i; j &lt;= MAXN - <span class="number">100</span>; j += i)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span> (!phi[j]) phi[j] = j;</span><br><span class="line">                phi[j] = phi[j] / i * (i - <span class="number">1</span>);</span><br><span class="line">            &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<hr>
<h5 id="欧拉定理"><a href="#欧拉定理" class="headerlink" title="欧拉定理"></a>欧拉定理</h5><p>若正整数a, n互质($gcd(a,p)=1$)，则</p>
<p>$$<br>a^{φ(n)}\equiv1\pmod{n}<br>$$</p>
<hr>
<h5 id="欧拉降幂"><a href="#欧拉降幂" class="headerlink" title="欧拉降幂"></a>欧拉降幂</h5><p>对于 $x\geqφ(p)$，有</p>
<p>$$<br>a^x \equiv a^{(x \ mod \ φ(p))+φ(p)}\pmod{p}<br>$$</p>
<p>对于 $x&lt;φ(p)$ ，无需降幂。</p>
<hr>
<h5 id="欧拉路径"><a href="#欧拉路径" class="headerlink" title="欧拉路径"></a>欧拉路径</h5><h6 id="欧拉回路"><a href="#欧拉回路" class="headerlink" title="欧拉回路"></a>欧拉回路</h6><p>每条边只经过一次，且回到起点</p>
<ul>
<li>无向图：连通（不考虑度为0的点），每个顶点度数都为偶数</li>
<li>有向图：基图连通（把边当成无向边，同样不考虑度为0的点），每个顶点的出度等于入度</li>
<li>混合图：<ul>
<li>既有无向边也有向边，首先是基图连通（不考虑度为0的点），然后需要借助网络流判定。</li>
<li>首先给原图中的每条无向边随便指定一个方向（称为初始定向），将原图改为有向图G’，然后的任务就是改变G’中某些条边的方向（当然是无向边转化来的，原来混合图中的有向边不能动）使其满足每个点的入度等于出度。</li>
<li>设D[i]为G’中（点i的出度-点i的入度），即可发现，在改变G’中边的方向的过程中，任何点的D值的奇偶性都不会发生改变（设将边&lt;i, j&gt;改为&lt;j, i&gt;，则i入度加1出度减1，j入度减1出度加1，两者之差加2或者减2，奇偶性不变），而最终要求的是每个点的入度等于出度，即每个点的D值都为0，是偶数，可得：若初始定向得到的G’中任⼀个点D值是奇数，那么原图中一定不存在欧拉环。</li>
<li>若初始D值都是偶数，则将G’改装成网络：设源点S和汇点T，对于每个D[i] &gt; 0的点i，连边&lt;S, i&gt;，容量为D[i]/2；对于每个D[j] &lt; 0的点j，连边&lt;j, T&gt;，容量为-D[j]/2；G’中的每条边在网中仍保留，容量为i（表示该边最多只能被改变一次方向）。求这个网络的最大流，若S引出的所有边均满流，则原混合图是欧拉图，将网络中所有流量为1的中间边（就是不与S或T关联的边）在G’中改变方向，形成的新图G”一定是有向欧拉图；若S引出的边中有的没有满流，则原混合图不是欧拉图。</li>
</ul>
</li>
</ul>
<hr>
<h6 id="欧拉路径-1"><a href="#欧拉路径-1" class="headerlink" title="欧拉路径"></a>欧拉路径</h6><p>每条边只经过一次，不要求回到起点。</p>
<ul>
<li>无向图：连通（不考虑度为0的点），每个顶点度数都为偶数或者仅有两个点的度数为奇数。</li>
<li>有向图：基图连通（把边当成无向边，同样不考虑度为0的点），每个顶点出度等于入度或者有且仅有一个点的出度比入度多1，有且仅有一个点的出度比入度少1，其余的出度等于入度。</li>
<li>混合图：如果存在欧拉回路，一定存在欧拉路径，否则如果有且仅有两个点的（出度-入度）是奇数，那么给这两个点加边，判断是否存在欧拉回路，如果存在就一定存在欧拉路径。</li>
</ul>
<hr>
<h4 id="杜教筛"><a href="#杜教筛" class="headerlink" title="杜教筛"></a>杜教筛</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//积性函数，欧拉函数和莫比乌斯函数</span></span><br><span class="line"><span class="comment">//复杂度O(n^2/3)~O(n^3/4)</span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">2000100</span>;</span><br><span class="line"><span class="keyword">long</span> <span class="keyword">long</span> prime[MAXN];</span><br><span class="line"><span class="keyword">long</span> <span class="keyword">long</span> mu[MAXN];</span><br><span class="line"><span class="built_in">map</span>&lt;<span class="keyword">int</span>, <span class="keyword">long</span> <span class="keyword">long</span>&gt; ans_mu;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    fill(prime, prime + MAXN, <span class="number">1</span>);</span><br><span class="line">    mu[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">int</span> tot = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt; MAXN; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (prime[i])</span><br><span class="line">        &#123;</span><br><span class="line">            prime[++tot] = i;</span><br><span class="line">            mu[i] = <span class="number">-1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= tot &amp;&amp; i * prime[j] &lt; MAXN; j++)</span><br><span class="line">        &#123;</span><br><span class="line">            prime[i * prime[j]] = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">if</span> (i % prime[j] == <span class="number">0</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                mu[i * prime[j]] = <span class="number">0</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> mu[i * prime[j]] = -mu[i];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt; MAXN; i++) mu[i] += mu[i - <span class="number">1</span>];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">long</span> <span class="keyword">long</span> <span class="title">calc_mu</span><span class="params">(<span class="keyword">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (x &lt; MAXN) <span class="keyword">return</span> mu[x];</span><br><span class="line">    <span class="keyword">if</span> (ans_mu.count(x)) <span class="keyword">return</span> ans_mu[x];</span><br><span class="line">    <span class="keyword">long</span> <span class="keyword">long</span> ans = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">long</span> <span class="keyword">long</span> i = <span class="number">2</span>, j; i &lt;= x; i = j + <span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        j = x / (x / i);</span><br><span class="line">        ans -= (j - i + <span class="number">1</span>) * calc_mu(x / i);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ans_mu[x] = ans;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">long</span> <span class="keyword">long</span> <span class="title">calc_phi</span><span class="params">(<span class="keyword">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">long</span> <span class="keyword">long</span> ans = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">long</span> <span class="keyword">long</span> i = <span class="number">1</span>, j; i &lt;= x; i = j + <span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        j = x / (x / i);</span><br><span class="line">        ans += (x / i) * (x / i) * (calc_mu(j) - calc_mu(i - <span class="number">1</span>));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ((ans - <span class="number">1</span>) &gt;&gt; <span class="number">1</span>) + <span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<hr>
<h4 id="扩展大步小步-Baby-Steps-Giant-Steps"><a href="#扩展大步小步-Baby-Steps-Giant-Steps" class="headerlink" title="扩展大步小步 Baby Steps Giant Steps"></a>扩展大步小步 Baby Steps Giant Steps</h4><p>用于求解高次同余方程，即求解x：</p>
<p>$$<br>a^{x} \equiv b \mod{m}<br>$$ </p>
<p>普通版要求m为质数（或者a与m互质），如果x有解，则 $0 \leq x \lt m$；扩展版无要求</p>
<p>下列代码数据范围 $0 \leq a, b \leq m \leq 10^9 $</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//北上广深算法</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">long</span> <span class="keyword">long</span> MOD = <span class="number">1313131</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">long</span> <span class="keyword">long</span> MAXN = <span class="number">500000</span> + <span class="number">5</span>; <span class="comment">// sqrt(p)</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">long</span> <span class="keyword">long</span> <span class="title">gcd</span><span class="params">(<span class="keyword">long</span> <span class="keyword">long</span> x, <span class="keyword">long</span> <span class="keyword">long</span> y)</span> </span>&#123; <span class="keyword">return</span> y ? gcd(y, x%y) : x; &#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Exgcd</span><span class="params">(<span class="keyword">long</span> <span class="keyword">long</span> a, <span class="keyword">long</span> <span class="keyword">long</span> b, <span class="keyword">long</span> <span class="keyword">long</span> &amp;d, <span class="keyword">long</span> <span class="keyword">long</span> &amp;x, <span class="keyword">long</span> <span class="keyword">long</span> &amp;y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!b)</span><br><span class="line">    &#123;</span><br><span class="line">        d = a;</span><br><span class="line">        x = <span class="number">1</span>;</span><br><span class="line">        y = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        Exgcd(b, a % b, d, y, x);</span><br><span class="line">        y -= x * (a / b);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">long</span> <span class="keyword">long</span> <span class="title">qkpow</span><span class="params">(<span class="keyword">long</span> <span class="keyword">long</span> a, <span class="keyword">long</span> <span class="keyword">long</span> b, <span class="keyword">long</span> <span class="keyword">long</span> m)</span><span class="comment">//O(logN) a^b%m</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">long</span> <span class="keyword">long</span> ans = <span class="number">1</span>;</span><br><span class="line">    a %= m;</span><br><span class="line">    <span class="keyword">while</span> (b)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (b &amp; <span class="number">1</span>) ans = (ans*a) % m;</span><br><span class="line">        a = (a*a) % m;</span><br><span class="line">        b &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ans % m;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Hashset</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="keyword">long</span> <span class="keyword">long</span> head[MOD], Next[MAXN], f[MAXN], v[MAXN], ind;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">reset</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        ind = <span class="number">0</span>;</span><br><span class="line">        <span class="built_in">memset</span>(head, <span class="number">-1</span>, <span class="keyword">sizeof</span> head);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">Insert</span><span class="params">(<span class="keyword">long</span> <span class="keyword">long</span> x, <span class="keyword">long</span> <span class="keyword">long</span> _v)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">long</span> <span class="keyword">long</span> ins = x % MOD;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">long</span> <span class="keyword">long</span> j = head[ins]; j != <span class="number">-1</span>; j = Next[j])</span><br><span class="line">            <span class="keyword">if</span> (f[j] == x)</span><br><span class="line">            &#123;</span><br><span class="line">                v[j] = min(v[j], _v);</span><br><span class="line">                <span class="keyword">return</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        f[ind] = x, v[ind] = _v;</span><br><span class="line">        Next[ind] = head[ins], head[ins] = ind++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">long</span> <span class="keyword">long</span> <span class="keyword">operator</span> [] (<span class="keyword">const</span> <span class="keyword">long</span> <span class="keyword">long</span> &amp;x) <span class="keyword">const</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">long</span> <span class="keyword">long</span> ins = x % MOD;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">long</span> <span class="keyword">long</span> j = head[ins]; j != <span class="number">-1</span>; j = Next[j])</span><br><span class="line">            <span class="keyword">if</span> (f[j] == x) <span class="keyword">return</span> v[j];</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125; S;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">long</span> <span class="keyword">long</span> <span class="title">Solve</span><span class="params">(<span class="keyword">long</span> <span class="keyword">long</span> a, <span class="keyword">long</span> <span class="keyword">long</span> b, <span class="keyword">long</span> <span class="keyword">long</span> c)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">long</span> <span class="keyword">long</span> d, x, y;</span><br><span class="line">    Exgcd(a, c, d, x, y);</span><br><span class="line">    x = (x + c) % c;</span><br><span class="line">    <span class="keyword">return</span> x * b % c;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">long</span> <span class="keyword">long</span> <span class="title">BSGS</span><span class="params">(<span class="keyword">long</span> <span class="keyword">long</span> C, <span class="keyword">long</span> <span class="keyword">long</span> A, <span class="keyword">long</span> <span class="keyword">long</span> B, <span class="keyword">long</span> <span class="keyword">long</span> p)</span>  <span class="comment">// A^x%p=B S.T.(A,p)=1</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (p &lt;= <span class="number">100</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">long</span> <span class="keyword">long</span> d = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; p; ++i)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (d == B) <span class="keyword">return</span> i;</span><br><span class="line">            d = d * A % p;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">long</span> <span class="keyword">long</span> m = (<span class="keyword">int</span>)<span class="built_in">sqrt</span>(p);</span><br><span class="line">        S.reset();</span><br><span class="line">        <span class="keyword">long</span> <span class="keyword">long</span> d = <span class="number">1</span>, Search;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; m; ++i)</span><br><span class="line">        &#123;</span><br><span class="line">            S.Insert(d, i);</span><br><span class="line">            d = d * A % p;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i * m &lt; p; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            d = qkpow(A, i * m, p) * C % p;</span><br><span class="line">            Search = S[Solve(d, B, p)];</span><br><span class="line">            <span class="keyword">if</span> (Search != <span class="number">-1</span>) <span class="keyword">return</span> i * m + Search;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">long</span> <span class="keyword">long</span> a, b, m;</span><br><span class="line">    <span class="keyword">int</span> T;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; T;</span><br><span class="line">    <span class="keyword">while</span> (T--)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">cin</span> &gt;&gt; a &gt;&gt; b &gt;&gt; m;</span><br><span class="line">        <span class="keyword">long</span> <span class="keyword">long</span> d = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">bool</span> find = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">long</span> <span class="keyword">long</span> i = <span class="number">0</span>; i &lt; <span class="number">100</span>; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (d == b)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="built_in">cout</span> &lt;&lt; i &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">                find = <span class="number">1</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            d = d * a % m;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (find) <span class="keyword">continue</span>;</span><br><span class="line">        <span class="keyword">long</span> <span class="keyword">long</span> t, C = <span class="number">1</span>, num = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span> ((t = gcd(a, m)) != <span class="number">1</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            m /= t;</span><br><span class="line">            b /= t;</span><br><span class="line">            C = C * a / t % m;</span><br><span class="line">            num++;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">long</span> <span class="keyword">long</span> res = BSGS(C, a, b, m);</span><br><span class="line">        <span class="keyword">if</span> (res == <span class="number">-1</span>) <span class="built_in">cout</span> &lt;&lt; <span class="string">"No Solution"</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">        <span class="keyword">else</span> <span class="built_in">cout</span> &lt;&lt; res + num &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<hr>
<h4 id="二次剩余"><a href="#二次剩余" class="headerlink" title="二次剩余"></a>二次剩余</h4><p>求二次同余方程的解 $x$ ，其中 $p$ 为奇质数：</p>
<p>$$<br>x^{2} \equiv n\ (\bmod \ p)<br>$$</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">long</span> <span class="keyword">long</span> <span class="title">quick_mod</span><span class="params">(<span class="keyword">long</span> <span class="keyword">long</span> a, <span class="keyword">long</span> <span class="keyword">long</span> b, <span class="keyword">long</span> <span class="keyword">long</span> m)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">long</span> <span class="keyword">long</span> ans = <span class="number">1</span>;</span><br><span class="line">    a %= m;</span><br><span class="line">    <span class="keyword">while</span> (b)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (b &amp; <span class="number">1</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            ans = ans * a % m;</span><br><span class="line">            b--;</span><br><span class="line">        &#125;</span><br><span class="line">        b &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">        a = a * a % m;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">T</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="keyword">long</span> <span class="keyword">long</span> p, d;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">long</span> <span class="keyword">long</span> w;</span><br><span class="line"></span><br><span class="line"><span class="comment">//二次域乘法</span></span><br><span class="line"><span class="function">T <span class="title">multi_er</span><span class="params">(T a, T b, <span class="keyword">long</span> <span class="keyword">long</span> m)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    T ans;</span><br><span class="line">    ans.p = (a.p * b.p % m + a.d * b.d % m * w % m) % m;</span><br><span class="line">    ans.d = (a.p * b.d % m + a.d * b.p % m) % m;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//二次域上快速幂</span></span><br><span class="line"><span class="function">T <span class="title">power</span><span class="params">(T a, <span class="keyword">long</span> <span class="keyword">long</span> b, <span class="keyword">long</span> <span class="keyword">long</span> m)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    T ans;</span><br><span class="line">    ans.p = <span class="number">1</span>;</span><br><span class="line">    ans.d = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (b)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (b &amp; <span class="number">1</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            ans = multi_er(ans, a, m);</span><br><span class="line">            b--;</span><br><span class="line">        &#125;</span><br><span class="line">        b &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">        a = multi_er(a, a, m);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//求勒让德符号</span></span><br><span class="line"><span class="function"><span class="keyword">long</span> <span class="keyword">long</span> <span class="title">Legendre</span><span class="params">(<span class="keyword">long</span> <span class="keyword">long</span> a, <span class="keyword">long</span> <span class="keyword">long</span> p)</span> </span>&#123; <span class="keyword">return</span> quick_mod(a, (p - <span class="number">1</span>) &gt;&gt; <span class="number">1</span>, p); &#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">long</span> <span class="keyword">long</span> <span class="title">mod</span><span class="params">(<span class="keyword">long</span> <span class="keyword">long</span> a, <span class="keyword">long</span> <span class="keyword">long</span> m)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    a %= m;</span><br><span class="line">    <span class="keyword">if</span> (a &lt; <span class="number">0</span>) a += m;</span><br><span class="line">    <span class="keyword">return</span> a;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">long</span> <span class="keyword">long</span> <span class="title">Solve</span><span class="params">(<span class="keyword">long</span> <span class="keyword">long</span> n, <span class="keyword">long</span> <span class="keyword">long</span> p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (p == <span class="number">2</span>) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span> (Legendre(n, p) + <span class="number">1</span> == p) <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    <span class="keyword">long</span> <span class="keyword">long</span> a = <span class="number">-1</span>, t;</span><br><span class="line"></span><br><span class="line">    srand(time(<span class="literal">nullptr</span>));</span><br><span class="line">    <span class="keyword">while</span> (<span class="literal">true</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        a = rand() % p;</span><br><span class="line">        t = a * a - n;</span><br><span class="line">        w = mod(t, p);</span><br><span class="line">        <span class="keyword">if</span> (Legendre(w, p) + <span class="number">1</span> == p) <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    T tmp;</span><br><span class="line">    tmp.p = a;</span><br><span class="line">    tmp.d = <span class="number">1</span>;</span><br><span class="line">    T ans = power(tmp, (p + <span class="number">1</span>) &gt;&gt; <span class="number">1</span>, p);</span><br><span class="line">    <span class="keyword">return</span> ans.p;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// x*x = a (mod n)</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">long</span> <span class="keyword">long</span> a, n;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; a &gt;&gt; n;</span><br><span class="line">    a %= n;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">auto</span> ans1 = Solve(a, n);</span><br><span class="line">    <span class="keyword">auto</span> ans2 = n - ans1;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (ans1 == <span class="number">-1</span>) <span class="built_in">cout</span> &lt;&lt; <span class="string">"No root"</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (ans1 == ans2) <span class="built_in">cout</span> &lt;&lt; ans1 &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">    <span class="keyword">else</span> <span class="built_in">cout</span> &lt;&lt; ans1 &lt;&lt; <span class="string">" "</span> &lt;&lt; ans2 &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<hr>
<h4 id="快速傅里叶变换-FFT"><a href="#快速傅里叶变换-FFT" class="headerlink" title="快速傅里叶变换 FFT"></a>快速傅里叶变换 FFT</h4><h5 id="多项式乘法"><a href="#多项式乘法" class="headerlink" title="多项式乘法"></a>多项式乘法</h5><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//计算多项式乘法F(x)*G(x)</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">输入</span></span><br><span class="line"><span class="comment">第一行2个正整数n, m</span></span><br><span class="line"><span class="comment">第二行n + 1个数字，从低到高表示F(x)的系数</span></span><br><span class="line"><span class="comment">第三行m + 1个数字，从低到高表示G(x)的系数</span></span><br><span class="line"><span class="comment">例子：</span></span><br><span class="line"><span class="comment">1 2</span></span><br><span class="line"><span class="comment">1 2</span></span><br><span class="line"><span class="comment">1 2 1</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">输出</span></span><br><span class="line"><span class="comment">一行n+m+1个数字，从低到高表示F(x)∗G(x)的系数</span></span><br><span class="line"><span class="comment">例子：</span></span><br><span class="line"><span class="comment">1 4 5 2</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">F(x) = 1 + 2*x</span></span><br><span class="line"><span class="comment">G(x) = 1 + 2*x + x^2</span></span><br><span class="line"><span class="comment">F(x)*G(x) = 1 + 4*x + 5*x^2 + 2*x^3</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rg register int</span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">10000001</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">double</span> pi = <span class="built_in">acos</span>(<span class="number">-1</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Complex</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="keyword">double</span> r, i;</span><br><span class="line">    Complex() &#123;&#125;</span><br><span class="line">    Complex(<span class="keyword">double</span> a, <span class="keyword">double</span> b) :r(a), i(b) &#123;&#125;</span><br><span class="line">    Complex <span class="keyword">operator</span> + (<span class="keyword">const</span> Complex B) <span class="keyword">const</span> &#123; <span class="keyword">return</span> Complex(r + B.r, i + B.i); &#125;</span><br><span class="line">    Complex <span class="keyword">operator</span> - (<span class="keyword">const</span> Complex B) <span class="keyword">const</span> &#123; <span class="keyword">return</span> Complex(r - B.r, i - B.i); &#125;</span><br><span class="line">    Complex <span class="keyword">operator</span> * (<span class="keyword">const</span> Complex B) <span class="keyword">const</span> &#123; <span class="keyword">return</span> Complex(r*B.r - i * B.i, r*B.i + i * B.r); &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">Complex X, Y, a[MAXN], b[MAXN];</span><br><span class="line"><span class="keyword">int</span> r[MAXN], n, m, l;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">FFT</span><span class="params">(Complex *a, <span class="keyword">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (rg i = <span class="number">0</span>; i &lt; n; i++)</span><br><span class="line">        <span class="keyword">if</span> (i &lt; r[i]) swap(a[i], a[r[i]]);</span><br><span class="line">    <span class="keyword">for</span> (rg i = <span class="number">1</span>; i &lt; n; i &lt;&lt;= <span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="function">Complex <span class="title">wn</span><span class="params">(<span class="built_in">cos</span>(pi / i), x*<span class="built_in">sin</span>(pi / i))</span></span>;</span><br><span class="line">        <span class="keyword">for</span> (rg j = <span class="number">0</span>; j &lt; n; j += (i &lt;&lt; <span class="number">1</span>))</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="function">Complex <span class="title">w</span><span class="params">(<span class="number">1</span>, <span class="number">0</span>)</span></span>;</span><br><span class="line">            <span class="keyword">for</span> (rg k = <span class="number">0</span>; k &lt; i; ++k, w = w * wn)</span><br><span class="line">            &#123;</span><br><span class="line">                X = a[j + k], Y = a[i + j + k] * w;</span><br><span class="line">                a[j + k] = X + Y, a[i + j + k] = X - Y;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (x == <span class="number">-1</span>)</span><br><span class="line">        <span class="keyword">for</span> (rg i = <span class="number">0</span>; i &lt; n; i++) a[i].r = a[i].r / n;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;n, &amp;m);</span><br><span class="line">    <span class="keyword">for</span> (rg i = <span class="number">0</span>; i &lt;= n; i++) <span class="built_in">scanf</span>(<span class="string">"%lf"</span>, &amp;a[i].r);</span><br><span class="line">    <span class="keyword">for</span> (rg i = <span class="number">0</span>; i &lt;= m; i++) <span class="built_in">scanf</span>(<span class="string">"%lf"</span>, &amp;b[i].r);</span><br><span class="line">    m += n;</span><br><span class="line">    <span class="keyword">for</span> (n = <span class="number">1</span>; n &lt;= m; n &lt;&lt;= <span class="number">1</span>) l++;</span><br><span class="line">    <span class="keyword">for</span> (rg i = <span class="number">0</span>; i &lt; n; i++)</span><br><span class="line">        r[i] = (r[i &gt;&gt; <span class="number">1</span>] &gt;&gt; <span class="number">1</span>) | ((i &amp; <span class="number">1</span>) &lt;&lt; (l - <span class="number">1</span>));</span><br><span class="line">    FFT(a, <span class="number">1</span>);</span><br><span class="line">    FFT(b, <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span> (rg i = <span class="number">0</span>; i &lt;= n; i++) a[i] = a[i] * b[i];</span><br><span class="line">    FFT(a, <span class="number">-1</span>);</span><br><span class="line">    <span class="keyword">for</span> (rg i = <span class="number">0</span>; i &lt;= m; i++)</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%d "</span>, (<span class="keyword">int</span>)(a[i].r + <span class="number">0.5</span>));</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<hr>
<h5 id="相同位数整数乘法"><a href="#相同位数整数乘法" class="headerlink" title="相同位数整数乘法"></a>相同位数整数乘法</h5><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">输入</span></span><br><span class="line"><span class="comment">位数</span></span><br><span class="line"><span class="comment">整数1</span></span><br><span class="line"><span class="comment">整数2</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rg register int</span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">1000001</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">long</span> <span class="keyword">double</span> pi = <span class="built_in">acos</span>(<span class="number">-1</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Complex</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="keyword">double</span> r, i;</span><br><span class="line">    Complex() &#123;&#125;</span><br><span class="line">    Complex(<span class="keyword">double</span> a, <span class="keyword">double</span> b) :r(a), i(b) &#123;&#125;</span><br><span class="line">    Complex <span class="keyword">operator</span> + (<span class="keyword">const</span> Complex B) <span class="keyword">const</span> &#123; <span class="keyword">return</span> Complex(r + B.r, i + B.i); &#125;</span><br><span class="line">    Complex <span class="keyword">operator</span> - (<span class="keyword">const</span> Complex B) <span class="keyword">const</span> &#123; <span class="keyword">return</span> Complex(r - B.r, i - B.i); &#125;</span><br><span class="line">    Complex <span class="keyword">operator</span> * (<span class="keyword">const</span> Complex B) <span class="keyword">const</span> &#123; <span class="keyword">return</span> Complex(r*B.r - i * B.i, r*B.i + i * B.r); &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">Complex X, Y, a[MAXN], b[MAXN];</span><br><span class="line"><span class="keyword">int</span> n, m, l, r[MAXN];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">FFT</span><span class="params">(Complex *a, <span class="keyword">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (rg i = <span class="number">0</span>; i &lt; n; i++)</span><br><span class="line">        <span class="keyword">if</span> (i &lt; r[i]) swap(a[i], a[r[i]]);</span><br><span class="line">    <span class="keyword">for</span> (rg i = <span class="number">1</span>; i &lt; n; i &lt;&lt;= <span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="function">Complex <span class="title">wn</span><span class="params">(<span class="built_in">cos</span>(pi / i), x*<span class="built_in">sin</span>(pi / i))</span></span>;</span><br><span class="line">        <span class="keyword">for</span> (rg j = <span class="number">0</span>; j &lt; n; j += (i &lt;&lt; <span class="number">1</span>))</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="function">Complex <span class="title">w</span><span class="params">(<span class="number">1</span>, <span class="number">0</span>)</span></span>;</span><br><span class="line">            <span class="keyword">for</span> (rg k = <span class="number">0</span>; k &lt; i; ++k, w = w * wn)</span><br><span class="line">            &#123;</span><br><span class="line">                X = a[j + k], Y = a[i + j + k] * w;</span><br><span class="line">                a[j + k] = X + Y, a[i + j + k] = X - Y;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (x == <span class="number">-1</span>) <span class="keyword">for</span> (rg i = <span class="number">0</span>; i &lt; n; i++) a[i].r = a[i].r / n;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">char</span> ch1[MAXN], ch2[MAXN];</span><br><span class="line"><span class="keyword">int</span> res[MAXN];</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;n);</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; ch1;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; ch2;</span><br><span class="line">    <span class="keyword">for</span> (rg i = <span class="number">0</span>; i &lt; n; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        a[i].r = ch1[n - i - <span class="number">1</span>] - <span class="string">'0'</span>;</span><br><span class="line">        b[i].r = ch2[n - i - <span class="number">1</span>] - <span class="string">'0'</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    m = n + n - <span class="number">2</span>;</span><br><span class="line">    <span class="keyword">for</span> (n = <span class="number">1</span>; n &lt;= m; n &lt;&lt;= <span class="number">1</span>) l++;</span><br><span class="line">    <span class="keyword">for</span> (rg i = <span class="number">0</span>; i &lt; n; i++)</span><br><span class="line">        r[i] = (r[i &gt;&gt; <span class="number">1</span>] &gt;&gt; <span class="number">1</span>) | ((i &amp; <span class="number">1</span>) &lt;&lt; (l - <span class="number">1</span>));</span><br><span class="line">    FFT(a, <span class="number">1</span>);</span><br><span class="line">    FFT(b, <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span> (rg i = <span class="number">0</span>; i &lt;= n; i++) a[i] = a[i] * b[i];</span><br><span class="line">    FFT(a, <span class="number">-1</span>);</span><br><span class="line">    <span class="keyword">for</span> (rg i = <span class="number">0</span>; i &lt;= m; i++) res[i] = (<span class="keyword">int</span>)(a[i].r + <span class="number">0.5</span>);</span><br><span class="line">    <span class="keyword">for</span> (rg i = <span class="number">0</span>; i &lt;= m; i++) res[i + <span class="number">1</span>] += res[i] / <span class="number">10</span>, res[i] %= <span class="number">10</span>;</span><br><span class="line">    rg top = m + <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (res[top] &gt; <span class="number">9</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        res[top + <span class="number">1</span>] = res[top] / <span class="number">10</span>;</span><br><span class="line">        res[top] %= <span class="number">10</span>;</span><br><span class="line">        top++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> (!res[top]) top--;</span><br><span class="line">    <span class="keyword">for</span> (rg i = top; i &gt;= <span class="number">0</span>; i--)</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%d"</span>, res[i]);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<hr>
<h5 id="任意整数乘法"><a href="#任意整数乘法" class="headerlink" title="任意整数乘法"></a>任意整数乘法</h5><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//较复杂</span></span><br><span class="line"><span class="comment">//时间较慢</span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">500100</span>; <span class="comment">//至少是数据长度的4倍</span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">double</span> PI = <span class="built_in">acos</span>(<span class="number">-1.0</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Complex</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="keyword">double</span> r, i;</span><br><span class="line">    Complex(<span class="keyword">double</span> _r = <span class="number">0.0</span>, <span class="keyword">double</span> _i = <span class="number">0.0</span>) &#123; r = _r; i = _i; &#125;</span><br><span class="line">    Complex <span class="keyword">operator</span> + (<span class="keyword">const</span> Complex &amp;b) &#123; <span class="keyword">return</span> Complex(r + b.r, i + b.i); &#125;</span><br><span class="line">    Complex <span class="keyword">operator</span> - (<span class="keyword">const</span> Complex &amp;b) &#123; <span class="keyword">return</span> Complex(r - b.r, i - b.i); &#125;</span><br><span class="line">    Complex <span class="keyword">operator</span> * (<span class="keyword">const</span> Complex &amp;b) &#123; <span class="keyword">return</span> Complex(r*b.r - i * b.i, r*b.i + i * b.r); &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">change</span><span class="params">(Complex y[], <span class="keyword">int</span> len)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> k;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>, j = len / <span class="number">2</span>; i &lt; len - <span class="number">1</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (i &lt; j) swap(y[i], y[j]);</span><br><span class="line">        k = len / <span class="number">2</span>;</span><br><span class="line">        <span class="keyword">while</span> (j &gt;= k)</span><br><span class="line">        &#123;</span><br><span class="line">            j -= k;</span><br><span class="line">            k /= <span class="number">2</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (j &lt; k) j += k;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//做FFT，len必须为2^k形式，on==1时是DFT，on==-1时是IDFT</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">fft</span><span class="params">(Complex y[], <span class="keyword">int</span> len, <span class="keyword">int</span> on)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    change(y, len);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> h = <span class="number">2</span>; h &lt;= len; h &lt;&lt;= <span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="function">Complex <span class="title">wn</span><span class="params">(<span class="built_in">cos</span>(-on * <span class="number">2</span> * PI / h), <span class="built_in">sin</span>(-on * <span class="number">2</span> * PI / h))</span></span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; len; j += h)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="function">Complex <span class="title">w</span><span class="params">(<span class="number">1</span>, <span class="number">0</span>)</span></span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> k = j; k &lt; j + h / <span class="number">2</span>; k++)</span><br><span class="line">            &#123;</span><br><span class="line">                Complex u = y[k];</span><br><span class="line">                Complex t = w * y[k + h / <span class="number">2</span>];</span><br><span class="line">                y[k] = u + t;</span><br><span class="line">                y[k + h / <span class="number">2</span>] = u - t;</span><br><span class="line">                w = w * wn;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (on == <span class="number">-1</span>)</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len; i++) y[i].r /= len;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">char</span> num1[maxn], num2[maxn];</span><br><span class="line">Complex x1[maxn], x2[maxn];</span><br><span class="line"><span class="keyword">int</span> ans[maxn];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">while</span> (<span class="built_in">cin</span> &gt;&gt; num1 &gt;&gt; num2)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">memset</span>(ans, <span class="number">0</span>, <span class="keyword">sizeof</span>(ans));</span><br><span class="line">        <span class="keyword">int</span> len = <span class="number">1</span>, len1 = <span class="built_in">strlen</span>(num1), len2 = <span class="built_in">strlen</span>(num2);</span><br><span class="line">        <span class="keyword">while</span> (len &lt; len1 + len2 + <span class="number">1</span>) len &lt;&lt;= <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len1; i++) x1[len1 - <span class="number">1</span> - i] = Complex((<span class="keyword">double</span>)(num1[i] - <span class="string">'0'</span>), <span class="number">0</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = len1; i &lt; len; i++) x1[i] = Complex(<span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">        fft(x1, len, <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len2; i++) x2[len2 - <span class="number">1</span> - i] = Complex((<span class="keyword">double</span>)(num2[i] - <span class="string">'0'</span>), <span class="number">0</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = len2; i &lt; len; i++) x2[i] = Complex(<span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">        fft(x2, len, <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len; i++) x1[i] = x1[i] * x2[i];</span><br><span class="line">        fft(x1, len, <span class="number">-1</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len; i++) ans[i] = (<span class="keyword">int</span>)(x1[i].r + <span class="number">0.5</span>);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 进位</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; len; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            ans[i] += ans[i - <span class="number">1</span>] / <span class="number">10</span>;</span><br><span class="line">            ans[i - <span class="number">1</span>] %= <span class="number">10</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">while</span> (len &gt; <span class="number">0</span> &amp;&amp; !ans[len]) len--;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = len; i &gt;= <span class="number">0</span>; i--) <span class="built_in">printf</span>(<span class="string">"%c"</span>, ans[i] + <span class="string">'0'</span>);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"\n"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<hr>
<h4 id="快速幂"><a href="#快速幂" class="headerlink" title="快速幂"></a>快速幂</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//O(logN) x^n</span></span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">qkpow</span><span class="params">(<span class="keyword">double</span> x, <span class="keyword">int</span> n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">auto</span> flag = n &gt;= <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">auto</span> <span class="built_in">pow</span> = <span class="built_in">abs</span>(<span class="keyword">static_cast</span>&lt;<span class="keyword">long</span> <span class="keyword">long</span>&gt;(n));</span><br><span class="line">    <span class="keyword">double</span> ans = <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> (<span class="built_in">pow</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">pow</span> &amp; <span class="number">1</span>) ans *= x;</span><br><span class="line">        x *= x;</span><br><span class="line">        <span class="built_in">pow</span> &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> flag ? ans : <span class="number">1</span> / ans;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">long</span> <span class="keyword">long</span> <span class="title">qkpow</span><span class="params">(<span class="keyword">long</span> <span class="keyword">long</span> x, <span class="keyword">long</span> <span class="keyword">long</span> n, <span class="keyword">const</span> <span class="keyword">long</span> <span class="keyword">long</span> mod)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">long</span> <span class="keyword">long</span> ans = <span class="number">1</span>;</span><br><span class="line">    x %= mod;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> (n)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (n &amp; <span class="number">1</span>) ans = (ans * x) % mod;</span><br><span class="line">        x = (x * x) % mod;</span><br><span class="line">        n &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> ans % mod;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<hr>
<h4 id="斐波那契数列"><a href="#斐波那契数列" class="headerlink" title="斐波那契数列"></a>斐波那契数列</h4><p>通项：</p>
<p>$$<br>a_{1}=1, a_{2}=1, a_{n}=a_{n-1}+a_{n-2}\left(n \geq 3, n \in N^{*}\right)<br>$$</p>
<p>$$<br>a_{n}=1 / \sqrt{5}\left[\left(\frac{1+\sqrt{5}}{2}\right)^{n}-\left(\frac{1-\sqrt{5}}{2}\right)^{n}\right]<br>$$</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 求第n项，模mod</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> mod(a, m) ((a) % (m) + (m)) % (m)</span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MOD = <span class="number">1e9</span> + <span class="number">9</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">MATRIX</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="keyword">long</span> <span class="keyword">long</span> a[<span class="number">2</span>][<span class="number">2</span>];</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">MATRIX a;</span><br><span class="line"><span class="keyword">long</span> <span class="keyword">long</span> f[<span class="number">2</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">ANS_Cf</span><span class="params">(MATRIX a)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    f[<span class="number">0</span>] = mod(a.a[<span class="number">0</span>][<span class="number">0</span>] + a.a[<span class="number">1</span>][<span class="number">0</span>], MOD);</span><br><span class="line">    f[<span class="number">1</span>] = mod(a.a[<span class="number">0</span>][<span class="number">1</span>] + a.a[<span class="number">1</span>][<span class="number">1</span>], MOD);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">MATRIX <span class="title">MATRIX_Cf</span><span class="params">(MATRIX a, MATRIX b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    MATRIX ans;</span><br><span class="line">    <span class="keyword">int</span> k;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">2</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; <span class="number">2</span>; j++)</span><br><span class="line">        &#123;</span><br><span class="line">            ans.a[i][j] = <span class="number">0</span>;</span><br><span class="line">            k = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">while</span> (k &lt; <span class="number">2</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                ans.a[i][j] += a.a[k][i] * b.a[j][k];</span><br><span class="line">                ans.a[i][j] = mod(ans.a[i][j], MOD);</span><br><span class="line">                ++k;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">MATRIX <span class="title">MATRIX_Pow</span><span class="params">(MATRIX a, <span class="keyword">long</span> <span class="keyword">long</span> n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    MATRIX ans;</span><br><span class="line">    ans.a[<span class="number">0</span>][<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">    ans.a[<span class="number">1</span>][<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">    ans.a[<span class="number">0</span>][<span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line">    ans.a[<span class="number">1</span>][<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (n)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (n &amp; <span class="number">1</span>) ans = MATRIX_Cf(ans, a);</span><br><span class="line">        n = n &gt;&gt; <span class="number">1</span>;</span><br><span class="line">        a = MATRIX_Cf(a, a);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">fib</span><span class="params">(<span class="keyword">long</span> <span class="keyword">long</span> n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (n == <span class="number">1</span>) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    a.a[<span class="number">0</span>][<span class="number">0</span>] = a.a[<span class="number">0</span>][<span class="number">1</span>] = a.a[<span class="number">1</span>][<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">    a.a[<span class="number">1</span>][<span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line">    a = MATRIX_Pow(a, n - <span class="number">2</span>);</span><br><span class="line">    ANS_Cf(a);</span><br><span class="line">    <span class="keyword">return</span> f[<span class="number">0</span>];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<hr>
<h4 id="素数"><a href="#素数" class="headerlink" title="素数"></a>素数</h4><h5 id="试商法"><a href="#试商法" class="headerlink" title="试商法"></a>试商法</h5><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//试商法</span></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">isPrime</span><span class="params">(<span class="keyword">const</span> <span class="keyword">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (x &lt; <span class="number">2</span>) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">auto</span> i = <span class="number">2</span>; i * i &lt;= x; i++)</span><br><span class="line">        <span class="keyword">if</span> (x % i == <span class="number">0</span>) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<hr>
<h5 id="打表法"><a href="#打表法" class="headerlink" title="打表法"></a>打表法</h5><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//O(n*loglogn)</span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">auto</span> n = <span class="number">1000</span>;</span><br><span class="line"><span class="keyword">int</span> a[n + <span class="number">5</span>] = &#123;<span class="number">1</span>, <span class="number">1</span>&#125;;</span><br><span class="line"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; v;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">auto</span> i = <span class="number">2</span>; i &lt;= n; i++)</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">auto</span> j = i * <span class="number">2</span>; j &lt;= n; j += i) a[j] = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">auto</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">    <span class="keyword">if</span> (a[i] == <span class="number">0</span>) v.emplace_back(i); <span class="comment">// 素数 a[i]==0</span></span><br></pre></td></tr></table></figure>

<hr>
<h4 id="素因子"><a href="#素因子" class="headerlink" title="素因子"></a>素因子</h4><h5 id="直接求"><a href="#直接求" class="headerlink" title="直接求"></a>直接求</h5><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 查询数的所有不重复素因子</span></span><br><span class="line"><span class="comment">// 暴力 O(sqrt(n))</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">getf</span><span class="params">(<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; &amp;v, <span class="keyword">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i * i &lt;= x; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (x % i == <span class="number">0</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            v.push_back(i);</span><br><span class="line">            <span class="keyword">while</span> (x % i == <span class="number">0</span>) x /= i;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (x == <span class="number">1</span>) <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (x != <span class="number">1</span>) v.push_back(x);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 对数进行分解质因数</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">getf</span><span class="params">(<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; &amp;v, <span class="keyword">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i * i &lt;= x; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">while</span> (x % i == <span class="number">0</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            v.push_back(i);</span><br><span class="line">            x /= i;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (x == <span class="number">1</span>) <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (x != <span class="number">1</span>) v.push_back(x);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<hr>
<h5 id="打表法-1"><a href="#打表法-1" class="headerlink" title="打表法"></a>打表法</h5><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 筛每个数的最小素因子</span></span><br><span class="line"><span class="comment">// 预处理 O(nloglogn)</span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">100000</span> + <span class="number">50</span>;</span><br><span class="line"><span class="keyword">int</span> spf[MAXN];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">init_spf</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt; MAXN - <span class="number">5</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (!spf[i])</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = i; j &lt; MAXN - <span class="number">5</span>; j += i)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span> (!spf[j]) spf[j] = i;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// O(logn)</span></span><br><span class="line"><span class="comment">// 查询数的所有不重复素因子</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">getf</span><span class="params">(<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; &amp;v, <span class="keyword">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">while</span> (x &gt; <span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">int</span> p = spf[x];</span><br><span class="line">        v.push_back(p);</span><br><span class="line">        <span class="keyword">while</span> (x % p == <span class="number">0</span>) x /= p;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 对数进行分解质因数</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">getf</span><span class="params">(<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; &amp;v, <span class="keyword">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">while</span> (x &gt; <span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">int</span> p = spf[x];</span><br><span class="line">        <span class="keyword">while</span> (x % p == <span class="number">0</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            v.push_back(p);</span><br><span class="line">            x /= p;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<hr>
<h4 id="逆元"><a href="#逆元" class="headerlink" title="逆元"></a>逆元</h4><h5 id="定义-1"><a href="#定义-1" class="headerlink" title="定义"></a>定义</h5><p>如果有 $a*b\equiv 1 \pmod{p}$ 且 $gcd(a,p)=1$ （a与p互质），则称b是模p意义下a的乘法逆元，记 $b=inv(a)$ 或 $b=a^{−1}$</p>
<p>(定义了模意义下的除法运算：除以一个数取模等于乘以这个数的逆元取模)</p>
<hr>
<h5 id="求法-1"><a href="#求法-1" class="headerlink" title="求法"></a>求法</h5><h6 id="费马小定理-1"><a href="#费马小定理-1" class="headerlink" title="费马小定理"></a>费马小定理</h6><p>由费马小定理得 $a^p-a \equiv 0 \pmod{p}$</p>
<p>即 $a^p \equiv a \pmod{p}$</p>
<p>即 $a^{p-1} \equiv 1 \pmod{p}$</p>
<p>即 $a*a^{p-2} \equiv 1 \pmod{p}$</p>
<p>当模数p为质数时， $a^{p-2}$ 即为a在模p意义下的逆元，快速幂求解即可，时间复杂度O(logn)</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//模数MOD为质数</span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">long</span> <span class="keyword">long</span> MOD = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">long</span> <span class="keyword">long</span> <span class="title">powMod</span><span class="params">(<span class="keyword">long</span> <span class="keyword">long</span> a, <span class="keyword">long</span> <span class="keyword">long</span> b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">long</span> <span class="keyword">long</span> ans = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (a %= MOD; b; b &gt;&gt;= <span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (b &amp; <span class="number">1</span>) ans = ans * a % MOD;</span><br><span class="line">        a = a * a % MOD;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">long</span> <span class="keyword">long</span> <span class="title">inv</span><span class="params">(<span class="keyword">long</span> <span class="keyword">long</span> x)</span> </span>&#123; <span class="keyword">return</span> powMod(x, MOD - <span class="number">2</span>); &#125;</span><br></pre></td></tr></table></figure>

<hr>
<h6 id="扩展欧几里得法"><a href="#扩展欧几里得法" class="headerlink" title="扩展欧几里得法"></a>扩展欧几里得法</h6><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//扩展欧几里得法，gcd(a, MOD) = 1时有逆元</span></span><br><span class="line"><span class="comment">//O(logn)</span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">long</span> <span class="keyword">long</span> MOD = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"><span class="function"><span class="keyword">long</span> <span class="keyword">long</span> <span class="title">exgcd</span><span class="params">(<span class="keyword">long</span> <span class="keyword">long</span> a, <span class="keyword">long</span> <span class="keyword">long</span> b, <span class="keyword">long</span> <span class="keyword">long</span> &amp;x, <span class="keyword">long</span> <span class="keyword">long</span> &amp;y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (b == <span class="number">0</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        x = <span class="number">1</span>;</span><br><span class="line">        y = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">return</span> a;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">long</span> <span class="keyword">long</span> d = exgcd(b, a % b, y, x);</span><br><span class="line">    y -= a / b * x;</span><br><span class="line">    <span class="keyword">return</span> d;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">long</span> <span class="keyword">long</span> <span class="title">inv</span><span class="params">(<span class="keyword">long</span> <span class="keyword">long</span> a)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">long</span> <span class="keyword">long</span> x, y;</span><br><span class="line">    <span class="keyword">long</span> <span class="keyword">long</span> d = exgcd(a, MOD, x, y);</span><br><span class="line">    <span class="keyword">if</span> (d == <span class="number">1</span>) <span class="keyword">return</span> (x % MOD + MOD) % MOD;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<hr>
<h6 id="打表法-2"><a href="#打表法-2" class="headerlink" title="打表法"></a>打表法</h6><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="keyword">long</span> <span class="keyword">long</span> MOD = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"><span class="keyword">long</span> <span class="keyword">long</span> inv[<span class="number">10000</span>];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">initInv</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    inv[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt; <span class="number">10000</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        inv[i] = <span class="number">1L</span>L * (MOD - MOD / i) * inv[MOD % i] % MOD;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<hr>
<h4 id="中国剩余定理"><a href="#中国剩余定理" class="headerlink" title="中国剩余定理"></a>中国剩余定理</h4><p>孙子定理：有物不知其数，三三数之剩二，五五数之剩三，七七数之剩二。问物几何？</p>
<p>求解同余方程组</p>
<p>$$<br>\left{\begin{array}{l}{x \equiv a_{1}\left(\bmod m_{1}\right)} \ {x \equiv a_{2}\left(\bmod m_{2}\right)} \ {x \equiv a_{3}\left(\bmod m_{3}\right)} \ {\ldots} \ {x \equiv a_{k}\left(\bmod m_{k}\right)}\end{array}\right.<br>$$</p>
<p>其中 $m_{1}, m_{2}, m_{3} \dots m_{k}$ 为两两互质的整数</p>
<p>求 $x$ 的最小非负整数解</p>
<p>解：</p>
<p>令 $M=\prod_{i=1}^{k} m_{i}$ ，即 $M$ 是所有 $m_i$ 的最小公倍数</p>
<p>$t_i$ 为 $\frac{M}{m_{i}}$ 模 $m_i$ 的逆元，即 $\frac{M}{m_{i}} t_{i} \equiv 1\left(\bmod m_{i}\right)$ 的最小非负整数解</p>
<p>则有一个解为 $x=\sum_{i=1}^{k} a_{i} \frac{M}{m_{i}} t_{i}$</p>
<p>通解为 $x+i * M(i \in Z)$</p>
<p>特别的，最小非负整数解为 (x%M+M)%M</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">china</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> k; <span class="comment">// 方程组数</span></span><br><span class="line">    <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; m; <span class="comment">//方程中的m</span></span><br><span class="line">    <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; a; <span class="comment">//方程中的a</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">int</span> ans = <span class="number">0</span>, lcm = <span class="number">1</span>, x, y;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= k; ++i) lcm *= m[i];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= k; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">int</span> tp = lcm / m[i];</span><br><span class="line">        exgcd(tp, m[i], x, y);</span><br><span class="line">        x = (x % m[i] + m[i]) % m[i]; <span class="comment">//x要为最小非负整数解</span></span><br><span class="line">        ans = (ans + tp * x * a[i]) % lcm;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> (ans + lcm) % lcm;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<hr>
<h4 id="整数运算"><a href="#整数运算" class="headerlink" title="整数运算"></a>整数运算</h4><h5 id="大整数"><a href="#大整数" class="headerlink" title="大整数"></a>大整数</h5><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br><span class="line">553</span><br><span class="line">554</span><br><span class="line">555</span><br><span class="line">556</span><br><span class="line">557</span><br><span class="line">558</span><br><span class="line">559</span><br><span class="line">560</span><br><span class="line">561</span><br><span class="line">562</span><br><span class="line">563</span><br><span class="line">564</span><br><span class="line">565</span><br><span class="line">566</span><br><span class="line">567</span><br><span class="line">568</span><br><span class="line">569</span><br><span class="line">570</span><br><span class="line">571</span><br><span class="line">572</span><br><span class="line">573</span><br><span class="line">574</span><br><span class="line">575</span><br><span class="line">576</span><br><span class="line">577</span><br><span class="line">578</span><br><span class="line">579</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//2的n次方可以用pow直接算</span></span><br><span class="line"><span class="comment">//UTF-8 使用限定</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdlib&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;list&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;map&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;fstream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> BIGNUM_DEBUG 2333</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Bignum</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">mknum</span><span class="params">(<span class="keyword">const</span> <span class="keyword">char</span> *s, <span class="keyword">int</span> len = <span class="number">-1</span>)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        sign = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">if</span> (*s == <span class="string">'-'</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            mknum(s + <span class="number">1</span>);</span><br><span class="line">            sign = <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">int</span> l;</span><br><span class="line">        <span class="keyword">if</span> (len == <span class="number">-1</span>) l = <span class="built_in">strlen</span>(s);</span><br><span class="line">        <span class="keyword">else</span> l = len;</span><br><span class="line">        l = <span class="built_in">strlen</span>(s);</span><br><span class="line">        bits.clear();</span><br><span class="line">        bits.resize(l);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = l - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i--) bits[l - i - <span class="number">1</span>] = s[i] - <span class="string">'0'</span>;</span><br><span class="line">        maintain();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">mknum</span><span class="params">(<span class="built_in">string</span> &amp;s)</span> </span>&#123; mknum(s.c_str(), s.length()); &#125;</span><br><span class="line">    <span class="comment">///////////////////////////////////////////////////////////////////</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">us_addto</span><span class="params">(Bignum &amp;b)</span>  <span class="comment">// unsigned add to</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> mlen = max(b.bits.size(), bits.size());</span><br><span class="line">        <span class="keyword">int</span> slen = bits.size();</span><br><span class="line">        <span class="keyword">int</span> olen = b.bits.size();</span><br><span class="line">        bits.resize(mlen);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; mlen; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">int</span> s = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">if</span> (i &lt; slen)s += bits[i];</span><br><span class="line">            <span class="keyword">if</span> (i &lt; olen)s += b.bits[i];</span><br><span class="line">            bits[i] = s;</span><br><span class="line">        &#125;</span><br><span class="line">        maintain();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">FFTer</span></span></span><br><span class="line"><span class="class">    &#123;</span></span><br><span class="line">        <span class="class"><span class="keyword">class</span> <span class="title">Complex</span></span></span><br><span class="line"><span class="class">        &#123;</span></span><br><span class="line">        <span class="keyword">public</span>:</span><br><span class="line">            <span class="keyword">double</span> real, image;</span><br><span class="line">            Complex(<span class="keyword">double</span> a = <span class="number">0</span>, <span class="keyword">double</span> b = <span class="number">0</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                real = a;</span><br><span class="line">                image = b;</span><br><span class="line">            &#125;</span><br><span class="line">            Complex <span class="keyword">operator</span> + (<span class="keyword">const</span> Complex &amp;o) &#123; <span class="keyword">return</span> Complex(real + o.real, image + o.image); &#125;</span><br><span class="line">            Complex <span class="keyword">operator</span> - (<span class="keyword">const</span> Complex &amp;o) &#123; <span class="keyword">return</span> Complex(real - o.real, image - o.image); &#125;</span><br><span class="line">            Complex <span class="keyword">operator</span> * (<span class="keyword">const</span> Complex &amp;o) &#123; <span class="keyword">return</span> Complex(real*o.real - image * o.image, real*o.image + o.real*image); &#125;</span><br><span class="line">            Complex <span class="keyword">operator</span> * (<span class="keyword">double</span> k) &#123; <span class="keyword">return</span> Complex(real*k, image*k); &#125;</span><br><span class="line">            Complex <span class="keyword">operator</span> / (<span class="keyword">double</span> k) &#123; <span class="keyword">return</span> Complex(real / k, image / k); &#125;</span><br><span class="line">        &#125;;</span><br><span class="line">    <span class="keyword">public</span>:</span><br><span class="line">        <span class="built_in">vector</span>&lt;Complex&gt; a;  <span class="comment">//系数向量</span></span><br><span class="line">        <span class="keyword">int</span> n;              <span class="comment">//多项式次数上界</span></span><br><span class="line">        FFTer(<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; &amp;vec)</span><br><span class="line">        &#123;</span><br><span class="line">            a.resize(vec.size());</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; vec.size(); i++) a[i].real = vec[i];</span><br><span class="line">            n = vec.size();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function"><span class="keyword">void</span> <span class="title">transform</span><span class="params">()</span></span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            <span class="keyword">int</span> j = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">int</span> k;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span> (j &gt; i) swap(a[i], a[j]);</span><br><span class="line">                k = n;</span><br><span class="line">                <span class="keyword">while</span> (j &amp; (k &gt;&gt;= <span class="number">1</span>)) j &amp;= ~k;</span><br><span class="line">                j |= k;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function"><span class="keyword">void</span> <span class="title">FFT</span><span class="params">(<span class="keyword">bool</span> IDFT = <span class="literal">false</span>)</span></span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            <span class="keyword">const</span> <span class="keyword">double</span> Pi = IDFT ? -<span class="built_in">acos</span>(<span class="number">-1.0</span>) : <span class="built_in">acos</span>(<span class="number">-1.0</span>);</span><br><span class="line">            <span class="comment">//IDFT与DFT选择方向相反（符号相反）</span></span><br><span class="line">            transform();<span class="comment">//交换元素（翻转二进制位，具体看下面注释，再具体看算导</span></span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> s = <span class="number">1</span>; s &lt; n; s &lt;&lt;= <span class="number">1</span>)</span><br><span class="line">                <span class="comment">//算法导论上是fot s = 1 to lgn,考虑到精度问题改为上面那个...</span></span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> t = <span class="number">0</span>; t &lt; n; t += s &lt;&lt; <span class="number">1</span>)</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="comment">//合并[t, t+s-1]与 [t+s, t+2*s-1] (算导上以指数形式给出，注意到他的s....)</span></span><br><span class="line">                    <span class="comment">//合并为[t, t+2*s-1] (看起来像是废话) (有示例图在算导上，画得很形象的)</span></span><br><span class="line">                    <span class="keyword">double</span> x = Pi / s;</span><br><span class="line">                    <span class="function">Complex <span class="title">omgn</span><span class="params">(<span class="built_in">cos</span>(x), <span class="built_in">sin</span>(x))</span></span>;</span><br><span class="line">                    <span class="function">Complex <span class="title">omg</span><span class="params">(<span class="number">1.0</span>, <span class="number">0.0</span>)</span></span>;    <span class="comment">//单位向量</span></span><br><span class="line">                    <span class="keyword">for</span> (<span class="keyword">int</span> m = <span class="number">0</span>; m &lt; s; m++)</span><br><span class="line">                    &#123;            <span class="comment">//旋转</span></span><br><span class="line">                        <span class="keyword">int</span> a1 = m + t;</span><br><span class="line">                        <span class="keyword">int</span> a2 = m + t + s;   <span class="comment">//取两边系数向量的系数</span></span><br><span class="line">                        <span class="comment">//算导上管这个叫公共子表达式消除</span></span><br><span class="line">                        <span class="comment">//其实就是一个变量计算一次然后保存下来用多次</span></span><br><span class="line">                        Complex comm = omg * a[a2];</span><br><span class="line">                        a[a2] = a[a1] - comm;</span><br><span class="line">                        a[a1] = a[a1] + comm;  <span class="comment">//这两个顺序不要反了</span></span><br><span class="line">                        omg = omg * omgn;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            <span class="keyword">if</span> (IDFT)</span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) a[i] = a[i] / n;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function"><span class="keyword">void</span> <span class="title">mul</span><span class="params">(FFTer &amp;o)</span></span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            <span class="keyword">int</span> s = <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">while</span> (s &lt; n + o.n)s &lt;&lt;= <span class="number">1</span>;</span><br><span class="line">            n = o.n = s;</span><br><span class="line">            a.resize(s);</span><br><span class="line">            o.a.resize(s);</span><br><span class="line">            FFT(<span class="literal">false</span>);</span><br><span class="line">            o.FFT(<span class="literal">false</span>);</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) a[i] = a[i] * o.a[i];</span><br><span class="line">            FFT(<span class="literal">true</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">us_multo</span><span class="params">(Bignum &amp;b)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="function">FFTer <span class="title">x</span><span class="params">(bits)</span></span>;</span><br><span class="line">        <span class="function">FFTer <span class="title">y</span><span class="params">(b.bits)</span></span>;</span><br><span class="line">        x.mul(y);</span><br><span class="line">        bits.clear();</span><br><span class="line">        bits.resize(x.a.size());</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; x.n; i++) bits[i] = (<span class="keyword">int</span>)(x.a[i].real + <span class="number">0.5</span>);</span><br><span class="line">        maintain();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">us_multo_simu</span><span class="params">(Bignum &amp;b)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; r;</span><br><span class="line">        r.resize(max(length(), b.length()) &lt;&lt; <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; length(); i++)</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; b.length(); j++) r[i + j] += bits[i] * b.bits[j];</span><br><span class="line">        *(&amp;(<span class="keyword">this</span>-&gt;bits)) = r;</span><br><span class="line">        maintain();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">us_subto</span><span class="params">(Bignum &amp;b)</span> <span class="comment">// abs(self) &gt;= abs(other)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> mlen = length();</span><br><span class="line">        <span class="keyword">int</span> olen = b.length();</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; mlen; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">int</span> s = bits[i];</span><br><span class="line">            <span class="keyword">if</span> (i &lt; olen) s -= b.bits[i];</span><br><span class="line">            bits[i] = s;</span><br><span class="line">            <span class="keyword">if</span> (bits[i] &lt; <span class="number">0</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                bits[i] += <span class="number">10</span>;</span><br><span class="line">                bits[i + <span class="number">1</span>] -= <span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = bits.size() - <span class="number">1</span>; !bits[i] &amp;&amp; i &gt;= <span class="number">1</span>; i--) bits.pop_back();</span><br><span class="line">        <span class="keyword">if</span> (bits.size() == <span class="number">1</span> &amp;&amp; bits[<span class="number">0</span>] == <span class="number">0</span>) sign = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">us_divto</span><span class="params">(Bignum &amp;b)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (length() == <span class="number">1</span> &amp;&amp; bits[<span class="number">0</span>] == <span class="number">0</span>) <span class="keyword">return</span>;</span><br><span class="line">        <span class="function">Bignum <span class="title">L</span><span class="params">(<span class="string">"0"</span>)</span></span>;</span><br><span class="line">        L.sign = <span class="number">0</span>;</span><br><span class="line">        <span class="function">Bignum <span class="title">R</span><span class="params">(*<span class="keyword">this</span>)</span></span>;</span><br><span class="line">        R.sign = <span class="number">0</span>;</span><br><span class="line">        <span class="function">Bignum <span class="title">two</span><span class="params">(<span class="string">"2"</span>)</span></span>;</span><br><span class="line">        R *= two;</span><br><span class="line">        <span class="function">Bignum <span class="title">one</span><span class="params">(<span class="string">"1"</span>)</span></span>;</span><br><span class="line">        one.sign = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span> (L + one != R)</span><br><span class="line">        &#123;</span><br><span class="line">            Bignum M = L + R;</span><br><span class="line">            M.divto2();</span><br><span class="line">            Bignum t = M * b;</span><br><span class="line">            <span class="keyword">if</span> (t &gt; *<span class="keyword">this</span>) R = M;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span> (t &lt; *<span class="keyword">this</span>) L = M;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                *<span class="keyword">this</span> = M;</span><br><span class="line">                L = M;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        *<span class="keyword">this</span> = L;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="keyword">int</span> sign;</span><br><span class="line">    <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; bits;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">length</span><span class="params">()</span> </span>&#123; <span class="keyword">return</span> bits.size(); &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">maintain</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; bits.size(); i++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (i + <span class="number">1</span> &lt; bits.size()) bits[i + <span class="number">1</span>] += bits[i] / <span class="number">10</span>;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span> (bits[i] &gt; <span class="number">9</span>) bits.push_back(bits[i] / <span class="number">10</span>);</span><br><span class="line">            bits[i] %= <span class="number">10</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (bits.size() == <span class="number">0</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            bits.push_back(<span class="number">0</span>);</span><br><span class="line">            sign = <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = bits.size() - <span class="number">1</span>; !bits[i] &amp;&amp; i &gt;= <span class="number">1</span>; i--) bits.pop_back();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    Bignum(<span class="built_in">string</span> &amp;s)</span><br><span class="line">    &#123;</span><br><span class="line">        Bignum();</span><br><span class="line">        mknum(s);</span><br><span class="line">    &#125;</span><br><span class="line">    Bignum(<span class="keyword">const</span> <span class="keyword">char</span> *s)</span><br><span class="line">    &#123;</span><br><span class="line">        Bignum();</span><br><span class="line">        mknum(s);</span><br><span class="line">    &#125;</span><br><span class="line">    Bignum(<span class="keyword">int</span> n)</span><br><span class="line">    &#123;</span><br><span class="line">        Bignum();</span><br><span class="line">        <span class="keyword">char</span> buf[<span class="number">15</span>];</span><br><span class="line">        <span class="built_in">sprintf</span>(buf, <span class="string">"%d"</span>, n);</span><br><span class="line">        mknum(buf);</span><br><span class="line">    &#125;</span><br><span class="line">    Bignum()</span><br><span class="line">    &#123;</span><br><span class="line">        sign = <span class="number">0</span>;</span><br><span class="line">        bits.push_back(<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    Bignum(<span class="keyword">const</span> Bignum&amp; b)</span><br><span class="line">    &#123;</span><br><span class="line">        copy(b);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">copy</span><span class="params">(<span class="keyword">const</span> Bignum&amp; b)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        sign = b.sign;</span><br><span class="line">        bits = b.bits;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">///////////////////////////////////////////////////</span></span><br><span class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">us_cmp</span><span class="params">(Bignum &amp;b)</span>   <span class="comment">//无符号的比较</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (length() != b.length()) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        <span class="keyword">int</span> l = length();</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; l; i++)</span><br><span class="line">            <span class="keyword">if</span> (bits[i] != b.bits[i]) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">us_larger</span><span class="params">(Bignum &amp;b)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (length() &gt; b.length()) <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (length() &lt; b.length()) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        <span class="keyword">int</span> l = length();</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = l - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i--)</span><br><span class="line">            <span class="keyword">if</span> (bits[i] &gt; b.bits[i]) <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span> (bits[i] &lt; b.bits[i]) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">bool</span> <span class="keyword">operator</span> == (Bignum &amp;o)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (sign != o.sign) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        <span class="keyword">return</span> us_cmp(o);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">bool</span> <span class="keyword">operator</span> != (Bignum &amp;o) &#123; <span class="keyword">return</span> !(*<span class="keyword">this</span> == o); &#125;</span><br><span class="line">    <span class="keyword">bool</span> <span class="keyword">operator</span> &gt; (Bignum &amp;o)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (sign == <span class="number">0</span> &amp;&amp; o.sign == <span class="number">1</span>) <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        <span class="keyword">if</span> (sign == <span class="number">1</span> &amp;&amp; o.sign == <span class="number">0</span>) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        <span class="keyword">if</span> (sign == o.sign &amp;&amp; sign) <span class="keyword">return</span> !us_larger(o);</span><br><span class="line">        <span class="keyword">return</span> us_larger(o);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">bool</span> <span class="keyword">operator</span> &lt; (Bignum &amp;o)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> !(*<span class="keyword">this</span> == o || *<span class="keyword">this</span> &gt; o);   <span class="comment">//小于就是不等于也不大于</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">bool</span> <span class="keyword">operator</span> &lt;= (Bignum &amp;o)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> *<span class="keyword">this</span> &lt; o || *<span class="keyword">this</span> == o;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">bool</span> <span class="keyword">operator</span> &gt;= (Bignum &amp;o)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> *<span class="keyword">this</span> &gt; o || *<span class="keyword">this</span> == o;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">////////////////////////////////////////////////////</span></span><br><span class="line">    Bignum&amp; <span class="keyword">operator</span> += (Bignum &amp;o)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (!sign &amp;&amp; !o.sign)</span><br><span class="line">        &#123;</span><br><span class="line">            us_addto(o);</span><br><span class="line">            sign = <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (sign &amp;&amp; o.sign)</span><br><span class="line">        &#123;</span><br><span class="line">            us_addto(o);</span><br><span class="line">            sign = <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (sign &amp;&amp; !o.sign)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (o.us_larger(*<span class="keyword">this</span>))</span><br><span class="line">            &#123;</span><br><span class="line">                Bignum t(o);</span><br><span class="line">                t.us_subto(*<span class="keyword">this</span>);</span><br><span class="line">                *<span class="keyword">this</span> = t;</span><br><span class="line">                sign = <span class="number">0</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                us_subto(o);</span><br><span class="line">                sign = <span class="number">1</span>;</span><br><span class="line">                <span class="keyword">if</span> (bits.size() == <span class="number">1</span> &amp;&amp; bits[<span class="number">0</span>] == <span class="number">0</span>) sign = <span class="number">0</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (!sign &amp;&amp; o.sign)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (us_larger(o))</span><br><span class="line">            &#123;</span><br><span class="line">                us_subto(o);</span><br><span class="line">                sign = <span class="number">0</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                Bignum t(o);</span><br><span class="line">                t.us_subto(*<span class="keyword">this</span>);</span><br><span class="line">                *<span class="keyword">this</span> = t;</span><br><span class="line">                sign = <span class="number">1</span>;</span><br><span class="line">                <span class="keyword">if</span> (bits.size() == <span class="number">1</span> &amp;&amp; bits[<span class="number">0</span>] == <span class="number">0</span>) sign = <span class="number">0</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> *<span class="keyword">this</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    Bignum <span class="keyword">operator</span> + (Bignum &amp;o)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="function">Bignum <span class="title">t</span><span class="params">(*<span class="keyword">this</span>)</span></span>;</span><br><span class="line">        t += o;</span><br><span class="line">        <span class="keyword">return</span> t;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/////////////////////////////////////////////////</span></span><br><span class="line">    Bignum&amp; <span class="keyword">operator</span>*= (Bignum &amp;o)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (length() + o.length() &gt; <span class="number">800</span>) us_multo(o); <span class="comment">//FFT</span></span><br><span class="line">        <span class="keyword">else</span> us_multo_simu(o);                          <span class="comment">//simulate</span></span><br><span class="line">        <span class="keyword">if</span> (sign == o.sign) sign = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">else</span> sign = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">return</span> *<span class="keyword">this</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    Bignum <span class="keyword">operator</span>* (Bignum &amp;o)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="function">Bignum <span class="title">t</span><span class="params">(*<span class="keyword">this</span>)</span></span>;</span><br><span class="line">        t *= o;</span><br><span class="line">        <span class="keyword">return</span> t;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">////////////////////////////////////////////////</span></span><br><span class="line">    Bignum&amp; <span class="keyword">operator</span>-= (Bignum &amp;o)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (!sign &amp;&amp; !o.sign)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (us_larger(o))</span><br><span class="line">            &#123;</span><br><span class="line">                us_subto(o);</span><br><span class="line">                sign = <span class="number">0</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                Bignum t(o);</span><br><span class="line">                t.us_subto(*<span class="keyword">this</span>);</span><br><span class="line">                *<span class="keyword">this</span> = t;</span><br><span class="line">                sign = <span class="number">1</span>;</span><br><span class="line">                <span class="keyword">if</span> (bits.size() == <span class="number">1</span> &amp;&amp; bits[<span class="number">0</span>] == <span class="number">0</span>) sign = <span class="number">0</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (sign &amp;&amp; o.sign)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (us_larger(o))</span><br><span class="line">            &#123;</span><br><span class="line">                us_subto(o);</span><br><span class="line">                sign = <span class="number">1</span>;</span><br><span class="line">                <span class="keyword">if</span> (bits.size() == <span class="number">1</span> &amp;&amp; bits[<span class="number">0</span>] == <span class="number">0</span>) sign = <span class="number">0</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                Bignum t(o);</span><br><span class="line">                t.us_subto(*<span class="keyword">this</span>);</span><br><span class="line">                *<span class="keyword">this</span> = t;</span><br><span class="line">                sign = <span class="number">0</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (!sign &amp;&amp; o.sign)</span><br><span class="line">        &#123;</span><br><span class="line">            us_addto(o);</span><br><span class="line">            sign = <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (sign &amp;&amp; !o.sign)</span><br><span class="line">        &#123;</span><br><span class="line">            us_addto(o);</span><br><span class="line">            sign = <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> *<span class="keyword">this</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    Bignum <span class="keyword">operator</span> - (Bignum &amp;o)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="function">Bignum <span class="title">t</span><span class="params">(*<span class="keyword">this</span>)</span></span>;</span><br><span class="line">        t -= o;</span><br><span class="line">        <span class="keyword">return</span> t;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">///////////////////////////////////////////////</span></span><br><span class="line">    <span class="function">Bignum&amp; <span class="title">divto2</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (!bits.size()) <span class="keyword">return</span> *<span class="keyword">this</span>;</span><br><span class="line">        bits[<span class="number">0</span>] &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">int</span> i;</span><br><span class="line">        <span class="keyword">for</span> (i = <span class="number">1</span>; i &lt; bits.size(); i++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (bits[i] &amp; <span class="number">1</span>) bits[i - <span class="number">1</span>] += <span class="number">5</span>;</span><br><span class="line">            bits[i] &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (bits[i - <span class="number">1</span>] == <span class="number">0</span>) bits.pop_back();</span><br><span class="line">        <span class="keyword">return</span> *<span class="keyword">this</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    Bignum&amp; <span class="keyword">operator</span> /= (Bignum &amp;o)</span><br><span class="line">    &#123;</span><br><span class="line">        us_divto(o);</span><br><span class="line">        <span class="keyword">if</span> (sign == o.sign) sign = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">else</span> sign = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">return</span> *<span class="keyword">this</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    Bignum <span class="keyword">operator</span> / (Bignum &amp;o)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="function">Bignum <span class="title">t</span><span class="params">(*<span class="keyword">this</span>)</span></span>;</span><br><span class="line">        t /= o;</span><br><span class="line">        <span class="keyword">return</span> t;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//////////////////////////////////////////</span></span><br><span class="line">    <span class="function">Bignum <span class="title">abs</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="function">Bignum <span class="title">t</span><span class="params">(*<span class="keyword">this</span>)</span></span>;</span><br><span class="line">        t.sign = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">return</span> t;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function">Bignum <span class="title">sqrt</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        Bignum L("0"), R(*this);</span><br><span class="line">        <span class="function">Bignum <span class="title">one</span><span class="params">(<span class="string">"1"</span>)</span></span>;</span><br><span class="line">        Bignum m, t;</span><br><span class="line">        <span class="keyword">while</span> (L + one != R)</span><br><span class="line">        &#123;</span><br><span class="line">            m = L + R;</span><br><span class="line">            m.divto2();</span><br><span class="line">            Bignum t = m * m;</span><br><span class="line">            <span class="keyword">if</span> (t == *<span class="keyword">this</span>) <span class="keyword">return</span> m;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span> (t &gt; *<span class="keyword">this</span>) R = m;</span><br><span class="line">            <span class="keyword">else</span> L = m;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> L;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//若e &lt;= 0则会返回1</span></span><br><span class="line">    <span class="comment">//底数（也就是this）是负数的话会根据次数决定符号</span></span><br><span class="line">    <span class="function">Bignum <span class="title">pow</span><span class="params">(Bignum &amp;e)</span> <span class="comment">//a^b == a.pow(b)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (e.sign)<span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">        <span class="function">Bignum <span class="title">ans</span><span class="params">(<span class="string">"1"</span>)</span></span>;</span><br><span class="line">        <span class="function">Bignum <span class="title">base</span><span class="params">(*<span class="keyword">this</span>)</span></span>;</span><br><span class="line">        <span class="function">Bignum <span class="title">zero</span><span class="params">(<span class="string">"0"</span>)</span></span>;</span><br><span class="line">        <span class="function">Bignum <span class="title">exp</span><span class="params">(e)</span></span>;</span><br><span class="line">        <span class="keyword">while</span> (<span class="built_in">exp</span> &gt; zero)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (<span class="built_in">exp</span>.bits[<span class="number">0</span>] &amp; <span class="number">1</span>) ans *= base;</span><br><span class="line">            base *= base;</span><br><span class="line">            <span class="built_in">exp</span>.divto2();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (sign &amp;&amp; e.bits[<span class="number">0</span>] &amp; <span class="number">1</span>) ans.sign = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//注意，如果本数小于底数返回1...</span></span><br><span class="line">    <span class="function">Bignum <span class="title">log</span><span class="params">(Bignum &amp;base)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (sign) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">if</span> (length() == <span class="number">1</span> &amp;&amp; bits[<span class="number">0</span>] == <span class="number">1</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">if</span> (*<span class="keyword">this</span> &lt;= base) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">        <span class="function">Bignum <span class="title">one</span><span class="params">(<span class="string">"1"</span>)</span></span>;</span><br><span class="line">        <span class="function">Bignum <span class="title">r</span><span class="params">(<span class="string">"1"</span>)</span></span>;</span><br><span class="line">        <span class="function">Bignum <span class="title">c</span><span class="params">(<span class="string">"0"</span>)</span></span>;</span><br><span class="line">        <span class="keyword">while</span> (r &lt; *<span class="keyword">this</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            r *= base;</span><br><span class="line">            c += one;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (r != *<span class="keyword">this</span>) c -= one;</span><br><span class="line">        <span class="keyword">return</span> c;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">Bignum <span class="title">lg</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="function">Bignum <span class="title">ten</span><span class="params">(<span class="string">"10"</span>)</span></span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">log</span>(ten);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function">Bignum <span class="title">factorial</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="function">Bignum <span class="title">r</span><span class="params">(<span class="string">"1"</span>)</span></span>;</span><br><span class="line">        <span class="function">Bignum <span class="title">zero</span><span class="params">(<span class="string">"0"</span>)</span></span>;</span><br><span class="line">        <span class="function">Bignum <span class="title">one</span><span class="params">(<span class="string">"1"</span>)</span></span>;</span><br><span class="line">        <span class="function">Bignum <span class="title">t</span><span class="params">(*<span class="keyword">this</span>)</span></span>;</span><br><span class="line">        <span class="keyword">while</span> (t &gt; zero)</span><br><span class="line">        &#123;</span><br><span class="line">            r *= t;</span><br><span class="line">            t -= one;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> r;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/////////////////////////////////////////////////////////</span></span><br><span class="line">    <span class="keyword">friend</span> istream&amp; <span class="keyword">operator</span> &gt;&gt; (istream &amp;is, Bignum &amp;b)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">string</span> s;</span><br><span class="line">        is &gt;&gt; s;</span><br><span class="line">        b.mknum(s);</span><br><span class="line">        <span class="keyword">return</span> is;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">friend</span> ostream&amp; <span class="keyword">operator</span> &lt;&lt; (ostream &amp;os, Bignum b)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (b.sign)os &lt;&lt; <span class="string">'-'</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = b.bits.size() - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i--) os &lt;&lt; b.bits[i];</span><br><span class="line">        <span class="keyword">return</span> os;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="built_in">string</span> <span class="title">to_string</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> sz = length();</span><br><span class="line">        <span class="built_in">string</span> s;</span><br><span class="line">        <span class="keyword">if</span> (sign) s.resize(sz + <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">else</span> s.resize(sz);</span><br><span class="line">        <span class="keyword">int</span> i = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">if</span> (sign) s[i++] = <span class="string">'-'</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = sz - <span class="number">1</span>; i &lt; sz + sign; i++, j--) s[i] = bits[j] + <span class="string">'0'</span>;</span><br><span class="line">        <span class="keyword">return</span> s;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">////////////////////////////</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">ifdef</span> BIGNUM_DEBUG</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">ifdef</span> __GNUC__</span></span><br><span class="line">__attribute__((noinline))     <span class="comment">//禁止内联</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">ifdef</span> __MINGW32__</span></span><br><span class="line">__attribute__((noinline))</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line"><span class="function"><span class="keyword">char</span>* <span class="title">printB</span><span class="params">(Bignum &amp;b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">//仅仅是用于能在gdb中使用它来输出自己</span></span><br><span class="line">    <span class="built_in">string</span> s = b.to_string();</span><br><span class="line">    <span class="keyword">char</span> *buf = (<span class="keyword">char</span> *)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(<span class="keyword">char</span>) * s.length());</span><br><span class="line">    <span class="comment">//这个函数仅用于调试，这里申请的内存不会释放</span></span><br><span class="line">    <span class="comment">//因此非调试时不要使用这个函数</span></span><br><span class="line">    <span class="built_in">strcpy</span>(buf, s.c_str());</span><br><span class="line">    <span class="keyword">return</span> buf;  <span class="comment">//然后gdb中就可以 print printB(一个Bignum )</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    Bignum a;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; a;</span><br><span class="line">    a = a * a;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; a;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<hr>
<h5 id="自动取模"><a href="#自动取模" class="headerlink" title="自动取模"></a>自动取模</h5><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">long</span> <span class="keyword">long</span> MOD&gt;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">mod_number</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    mod_number() : x(<span class="number">0</span>) &#123;&#125;</span><br><span class="line"></span><br><span class="line">    mod_number(<span class="keyword">long</span> <span class="keyword">long</span> _) &#123; x = (_ % MOD + MOD) % MOD; &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="keyword">long</span> <span class="keyword">long</span> x;</span><br><span class="line"></span><br><span class="line">    <span class="function">mod_number <span class="title">pow</span><span class="params">(<span class="keyword">long</span> <span class="keyword">long</span> n)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        mod_number a = *<span class="keyword">this</span>, ans = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">while</span> (n)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (n &amp; <span class="number">1</span>) ans *= a;</span><br><span class="line">            n &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">            a *= a;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function">mod_number <span class="title">inv</span><span class="params">()</span> </span>&#123; <span class="keyword">return</span> <span class="built_in">pow</span>(MOD - <span class="number">2</span>); &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    mod_number <span class="keyword">operator</span>+(<span class="keyword">const</span> mod_number &amp;y) &#123; <span class="keyword">return</span> mod_number(x + y.x); &#125;</span><br><span class="line"></span><br><span class="line">    mod_number <span class="keyword">operator</span>-(<span class="keyword">const</span> mod_number &amp;y) &#123; <span class="keyword">return</span> mod_number(x - y.x); &#125;</span><br><span class="line"></span><br><span class="line">    mod_number <span class="keyword">operator</span>*(<span class="keyword">const</span> mod_number &amp;y) &#123; <span class="keyword">return</span> mod_number(x * y.x); &#125;</span><br><span class="line"></span><br><span class="line">    mod_number <span class="keyword">operator</span>/(mod_number y) &#123; <span class="keyword">return</span> mod_number(mod_number(x) * y.inv()); &#125;</span><br><span class="line"></span><br><span class="line">    mod_number &amp;<span class="keyword">operator</span>+=(<span class="keyword">const</span> mod_number &amp;y) &#123; <span class="keyword">return</span> *<span class="keyword">this</span> = *<span class="keyword">this</span> + y; &#125;</span><br><span class="line"></span><br><span class="line">    mod_number &amp;<span class="keyword">operator</span>-=(<span class="keyword">const</span> mod_number &amp;y) &#123; <span class="keyword">return</span> *<span class="keyword">this</span> = *<span class="keyword">this</span> - y; &#125;</span><br><span class="line"></span><br><span class="line">    mod_number &amp;<span class="keyword">operator</span>*=(<span class="keyword">const</span> mod_number &amp;y) &#123; <span class="keyword">return</span> *<span class="keyword">this</span> = *<span class="keyword">this</span> * y; &#125;</span><br><span class="line"></span><br><span class="line">    mod_number &amp;<span class="keyword">operator</span>/=(mod_number y) &#123; <span class="keyword">return</span> *<span class="keyword">this</span> = *<span class="keyword">this</span> / y; &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> mod_number <span class="keyword">operator</span>++(<span class="keyword">int</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="function">mod_number <span class="title">temp</span><span class="params">(x)</span></span>;</span><br><span class="line">        *<span class="keyword">this</span> += <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">return</span> temp;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> mod_number <span class="keyword">operator</span>--(<span class="keyword">int</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="function">mod_number <span class="title">temp</span><span class="params">(x)</span></span>;</span><br><span class="line">        *<span class="keyword">this</span> -= <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">return</span> temp;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    mod_number <span class="keyword">operator</span>++() &#123; <span class="keyword">return</span> *<span class="keyword">this</span> += <span class="number">1</span>; &#125;</span><br><span class="line"></span><br><span class="line">    mod_number <span class="keyword">operator</span>--() &#123; <span class="keyword">return</span> *<span class="keyword">this</span> -= <span class="number">1</span>; &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">bool</span> <span class="keyword">operator</span>&lt;(<span class="keyword">const</span> mod_number &amp;y) &#123; <span class="keyword">return</span> x &lt; y.x; &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">bool</span> <span class="keyword">operator</span>&gt;(<span class="keyword">const</span> mod_number &amp;y) &#123; <span class="keyword">return</span> x &gt; y.x; &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">bool</span> <span class="keyword">operator</span>&lt;=(<span class="keyword">const</span> mod_number &amp;y) &#123; <span class="keyword">return</span> x &lt;= y.x; &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">bool</span> <span class="keyword">operator</span>&gt;=(<span class="keyword">const</span> mod_number &amp;y) &#123; <span class="keyword">return</span> x &gt;= y.x; &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">bool</span> <span class="keyword">operator</span>==(<span class="keyword">const</span> mod_number &amp;y) &#123; <span class="keyword">return</span> x == y.x; &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">bool</span> <span class="keyword">operator</span>!=(<span class="keyword">const</span> mod_number &amp;y) &#123; <span class="keyword">return</span> x != y.x; &#125;</span><br><span class="line"></span><br><span class="line">    mod_number <span class="keyword">operator</span>[](<span class="keyword">int</span>) &#123; <span class="keyword">return</span> inv(); &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">friend</span> <span class="built_in">std</span>::ostream &amp;<span class="keyword">operator</span>&lt;&lt;(<span class="built_in">std</span>::ostream &amp;os, <span class="keyword">const</span> mod_number &amp;y) &#123; <span class="keyword">return</span> os &lt;&lt; y.x; &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">friend</span> <span class="built_in">std</span>::istream &amp;<span class="keyword">operator</span>&gt;&gt;(<span class="built_in">std</span>::istream &amp;is, mod_number &amp;y)</span><br><span class="line">    &#123;</span><br><span class="line">        is &gt;&gt; y.x;</span><br><span class="line">        <span class="keyword">if</span> (!is) y = mod_number();</span><br><span class="line">        <span class="keyword">else</span> y = mod_number(y.x);</span><br><span class="line">        <span class="keyword">return</span> is;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">//声明</span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">long</span> <span class="keyword">long</span> IntMaxn = <span class="number">19260817</span>; <span class="comment">//此处为质数</span></span><br><span class="line"><span class="keyword">using</span> Int = ModInt&lt;IntMaxn&gt;;</span><br><span class="line"></span><br><span class="line"><span class="comment">//使用</span></span><br><span class="line"><span class="comment">//for循环请不要用Int做循环变量</span></span><br><span class="line">Int a, b[<span class="number">10</span>];       <span class="comment">//声明数与数组</span></span><br><span class="line"><span class="built_in">cin</span>&gt;&gt;a;             <span class="comment">//输入</span></span><br><span class="line"><span class="built_in">cout</span>&lt;&lt;a;            <span class="comment">//输出</span></span><br><span class="line">Int x=Int(<span class="number">1</span>);       <span class="comment">//类型转换</span></span><br><span class="line">Int(a).<span class="built_in">pow</span>(b.x);    <span class="comment">//快速幂，a的b次方</span></span><br><span class="line">q.inv();            <span class="comment">//q的乘法逆元</span></span><br></pre></td></tr></table></figure>

<hr>
<h4 id="求N-的最后一位的非0数"><a href="#求N-的最后一位的非0数" class="headerlink" title="求N!的最后一位的非0数"></a>求N!的最后一位的非0数</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> ff[] = &#123;<span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">6</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">8</span>, <span class="number">4</span>, <span class="number">6</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">fact</span><span class="params">(<span class="keyword">int</span> n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> i, x;</span><br><span class="line">    <span class="keyword">if</span> (n &lt; <span class="number">5</span>) <span class="keyword">return</span> ff[n];</span><br><span class="line">    x = (ff[n % <span class="number">10</span>] * <span class="number">6</span>) % <span class="number">10</span>;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">1</span>; i &lt;= (n / <span class="number">5</span>) % <span class="number">4</span>; i++)</span><br><span class="line">        <span class="keyword">if</span> (x == <span class="number">6</span> || x == <span class="number">2</span>) x = (x + <span class="number">10</span>) / <span class="number">2</span>;</span><br><span class="line">        <span class="keyword">else</span> x /= <span class="number">2</span>;</span><br><span class="line">    <span class="keyword">return</span> (fact(n / <span class="number">5</span>) * x) % <span class="number">10</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<hr>
<h4 id="星期问题"><a href="#星期问题" class="headerlink" title="星期问题"></a>星期问题</h4><p>基姆拉尔森公式</p>
<p>$$<br>W = (D + 2M + 3(M + 1) / 5 + Y + Y / 4 - Y / 100 + Y / 400) \mod 7<br>$$</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 已知1752年9月3日是Sunday，并且日期控制在1700年2月28日后</span></span><br><span class="line"><span class="keyword">char</span> name[][<span class="number">15</span>] = &#123;</span><br><span class="line">    <span class="string">"monday"</span>, <span class="string">"tuesday"</span>, <span class="string">"wednesday"</span>, <span class="string">"thursday"</span>, <span class="string">"friday"</span>, <span class="string">"saturday"</span>,</span><br><span class="line">    <span class="string">"sunday"</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> d, m, y, a;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"Day: "</span>);</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;d);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"Month: "</span>);</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;m);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"Year: "</span>);</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;y);</span><br><span class="line">    <span class="comment">// 一二月当做前一年的十三十四月</span></span><br><span class="line">    <span class="keyword">if</span> (m == <span class="number">1</span> || m == <span class="number">2</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        m += <span class="number">12</span>;</span><br><span class="line">        y--;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 判断是否在1752年9月3日之前</span></span><br><span class="line">    <span class="keyword">if</span> ((y &lt; <span class="number">1752</span>) || (y == <span class="number">1752</span> &amp;&amp; m &lt; <span class="number">9</span>) || (y == <span class="number">1752</span> &amp;&amp; m == <span class="number">9</span> &amp;&amp; d &lt; <span class="number">3</span>))</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// 因为日期控制在1700年2月28日后，所以不用考虑整百年是否是闰年</span></span><br><span class="line">        a = (d + <span class="number">2</span> * m + <span class="number">3</span> * (m + <span class="number">1</span>) / <span class="number">5</span> + y + y / <span class="number">4</span> + <span class="number">5</span>) % <span class="number">7</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// 这里需要考虑整百年是否是闰年</span></span><br><span class="line">        a = (d + <span class="number">2</span> * m + <span class="number">3</span> * (m + <span class="number">1</span>) / <span class="number">5</span> + y + y / <span class="number">4</span> - y / <span class="number">100</span> + y / <span class="number">400</span>) % <span class="number">7</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"it's a %s\n"</span>, name[a]);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<hr>
<h4 id="计算几何"><a href="#计算几何" class="headerlink" title="计算几何"></a>计算几何</h4><h5 id="Pick-公式"><a href="#Pick-公式" class="headerlink" title="Pick 公式"></a>Pick 公式</h5><p>顶点坐标均是整点的简单多边形:</p>
<p>面积 = 内部格点数 + 边上格点数 / 2 - 1</p>
<p>S = n + s / 2 - 1</p>
<p>(其中n表示多边形内部的点数,s表示多边形边界上的点数,S表示多边形的面积)</p>
<hr>
<h5 id="已知圆锥表面积S求最大体积V"><a href="#已知圆锥表面积S求最大体积V" class="headerlink" title="已知圆锥表面积S求最大体积V"></a>已知圆锥表面积S求最大体积V</h5><p>$$<br>V = S \times \sqrt{\frac{S}{72\pi}}<br>$$</p>
<hr>
<h5 id="常用"><a href="#常用" class="headerlink" title="常用"></a>常用</h5><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Point</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="keyword">double</span> x, y;</span><br><span class="line">    Point(<span class="keyword">double</span> x = <span class="number">0</span>, <span class="keyword">double</span> y = <span class="number">0</span>) : x(x), y(y) &#123;&#125;</span><br><span class="line">    Point <span class="keyword">operator</span> + (Point p) &#123; <span class="keyword">return</span> Point(x + p.x, y + p.y); &#125;</span><br><span class="line">    Point <span class="keyword">operator</span> - (Point p) &#123; <span class="keyword">return</span> Point(x - p.x, y - p.y); &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">typedef</span> Point Vector;</span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">getDot</span><span class="params">(Vector a, Vector b)</span> </span>&#123; <span class="keyword">return</span> a.x * b.x + a.y * b.y; &#125;    <span class="comment">// 点积</span></span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">getCross</span><span class="params">(Vector a, Vector b)</span> </span>&#123; <span class="keyword">return</span> a.x * b.y - a.y * b.x; &#125;  <span class="comment">// 叉积</span></span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">getLength</span><span class="params">(Vector a)</span> </span>&#123; <span class="keyword">return</span> <span class="built_in">sqrt</span>(getDot(a, a)); &#125;              <span class="comment">// 模</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 绕原点逆时针旋转角度B（弧度值）</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">transXY</span><span class="params">(Point &amp;p, <span class="keyword">double</span> B)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">double</span> x = p.x, y = p.y;</span><br><span class="line">    p.x = x * <span class="built_in">cos</span>(B) - y * <span class="built_in">sin</span>(B);</span><br><span class="line">    p.y = x * <span class="built_in">sin</span>(B) + y * <span class="built_in">cos</span>(B);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 判断三点共线（整数值）</span></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">isCollinear</span><span class="params">(<span class="keyword">const</span> Point &amp;d1, <span class="keyword">const</span> Point &amp;d2, <span class="keyword">const</span> Point &amp;d)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">long</span> <span class="keyword">long</span> f = <span class="number">1L</span>L * (d.x - d2.x) * (d1.y - d2.y);</span><br><span class="line">    <span class="keyword">long</span> <span class="keyword">long</span> g = <span class="number">1L</span>L * (d.y - d2.y) * (d1.x - d2.x);</span><br><span class="line">    <span class="keyword">return</span> f == g;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<hr>
<h5 id="凸多边形宽度"><a href="#凸多边形宽度" class="headerlink" title="凸多边形宽度"></a>凸多边形宽度</h5><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//平行切线间的最小距离</span></span><br><span class="line"><span class="comment">//多边形的最小的长度</span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">115</span>; <span class="comment">//点的数量</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">P</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="keyword">int</span> x, y;</span><br><span class="line">    P() &#123;&#125;</span><br><span class="line">    P (<span class="keyword">int</span> _x, <span class="keyword">int</span> _y) &#123; x = _x, y = _y; &#125;</span><br><span class="line">    P <span class="keyword">operator</span> - (P b) &#123; <span class="keyword">return</span> P(x - b.x, y - b.y); &#125;</span><br><span class="line">    <span class="function"><span class="keyword">double</span> <span class="title">len</span><span class="params">()</span> </span>&#123; <span class="keyword">return</span> hypot(x, y); &#125;</span><br><span class="line">&#125; a[MAXN];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">cross</span><span class="params">(P a, P b)</span> </span>&#123; <span class="keyword">return</span> a.x*b.y - a.y*b.x; &#125;</span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">dist</span><span class="params">(P p, P a, P b)</span> </span>&#123; <span class="keyword">return</span> cross(p - a, b - a) / (b - a).len(); &#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">min_len</span><span class="params">(<span class="keyword">int</span> n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">double</span> ans = <span class="number">1e100</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt; i; j++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">double</span> l = <span class="number">1e100</span>, r = <span class="number">-1e100</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">1</span>; k &lt;= n; k++)</span><br><span class="line">            &#123;</span><br><span class="line">                l = min(l, dist(a[k], a[i], a[j]));</span><br><span class="line">                r = max(r, dist(a[k], a[i], a[j]));</span><br><span class="line">            &#125;</span><br><span class="line">            r -= l;</span><br><span class="line">            ans = min(ans, r);</span><br><span class="line">        &#125;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> n;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) <span class="built_in">cin</span>&gt;&gt;a[i].x&gt;&gt;a[i].y;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%.10f\n"</span>, min_len(n));</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<hr>
<h5 id="凸包-图形-交点-交线-数学-半平面交"><a href="#凸包-图形-交点-交线-数学-半平面交" class="headerlink" title="凸包,图形,交点,交线,数学,半平面交"></a>凸包,图形,交点,交线,数学,半平面交</h5><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;complex&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">typedef</span> pair&lt;<span class="keyword">int</span>,<span class="keyword">int</span>&gt; pii;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">double</span> pi = <span class="number">4</span> * <span class="built_in">atan</span>(<span class="number">1</span>);</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">double</span> eps = <span class="number">1e-10</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">dcmp</span> <span class="params">(<span class="keyword">double</span> x)</span> </span>&#123; <span class="keyword">if</span> (<span class="built_in">fabs</span>(x) &lt; eps) <span class="keyword">return</span> <span class="number">0</span>; <span class="keyword">else</span> <span class="keyword">return</span> x &lt; <span class="number">0</span> ? <span class="number">-1</span> : <span class="number">1</span>; &#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">double</span> <span class="title">getDistance</span> <span class="params">(<span class="keyword">double</span> x, <span class="keyword">double</span> y)</span> </span>&#123; <span class="keyword">return</span> <span class="built_in">sqrt</span>(x * x + y * y); &#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">double</span> <span class="title">torad</span><span class="params">(<span class="keyword">double</span> deg)</span> </span>&#123; <span class="keyword">return</span> deg / <span class="number">180</span> * pi; &#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Point</span> &#123;</span></span><br><span class="line">    <span class="keyword">double</span> x, y;</span><br><span class="line">    Point (<span class="keyword">double</span> x = <span class="number">0</span>, <span class="keyword">double</span> y = <span class="number">0</span>): x(x), y(y) &#123;&#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">read</span> <span class="params">()</span> </span>&#123; <span class="built_in">scanf</span>(<span class="string">"%lf%lf"</span>, &amp;x, &amp;y); &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">write</span> <span class="params">()</span> </span>&#123; <span class="built_in">printf</span>(<span class="string">"%f %f"</span>, x, y); &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">bool</span> <span class="keyword">operator</span> == (<span class="keyword">const</span> Point&amp; u) <span class="keyword">const</span> &#123; <span class="keyword">return</span> dcmp(x - u.x) == <span class="number">0</span> &amp;&amp; dcmp(y - u.y) == <span class="number">0</span>; &#125;</span><br><span class="line">    <span class="keyword">bool</span> <span class="keyword">operator</span> != (<span class="keyword">const</span> Point&amp; u) <span class="keyword">const</span> &#123; <span class="keyword">return</span> !(*<span class="keyword">this</span> == u); &#125;</span><br><span class="line">    <span class="keyword">bool</span> <span class="keyword">operator</span> &lt; (<span class="keyword">const</span> Point&amp; u) <span class="keyword">const</span> &#123; <span class="keyword">return</span> dcmp(x - u.x) &lt; <span class="number">0</span> || (dcmp(x-u.x)==<span class="number">0</span> &amp;&amp; dcmp(y-u.y) &lt; <span class="number">0</span>); &#125;</span><br><span class="line">    <span class="keyword">bool</span> <span class="keyword">operator</span> &gt; (<span class="keyword">const</span> Point&amp; u) <span class="keyword">const</span> &#123; <span class="keyword">return</span> u &lt; *<span class="keyword">this</span>; &#125;</span><br><span class="line">    <span class="keyword">bool</span> <span class="keyword">operator</span> &lt;= (<span class="keyword">const</span> Point&amp; u) <span class="keyword">const</span> &#123; <span class="keyword">return</span> *<span class="keyword">this</span> &lt; u || *<span class="keyword">this</span> == u; &#125;</span><br><span class="line">    <span class="keyword">bool</span> <span class="keyword">operator</span> &gt;= (<span class="keyword">const</span> Point&amp; u) <span class="keyword">const</span> &#123; <span class="keyword">return</span> *<span class="keyword">this</span> &gt; u || *<span class="keyword">this</span> == u; &#125;</span><br><span class="line">    Point <span class="keyword">operator</span> + (<span class="keyword">const</span> Point&amp; u) &#123; <span class="keyword">return</span> Point(x + u.x, y + u.y); &#125;</span><br><span class="line">    Point <span class="keyword">operator</span> - (<span class="keyword">const</span> Point&amp; u) &#123; <span class="keyword">return</span> Point(x - u.x, y - u.y); &#125;</span><br><span class="line">    Point <span class="keyword">operator</span> * (<span class="keyword">const</span> <span class="keyword">double</span> u) &#123; <span class="keyword">return</span> Point(x * u, y * u); &#125;</span><br><span class="line">    Point <span class="keyword">operator</span> / (<span class="keyword">const</span> <span class="keyword">double</span> u) &#123; <span class="keyword">return</span> Point(x / u, y / u); &#125;</span><br><span class="line">    <span class="keyword">double</span> <span class="keyword">operator</span> ^ (<span class="keyword">const</span> Point&amp; u) &#123; <span class="keyword">return</span> x*u.y - y*u.x; &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">typedef</span> Point Vector;</span><br><span class="line"><span class="keyword">typedef</span> <span class="built_in">vector</span>&lt;Point&gt; Polygon;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Line</span> &#123;</span></span><br><span class="line">    <span class="keyword">double</span> a, b, c;</span><br><span class="line">    Line (<span class="keyword">double</span> a = <span class="number">0</span>, <span class="keyword">double</span> b = <span class="number">0</span>, <span class="keyword">double</span> c = <span class="number">0</span>): a(a), b(b), c(c) &#123;&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">DirLine</span> &#123;</span></span><br><span class="line">    Point p;</span><br><span class="line">    Vector v;</span><br><span class="line">    <span class="keyword">double</span> ang;</span><br><span class="line">    DirLine () &#123;&#125;</span><br><span class="line">    DirLine (Point p, Vector v): p(p), v(v) &#123; ang = <span class="built_in">atan2</span>(v.y, v.x); &#125;</span><br><span class="line">    <span class="keyword">bool</span> <span class="keyword">operator</span> &lt; (<span class="keyword">const</span> DirLine&amp; u) <span class="keyword">const</span> &#123; <span class="keyword">return</span> ang &lt; u.ang; &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Circle</span> &#123;</span></span><br><span class="line">    Point o;</span><br><span class="line">    <span class="keyword">double</span> r;</span><br><span class="line">    Circle () &#123;&#125;</span><br><span class="line">    Circle (Point o, <span class="keyword">double</span> r = <span class="number">0</span>): o(o), r(r) &#123;&#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">read</span> <span class="params">()</span> </span>&#123; o.read(), <span class="built_in">scanf</span>(<span class="string">"%lf"</span>, &amp;r); &#125;</span><br><span class="line">    <span class="function">Point <span class="title">point</span><span class="params">(<span class="keyword">double</span> rad)</span> </span>&#123; <span class="keyword">return</span> Point(o.x + <span class="built_in">cos</span>(rad)*r, o.y + <span class="built_in">sin</span>(rad)*r); &#125;</span><br><span class="line">    <span class="function"><span class="keyword">double</span> <span class="title">getArea</span> <span class="params">(<span class="keyword">double</span> rad)</span> </span>&#123; <span class="keyword">return</span> rad * r * r / <span class="number">2</span>; &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> Punctual &#123;</span><br><span class="line">    <span class="function"><span class="keyword">double</span> <span class="title">getDistance</span> <span class="params">(Point a, Point b)</span> </span>&#123; <span class="keyword">double</span> x=a.x-b.x, y=a.y-b.y; <span class="keyword">return</span> <span class="built_in">sqrt</span>(x*x + y*y); &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> Vectorial &#123;</span><br><span class="line">    <span class="comment">/* 点积: 两向量长度的乘积再乘上它们夹角的余弦, 夹角大于90度时点积为负 */</span></span><br><span class="line">    <span class="function"><span class="keyword">double</span> <span class="title">getDot</span> <span class="params">(Vector a, Vector b)</span> </span>&#123; <span class="keyword">return</span> a.x * b.x + a.y * b.y; &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* 叉积: 叉积等于两向量组成的三角形有向面积的两倍, cross(v, w) = -cross(w, v) */</span></span><br><span class="line">    <span class="function"><span class="keyword">double</span> <span class="title">getCross</span> <span class="params">(Vector a, Vector b)</span> </span>&#123; <span class="keyword">return</span> a.x * b.y - a.y * b.x; &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">double</span> <span class="title">getLength</span> <span class="params">(Vector a)</span> </span>&#123; <span class="keyword">return</span> <span class="built_in">sqrt</span>(getDot(a, a)); &#125;</span><br><span class="line">    <span class="function"><span class="keyword">double</span> <span class="title">getPLength</span> <span class="params">(Vector a)</span> </span>&#123; <span class="keyword">return</span> getDot(a, a); &#125;</span><br><span class="line">    <span class="function"><span class="keyword">double</span> <span class="title">getAngle</span> <span class="params">(Vector u)</span> </span>&#123; <span class="keyword">return</span> <span class="built_in">atan2</span>(u.y, u.x); &#125;</span><br><span class="line">    <span class="function"><span class="keyword">double</span> <span class="title">getAngle</span> <span class="params">(Vector a, Vector b)</span> </span>&#123; <span class="keyword">return</span> <span class="built_in">acos</span>(getDot(a, b) / getLength(a) / getLength(b)); &#125;</span><br><span class="line">    <span class="function">Vector <span class="title">rotate</span> <span class="params">(Vector a, <span class="keyword">double</span> rad)</span> </span>&#123; <span class="keyword">return</span> Vector(a.x*<span class="built_in">cos</span>(rad)-a.y*<span class="built_in">sin</span>(rad), a.x*<span class="built_in">sin</span>(rad)+a.y*<span class="built_in">cos</span>(rad)); &#125;</span><br><span class="line">    <span class="comment">/* 单位法线 */</span></span><br><span class="line">    <span class="function">Vector <span class="title">getNormal</span> <span class="params">(Vector a)</span> </span>&#123; <span class="keyword">double</span> l = getLength(a); <span class="keyword">return</span> Vector(-a.y/l, a.x/l); &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> ComplexVector &#123;</span><br><span class="line">    <span class="keyword">typedef</span> <span class="built_in">complex</span>&lt;<span class="keyword">double</span>&gt; Point;</span><br><span class="line">    <span class="keyword">typedef</span> Point Vector;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">double</span> <span class="title">getDot</span><span class="params">(Vector a, Vector b)</span> </span>&#123; <span class="keyword">return</span> real(conj(a)*b); &#125;</span><br><span class="line">    <span class="function"><span class="keyword">double</span> <span class="title">getCross</span><span class="params">(Vector a, Vector b)</span> </span>&#123; <span class="keyword">return</span> imag(conj(a)*b); &#125;</span><br><span class="line">    <span class="function">Vector <span class="title">rotate</span><span class="params">(Vector a, <span class="keyword">double</span> rad)</span> </span>&#123; <span class="keyword">return</span> a*<span class="built_in">exp</span>(Point(<span class="number">0</span>, rad)); &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> Linear &#123;</span><br><span class="line">    <span class="keyword">using</span> <span class="keyword">namespace</span> Vectorial;</span><br><span class="line"></span><br><span class="line">    <span class="function">Line <span class="title">getLine</span> <span class="params">(<span class="keyword">double</span> x1, <span class="keyword">double</span> y1, <span class="keyword">double</span> x2, <span class="keyword">double</span> y2)</span> </span>&#123; <span class="keyword">return</span> Line(y2-y1, x1-x2, y1*x2-x1*y2); &#125;</span><br><span class="line">    <span class="function">Line <span class="title">getLine</span> <span class="params">(<span class="keyword">double</span> a, <span class="keyword">double</span> b, Point u)</span> </span>&#123; <span class="keyword">return</span> Line(a, -b, u.y * b - u.x * a); &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">getIntersection</span> <span class="params">(Line p, Line q, Point&amp; o)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">fabs</span>(p.a * q.b - q.a * p.b) &lt; eps)</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        o.x = (q.c * p.b - p.c * q.b) / (p.a * q.b - q.a * p.b);</span><br><span class="line">        o.y = (q.c * p.a - p.c * q.a) / (p.b * q.a - q.b * p.a);</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* 直线pv和直线qw的交点 */</span></span><br><span class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">getIntersection</span> <span class="params">(Point p, Vector v, Point q, Vector w, Point&amp; o)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (dcmp(getCross(v, w)) == <span class="number">0</span>) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        Vector u = p - q;</span><br><span class="line">        <span class="keyword">double</span> k = getCross(w, u) / getCross(v, w);</span><br><span class="line">        o = p + v * k;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* 点p到直线ab的距离 */</span></span><br><span class="line">    <span class="function"><span class="keyword">double</span> <span class="title">getDistanceToLine</span> <span class="params">(Point p, Point a, Point b)</span> </span>&#123; <span class="keyword">return</span> <span class="built_in">fabs</span>(getCross(b-a, p-a) / getLength(b-a)); &#125;</span><br><span class="line">    <span class="function"><span class="keyword">double</span> <span class="title">getDistanceToSegment</span> <span class="params">(Point p, Point a, Point b)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (a == b) <span class="keyword">return</span> getLength(p-a);</span><br><span class="line">        Vector v1 = b - a, v2 = p - a, v3 = p - b;</span><br><span class="line">        <span class="keyword">if</span> (dcmp(getDot(v1, v2)) &lt; <span class="number">0</span>) <span class="keyword">return</span> getLength(v2);</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (dcmp(getDot(v1, v3)) &gt; <span class="number">0</span>) <span class="keyword">return</span> getLength(v3);</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">return</span> <span class="built_in">fabs</span>(getCross(v1, v2) / getLength(v1));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* 点p在直线ab上的投影 */</span></span><br><span class="line">    <span class="function">Point <span class="title">getPointToLine</span> <span class="params">(Point p, Point a, Point b)</span> </span>&#123; Vector v = b-a; <span class="keyword">return</span> a+v*(getDot(v, p-a) / getDot(v,v)); &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* 判断线段是否存在交点 */</span></span><br><span class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">haveIntersection</span> <span class="params">(Point a1, Point a2, Point b1, Point b2)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">double</span> c1=getCross(a2-a1, b1-a1), c2=getCross(a2-a1, b2-a1), c3=getCross(b2-b1, a1-b1), c4=getCross(b2-b1,a2-b1);</span><br><span class="line">        <span class="keyword">return</span> dcmp(c1)*dcmp(c2) &lt; <span class="number">0</span> &amp;&amp; dcmp(c3)*dcmp(c4) &lt; <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* 判断点是否在线段上 */</span></span><br><span class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">onSegment</span> <span class="params">(Point p, Point a, Point b)</span> </span>&#123; <span class="keyword">return</span> dcmp(getCross(a-p, b-p)) == <span class="number">0</span> &amp;&amp; dcmp(getDot(a-p, b-p)) &lt; <span class="number">0</span>; &#125;</span><br><span class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">onLine</span> <span class="params">(Point p, Point a, Point b)</span> </span>&#123; <span class="keyword">return</span> dcmp(getCross(a-p, b-p)) == <span class="number">0</span>&#125;</span><br><span class="line">    <span class="keyword">bool</span> onLeft(DirLine l, Point p) &#123; <span class="keyword">return</span> dcmp(l.v ^ (p-l.p)) &gt;= <span class="number">0</span>; &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> Triangular &#123;</span><br><span class="line">    <span class="keyword">using</span> <span class="keyword">namespace</span> Vectorial;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">double</span> <span class="title">getAngle</span> <span class="params">(<span class="keyword">double</span> a, <span class="keyword">double</span> b, <span class="keyword">double</span> c)</span> </span>&#123; <span class="keyword">return</span> <span class="built_in">acos</span>((a*a+b*b-c*c) / (<span class="number">2</span>*a*b)); &#125;</span><br><span class="line">    <span class="function"><span class="keyword">double</span> <span class="title">getArea</span> <span class="params">(<span class="keyword">double</span> a, <span class="keyword">double</span> b, <span class="keyword">double</span> c)</span> </span>&#123; <span class="keyword">double</span> s =(a+b+c)/<span class="number">2</span>; <span class="keyword">return</span> <span class="built_in">sqrt</span>(s*(s-a)*(s-b)*(s-c)); &#125;</span><br><span class="line">    <span class="function"><span class="keyword">double</span> <span class="title">getArea</span> <span class="params">(<span class="keyword">double</span> a, <span class="keyword">double</span> h)</span> </span>&#123; <span class="keyword">return</span> a * h / <span class="number">2</span>; &#125;</span><br><span class="line">    <span class="function"><span class="keyword">double</span> <span class="title">getArea</span> <span class="params">(Point a, Point b, Point c)</span> </span>&#123; <span class="keyword">return</span> <span class="built_in">fabs</span>(getCross(b - a, c - a)) / <span class="number">2</span>; &#125;</span><br><span class="line">    <span class="function"><span class="keyword">double</span> <span class="title">getDirArea</span> <span class="params">(Point a, Point b, Point c)</span> </span>&#123; <span class="keyword">return</span> getCross(b - a, c - a) / <span class="number">2</span>; &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> Polygonal &#123;</span><br><span class="line">    <span class="keyword">using</span> <span class="keyword">namespace</span> Vectorial;</span><br><span class="line">    <span class="keyword">using</span> <span class="keyword">namespace</span> Linear;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">double</span> <span class="title">getArea</span> <span class="params">(Point* p, <span class="keyword">int</span> n)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">double</span> ret = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n<span class="number">-1</span>; i++)</span><br><span class="line">            ret += (p[i]-p[<span class="number">0</span>]) ^ (p[i+<span class="number">1</span>]-p[<span class="number">0</span>]);</span><br><span class="line">        <span class="keyword">return</span> ret/<span class="number">2</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* 凸包 */</span></span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">getConvexHull</span> <span class="params">(Point* p, <span class="keyword">int</span> n, Point* ch)</span> </span>&#123;</span><br><span class="line">        sort(p, p + n);</span><br><span class="line">        <span class="keyword">int</span> m = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">            <span class="comment">/* 可共线 */</span></span><br><span class="line">            <span class="comment">//while (m &gt; 1 &amp;&amp; dcmp(getCross(ch[m-1]-ch[m-2], p[i]-ch[m-1])) &lt; 0) m--;</span></span><br><span class="line">            <span class="keyword">while</span> (m &gt; <span class="number">1</span> &amp;&amp; dcmp(getCross(ch[m<span class="number">-1</span>]-ch[m<span class="number">-2</span>], p[i]-ch[m<span class="number">-1</span>])) &lt;= <span class="number">0</span>) m--;</span><br><span class="line">            ch[m++] = p[i];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">int</span> k = m;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = n<span class="number">-2</span>; i &gt;= <span class="number">0</span>; i--) &#123;</span><br><span class="line">            <span class="comment">/* 可共线 */</span></span><br><span class="line">            <span class="comment">//while (m &gt; k &amp;&amp; dcmp(getCross(ch[m-1]-ch[m-2], p[i]-ch[m-2])) &lt; 0) m--;</span></span><br><span class="line">            <span class="keyword">while</span> (m &gt; k &amp;&amp; dcmp(getCross(ch[m<span class="number">-1</span>]-ch[m<span class="number">-2</span>], p[i]-ch[m<span class="number">-2</span>])) &lt;= <span class="number">0</span>) m--;</span><br><span class="line">            ch[m++] = p[i];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (n &gt; <span class="number">1</span>) m--;</span><br><span class="line">        <span class="keyword">return</span> m;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">isPointInPolygon</span> <span class="params">(Point o, Point* p, <span class="keyword">int</span> n)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> wn = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">            <span class="keyword">int</span> j = (i + <span class="number">1</span>) % n;</span><br><span class="line">            <span class="keyword">if</span> (onSegment(o, p[i], p[j]) || o == p[i]) <span class="keyword">return</span> <span class="number">0</span>; <span class="comment">// 边界上</span></span><br><span class="line">            <span class="keyword">int</span> k = dcmp(getCross(p[j] - p[i], o-p[i]));</span><br><span class="line">            <span class="keyword">int</span> d1 = dcmp(p[i].y - o.y);</span><br><span class="line">            <span class="keyword">int</span> d2 = dcmp(p[j].y - o.y);</span><br><span class="line">            <span class="keyword">if</span> (k &gt; <span class="number">0</span> &amp;&amp; d1 &lt;= <span class="number">0</span> &amp;&amp; d2 &gt; <span class="number">0</span>) wn++;</span><br><span class="line">            <span class="keyword">if</span> (k &lt; <span class="number">0</span> &amp;&amp; d2 &lt;= <span class="number">0</span> &amp;&amp; d1 &gt; <span class="number">0</span>) wn--;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> wn ? <span class="number">-1</span> : <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* 旋转卡壳 */</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">rotatingCalipers</span><span class="params">(Point *p, <span class="keyword">int</span> n, <span class="built_in">vector</span>&lt;pii&gt;&amp; sol)</span> </span>&#123;</span><br><span class="line">        sol.clear();</span><br><span class="line">        <span class="keyword">int</span> j = <span class="number">1</span>; p[n] = p[<span class="number">0</span>];</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">            <span class="keyword">while</span> (getCross(p[j+<span class="number">1</span>]-p[i+<span class="number">1</span>], p[i]-p[i+<span class="number">1</span>]) &gt; getCross(p[j]-p[i+<span class="number">1</span>], p[i]-p[i+<span class="number">1</span>]))</span><br><span class="line">                j = (j+<span class="number">1</span>) % n;</span><br><span class="line">            sol.push_back(make_pair(i, j));</span><br><span class="line">            sol.push_back(make_pair(i + <span class="number">1</span>, j + <span class="number">1</span>));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">rotatingCalipersGetRectangle</span> <span class="params">(Point *p, <span class="keyword">int</span> n, <span class="keyword">double</span>&amp; area, <span class="keyword">double</span>&amp; perimeter)</span> </span>&#123;</span><br><span class="line">        p[n] = p[<span class="number">0</span>];</span><br><span class="line">        <span class="keyword">int</span> l = <span class="number">1</span>, r = <span class="number">1</span>, j = <span class="number">1</span>;</span><br><span class="line">        area = perimeter = <span class="number">1e20</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">            Vector v = (p[i+<span class="number">1</span>]-p[i]) / getLength(p[i+<span class="number">1</span>]-p[i]);</span><br><span class="line">            <span class="keyword">while</span> (dcmp(getDot(v, p[r%n]-p[i]) - getDot(v, p[(r+<span class="number">1</span>)%n]-p[i])) &lt; <span class="number">0</span>) r++;</span><br><span class="line">            <span class="keyword">while</span> (j &lt; r || dcmp(getCross(v, p[j%n]-p[i]) - getCross(v,p[(j+<span class="number">1</span>)%n]-p[i])) &lt; <span class="number">0</span>) j++;</span><br><span class="line">            <span class="keyword">while</span> (l &lt; j || dcmp(getDot(v, p[l%n]-p[i]) - getDot(v, p[(l+<span class="number">1</span>)%n]-p[i])) &gt; <span class="number">0</span>) l++;</span><br><span class="line">            <span class="keyword">double</span> w = getDot(v, p[r%n]-p[i])-getDot(v, p[l%n]-p[i]);</span><br><span class="line">            <span class="keyword">double</span> h = getDistanceToLine (p[j%n], p[i], p[i+<span class="number">1</span>]);</span><br><span class="line">            area = min(area, w * h);</span><br><span class="line">            perimeter = min(perimeter, <span class="number">2</span> * w + <span class="number">2</span> * h);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* 计算半平面相交可以用增量法，o(n^2)，初始设置4条无穷大的半平面 */</span></span><br><span class="line">    <span class="comment">/* 用有向直线A-&gt;B切割多边形u，返回左侧。可能退化成单点或线段 */</span></span><br><span class="line">    <span class="function">Polygon <span class="title">cutPolygon</span> <span class="params">(Polygon u, Point a, Point b)</span> </span>&#123;</span><br><span class="line">        Polygon ret;</span><br><span class="line">        <span class="keyword">int</span> n = u.size();</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">            Point c = u[i], d = u[(i+<span class="number">1</span>)%n];</span><br><span class="line">            <span class="keyword">if</span> (dcmp((b-a)^(c-a)) &gt;= <span class="number">0</span>) ret.push_back(c);</span><br><span class="line">            <span class="keyword">if</span> (dcmp((b-a)^(c-d)) != <span class="number">0</span>) &#123;</span><br><span class="line">                Point t;</span><br><span class="line">                getIntersection(a, b-a, c, d-c, t);</span><br><span class="line">                <span class="keyword">if</span> (onSegment(t, c, d))</span><br><span class="line">                    ret.push_back(t);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ret;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* 半平面相交 */</span></span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">halfPlaneIntersection</span><span class="params">(DirLine* li, <span class="keyword">int</span> n, Point* poly)</span> </span>&#123;</span><br><span class="line">        sort(li, li + n);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">int</span> first, last;</span><br><span class="line">        Point* p = <span class="keyword">new</span> Point[n];</span><br><span class="line">        DirLine* q = <span class="keyword">new</span> DirLine[n];</span><br><span class="line">        q[first=last=<span class="number">0</span>] = li[<span class="number">0</span>];</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; n; i++) &#123;</span><br><span class="line">            <span class="keyword">while</span> (first &lt; last &amp;&amp; !onLeft(li[i], p[last<span class="number">-1</span>])) last--;</span><br><span class="line">            <span class="keyword">while</span> (first &lt; last &amp;&amp; !onLeft(li[i], p[first])) first++;</span><br><span class="line">            q[++last] = li[i];</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (dcmp(q[last].v ^ q[last<span class="number">-1</span>].v) == <span class="number">0</span>) &#123;</span><br><span class="line">                last--;</span><br><span class="line">                <span class="keyword">if</span> (onLeft(q[last], li[i].p)) q[last] = li[i];</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (first &lt; last)</span><br><span class="line">                getIntersection(q[last<span class="number">-1</span>].p, q[last<span class="number">-1</span>].v, q[last].p, q[last].v, p[last<span class="number">-1</span>]);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">while</span> (first &lt; last &amp;&amp; !onLeft(q[first], p[last<span class="number">-1</span>])) last--;</span><br><span class="line">        <span class="keyword">if</span> (last - first &lt;= <span class="number">1</span>) &#123; <span class="keyword">delete</span> [] p; <span class="keyword">delete</span> [] q; <span class="keyword">return</span> <span class="number">0</span>; &#125;</span><br><span class="line">        getIntersection(q[last].p, q[last].v, q[first].p, q[first].v, p[last]);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">int</span> m = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = first; i &lt;= last; i++) poly[m++] = p[i];</span><br><span class="line">        <span class="keyword">delete</span> [] p; <span class="keyword">delete</span> [] q;</span><br><span class="line">        <span class="keyword">return</span> m;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* 去除多边形共线点 */</span></span><br><span class="line">    <span class="function">Polygon <span class="title">simplify</span> <span class="params">(<span class="keyword">const</span> Polygon&amp; poly)</span> </span>&#123;</span><br><span class="line">        Polygon ret;</span><br><span class="line">        <span class="keyword">int</span> n = poly.size();</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">            Point a = poly[i];</span><br><span class="line">            Point b = poly[(i+<span class="number">1</span>)%n];</span><br><span class="line">            Point c = poly[(i+<span class="number">2</span>)%n];</span><br><span class="line">            <span class="keyword">if</span> (dcmp((b-a)^(c-b)) != <span class="number">0</span> &amp;&amp; (ret.size() == <span class="number">0</span> || b != ret[ret.size()<span class="number">-1</span>]))</span><br><span class="line">                ret.push_back(b);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ret;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> Circular &#123;</span><br><span class="line">    <span class="keyword">using</span> <span class="keyword">namespace</span> Linear;</span><br><span class="line">    <span class="keyword">using</span> <span class="keyword">namespace</span> Vectorial;</span><br><span class="line">    <span class="keyword">using</span> <span class="keyword">namespace</span> Triangular;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* 直线和圆的交点 */</span></span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">getLineCircleIntersection</span> <span class="params">(Point p, Point q, Circle O, <span class="keyword">double</span>&amp; t1, <span class="keyword">double</span>&amp; t2, <span class="built_in">vector</span>&lt;Point&gt;&amp; sol)</span> </span>&#123;</span><br><span class="line">        Vector v = q - p;</span><br><span class="line">        <span class="comment">/* 使用前需清空sol */</span></span><br><span class="line">        <span class="comment">//sol.clear();</span></span><br><span class="line">        <span class="keyword">double</span> a = v.x, b = p.x - O.o.x, c = v.y, d = p.y - O.o.y;</span><br><span class="line">        <span class="keyword">double</span> e = a*a+c*c, f = <span class="number">2</span>*(a*b+c*d), g = b*b+d*d-O.r*O.r;</span><br><span class="line">        <span class="keyword">double</span> delta = f*f - <span class="number">4</span>*e*g;</span><br><span class="line">        <span class="keyword">if</span> (dcmp(delta) &lt; <span class="number">0</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">if</span> (dcmp(delta) == <span class="number">0</span>) &#123;</span><br><span class="line">            t1 = t2 = -f / (<span class="number">2</span> * e);</span><br><span class="line">            sol.push_back(p + v * t1);</span><br><span class="line">            <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        t1 = (-f - <span class="built_in">sqrt</span>(delta)) / (<span class="number">2</span> * e); sol.push_back(p + v * t1);</span><br><span class="line">        t2 = (-f + <span class="built_in">sqrt</span>(delta)) / (<span class="number">2</span> * e); sol.push_back(p + v * t2);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">2</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* 圆和圆的交点 */</span></span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">getCircleCircleIntersection</span> <span class="params">(Circle o1, Circle o2, <span class="built_in">vector</span>&lt;Point&gt;&amp; sol)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">double</span> d = getLength(o1.o - o2.o);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (dcmp(d) == <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> (dcmp(o1.r - o2.r) == <span class="number">0</span>) <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (dcmp(o1.r + o2.r - d) &lt; <span class="number">0</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">if</span> (dcmp(<span class="built_in">fabs</span>(o1.r-o2.r) - d) &gt; <span class="number">0</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">double</span> a = getAngle(o2.o - o1.o);</span><br><span class="line">        <span class="keyword">double</span> da = <span class="built_in">acos</span>((o1.r*o1.r + d*d - o2.r*o2.r) / (<span class="number">2</span>*o1.r*d));</span><br><span class="line"></span><br><span class="line">        Point p1 = o1.point(a-da), p2 = o1.point(a+da);</span><br><span class="line"></span><br><span class="line">        sol.push_back(p1);</span><br><span class="line">        <span class="keyword">if</span> (p1 == p2) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">        sol.push_back(p2);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">2</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* 过定点作圆的切线 */</span></span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">getTangents</span> <span class="params">(Point p, Circle o, Vector* v)</span> </span>&#123;</span><br><span class="line">        Vector u = o.o - p;</span><br><span class="line">        <span class="keyword">double</span> d = getLength(u);</span><br><span class="line">        <span class="keyword">if</span> (d &lt; o.r) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (dcmp(d - o.r) == <span class="number">0</span>) &#123;</span><br><span class="line">            v[<span class="number">0</span>] = rotate(u, pi / <span class="number">2</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">double</span> ang = <span class="built_in">asin</span>(o.r / d);</span><br><span class="line">            v[<span class="number">0</span>] = rotate(u, -ang);</span><br><span class="line">            v[<span class="number">1</span>] = rotate(u, ang);</span><br><span class="line">            <span class="keyword">return</span> <span class="number">2</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* a[i] 和 b[i] 分别是第i条切线在O1和O2上的切点 */</span></span><br><span class="line">    <span class="comment">/* have some problems */</span></span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">getTangents</span> <span class="params">(Circle o1, Circle o2, Point* a, Point* b)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> cnt = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">if</span> (o1.r &lt; o2.r) &#123; swap(o1, o2); swap(a, b); &#125;</span><br><span class="line">        <span class="keyword">double</span> d2 = getLength(o1.o - o2.o); d2 = d2 * d2;</span><br><span class="line">        <span class="keyword">double</span> rdif = o1.r - o2.r, rsum = o1.r + o2.r;</span><br><span class="line">        <span class="keyword">if</span> (d2 &lt; rdif * rdif) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">if</span> (dcmp(d2) == <span class="number">0</span> &amp;&amp; dcmp(o1.r - o2.r) == <span class="number">0</span>) <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">double</span> base = getAngle(o2.o - o1.o);</span><br><span class="line">        <span class="keyword">if</span> (dcmp(d2 - rdif * rdif) == <span class="number">0</span>) &#123;</span><br><span class="line">            a[cnt] = o1.point(base); b[cnt] = o2.point(base); cnt++;</span><br><span class="line">            <span class="keyword">return</span> cnt;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">double</span> ang = <span class="built_in">acos</span>( rdif / <span class="built_in">sqrt</span>(d2) );</span><br><span class="line">        a[cnt] = o1.point(base+ang); b[cnt] = o2.point(base+ang); cnt++;</span><br><span class="line">        a[cnt] = o1.point(base-ang); b[cnt] = o2.point(base-ang); cnt++;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (dcmp(d2 - rsum * rsum) == <span class="number">0</span>) &#123;</span><br><span class="line">            a[cnt] = o1.point(base); b[cnt] = o2.point(base); cnt++;</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (d2 &gt; rsum * rsum) &#123;</span><br><span class="line">            <span class="keyword">double</span> ang = <span class="built_in">acos</span>( rsum / <span class="built_in">sqrt</span>(d2) );</span><br><span class="line">            a[cnt] = o1.point(base+ang); b[cnt] = o2.point(pi+base+ang); cnt++;</span><br><span class="line">            a[cnt] = o1.point(base-ang); b[cnt] = o2.point(pi+base-ang); cnt++;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> cnt;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* 三点确定外切圆 */</span></span><br><span class="line">    <span class="function">Circle <span class="title">CircumscribedCircle</span><span class="params">(Point p1, Point p2, Point p3)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">double</span> Bx = p2.x - p1.x, By = p2.y - p1.y;</span><br><span class="line">        <span class="keyword">double</span> Cx = p3.x - p1.x, Cy = p3.y - p1.y;</span><br><span class="line">        <span class="keyword">double</span> D = <span class="number">2</span> * (Bx * Cy - By * Cx);</span><br><span class="line">        <span class="keyword">double</span> cx = (Cy * (Bx * Bx + By * By) - By * (Cx * Cx + Cy * Cy)) / D + p1.x;</span><br><span class="line">        <span class="keyword">double</span> cy = (Bx * (Cx * Cx + Cy * Cy) - Cx * (Bx * Bx + By * By)) / D + p1.y;</span><br><span class="line">        Point p = Point(cx, cy);</span><br><span class="line">        <span class="keyword">return</span> Circle(p, getLength(p1 - p));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* 三点确定内切圆 */</span></span><br><span class="line">    <span class="function">Circle <span class="title">InscribedCircle</span><span class="params">(Point p1, Point p2, Point p3)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">double</span> a = getLength(p2 - p3);</span><br><span class="line">        <span class="keyword">double</span> b = getLength(p3 - p1);</span><br><span class="line">        <span class="keyword">double</span> c = getLength(p1 - p2);</span><br><span class="line">        Point p = (p1 * a + p2 * b + p3 * c) / (a + b + c);</span><br><span class="line">        <span class="keyword">return</span> Circle(p, getDistanceToLine(p, p1, p2));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* 三角形一顶点为圆心 */</span></span><br><span class="line">    <span class="function"><span class="keyword">double</span> <span class="title">getPublicAreaToTriangle</span> <span class="params">(Circle O, Point a, Point b)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (dcmp((a-O.o)^(b-O.o)) == <span class="number">0</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">int</span> sig = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">double</span> da = getPLength(O.o-a), db = getPLength(O.o-b);</span><br><span class="line">        <span class="keyword">if</span> (dcmp(da-db) &gt; <span class="number">0</span>) &#123;</span><br><span class="line">            swap(da, db);</span><br><span class="line">            swap(a, b);</span><br><span class="line">            sig = <span class="number">-1</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">double</span> t1, t2;</span><br><span class="line">        <span class="built_in">vector</span>&lt;Point&gt; sol;</span><br><span class="line">        <span class="keyword">int</span> n = getLineCircleIntersection(a, b, O, t1, t2, sol);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (dcmp(da-O.r*O.r) &lt;= <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> (dcmp(db-O.r*O.r) &lt;= <span class="number">0</span>)  <span class="keyword">return</span> getDirArea(O.o, a, b) * sig;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">int</span> k = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">if</span> (getPLength(sol[<span class="number">0</span>]-b) &gt; getPLength(sol[<span class="number">1</span>]-b)) k = <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">double</span> ret = getArea(O.o, a, sol[k]) + O.getArea(getAngle(sol[k]-O.o, b-O.o));</span><br><span class="line">            <span class="keyword">double</span> tmp = (a-O.o)^(b-O.o);</span><br><span class="line">            <span class="keyword">return</span> ret * sig * dcmp(tmp);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">double</span> d = getDistanceToSegment(O.o, a, b);</span><br><span class="line">        <span class="keyword">if</span> (dcmp(d-O.r) &gt;= <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">double</span> ret = O.getArea(getAngle(a-O.o, b-O.o));</span><br><span class="line">            <span class="keyword">double</span> tmp = (a-O.o)^(b-O.o);</span><br><span class="line">            <span class="keyword">return</span> ret * sig * dcmp(tmp);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="keyword">double</span> k1 = O.r / getLength(a - O.o), k2 = O.r / getLength(b - O.o);</span><br><span class="line">        Point p = O.o + (a - O.o) * k1, q = O.o + (b - O.o) * k2;</span><br><span class="line">        <span class="keyword">double</span> ret1 = O.getArea(getAngle(p-O.o, q-O.o));</span><br><span class="line">        <span class="keyword">double</span> ret2 = O.getArea(getAngle(sol[<span class="number">0</span>]-O.o, sol[<span class="number">1</span>]-O.o)) - getArea(O.o, sol[<span class="number">0</span>], sol[<span class="number">1</span>]);</span><br><span class="line">        <span class="keyword">double</span> ret = (ret1 - ret2), tmp = (a-O.o)^(b-O.o);</span><br><span class="line">        <span class="keyword">return</span> ret * sig * dcmp(tmp);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">double</span> <span class="title">getPublicAreaToPolygon</span> <span class="params">(Circle O, Point* p, <span class="keyword">int</span> n)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (dcmp(O.r) == <span class="number">0</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">double</span> area = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">            <span class="keyword">int</span> u = (i + <span class="number">1</span>) % n;</span><br><span class="line">            area += getPublicAreaToTriangle(O, p[i], p[u]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">fabs</span>(area);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> Polygonal;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">105</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> N, M;</span><br><span class="line"><span class="keyword">double</span> X[maxn], Y[maxn], PX[maxn], PY[maxn];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">double</span> x, y;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;N, &amp;M);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i++) &#123;</span><br><span class="line">        X[i] = Y[i] = PX[i] = PY[i] = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= M; j++) &#123;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">"%lf%lf"</span>, &amp;x, &amp;y);</span><br><span class="line">            X[i] += x, Y[i] += y;</span><br><span class="line">            PX[i] += x*x, PY[i] += y*y;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<hr>
<h3 id="二进制"><a href="#二进制" class="headerlink" title="二进制"></a>二进制</h3><h4 id="状态压缩"><a href="#状态压缩" class="headerlink" title="状态压缩"></a>状态压缩</h4><table>
<thead>
<tr>
<th>最低位是第0位</th>
<th>操作</th>
</tr>
</thead>
<tbody><tr>
<td>取第k位（非0则为1）</td>
<td>(n &gt;&gt; k) &amp; 1</td>
</tr>
<tr>
<td>取后k位（同上，0~k-1位）</td>
<td>n &amp; ((1 &lt;&lt; k) – 1)</td>
</tr>
<tr>
<td>第k位取反</td>
<td>n ^= (1 &lt;&lt; k)</td>
</tr>
<tr>
<td>第k位变为1</td>
<td>n |= (1 &lt;&lt; k)</td>
</tr>
<tr>
<td>第k位变为0</td>
<td>n &amp;= (~(1 &lt;&lt; k))</td>
</tr>
</tbody></table>
<hr>
<h4 id="lowbit函数"><a href="#lowbit函数" class="headerlink" title="lowbit函数"></a>lowbit函数</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//lowbit(x)是x的二进制表达式中最低位的1所对应的值</span></span><br><span class="line"><span class="comment">//6的二进制是110，所以lowbit(6)的二进制为10，即lowbit(6)=2</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">lowbit</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123; <span class="keyword">return</span> x &amp; (-x); &#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">lowbit</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123; <span class="keyword">return</span> x &amp; (x ^ (x - <span class="number">1</span>)); &#125;</span><br></pre></td></tr></table></figure>

<hr>
<h3 id="动态规划-DP"><a href="#动态规划-DP" class="headerlink" title="动态规划 DP"></a>动态规划 DP</h3><blockquote>
<p>01背包</p>
</blockquote>
<p>$$<br>F[i,v]=max{F[i−1,v],\ F[i−1,v−C_i]+W_i}<br>$$</p>
<p>从二维降到一维时应逆序进行</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//二维</span></span><br><span class="line"><span class="keyword">for</span> i= <span class="number">1</span> to N</span><br><span class="line">    <span class="keyword">for</span> v=Ci to V </span><br><span class="line">        F[i,v]=max&#123;F[i−<span class="number">1</span>,v],F[i−<span class="number">1</span>,v−Ci]+Wi&#125;</span><br><span class="line"><span class="comment">//一维</span></span><br><span class="line"><span class="keyword">for</span> i=<span class="number">1</span> to N</span><br><span class="line">    <span class="keyword">for</span> j= V to Ci</span><br><span class="line">        F[j]=max&#123;F[j],F[j−Ci]+Wi&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>完全背包</p>
</blockquote>
<p>01背包的一维顺序版本</p>
<blockquote>
<p>多重背包</p>
</blockquote>
<p>二进制优化：按照2的幂进行拆分转化为01背包</p>
<blockquote>
<p>二维背包</p>
</blockquote>
<p>限制条件加一维</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> k=<span class="number">1</span> to K</span><br><span class="line">    <span class="keyword">for</span> v = V to <span class="number">0</span> </span><br><span class="line">        <span class="keyword">for</span> item i in group k</span><br><span class="line">            f[v]=max&#123;F[v],F[v−Ci]+Wi&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>依赖背包</p>
</blockquote>
<p>选主件，对附件跑01背包，最后对主件跑01背包</p>
<blockquote>
<p>区间dp</p>
</blockquote>
<p>石子归并</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">F[i][j]=min&#123;F[i][k]+F[k+<span class="number">1</span>][j]&#125;+Sum[i][j]</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;n;i++)<span class="comment">//枚举区间长度</span></span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">1</span>;j+i&lt;=n;j++)<span class="comment">//枚举区间左端点</span></span><br><span class="line">                <span class="keyword">for</span>(<span class="keyword">int</span> k=j;k&lt;j+i;k++)<span class="comment">//枚举中间值k</span></span><br><span class="line">                    DP[j][j+i]=max(DP[j][k]+DP[k+<span class="number">1</span>][j+i]+Sum[i][j])</span><br></pre></td></tr></table></figure>

<blockquote>
<p>四边形优化</p>
</blockquote>
<p>枚举中间值时枚举一个新数组，更新时更新该数组为新的中间值</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (<span class="keyword">long</span> <span class="keyword">long</span> i=<span class="number">1</span>; i&lt;n; i++)</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">long</span> <span class="keyword">long</span> j=<span class="number">2</span>*n-i; j&gt;<span class="number">0</span>; j--)</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">long</span> <span class="keyword">long</span> k=s[j][j+i<span class="number">-1</span>]; k&lt;=s[j+<span class="number">1</span>][j+i]; k++)</span><br><span class="line">            <span class="keyword">if</span> (dp[j][k]+dp[k+<span class="number">1</span>][j+i]+sum[j+i]-sum[j<span class="number">-1</span>] &lt;= dp[j][j+i])</span><br><span class="line">            &#123;</span><br><span class="line">                dp[j][j+i]=dp[j][k]+dp[k+<span class="number">1</span>][j+i]+sum[j+i]-sum[j<span class="number">-1</span>];</span><br><span class="line">                s[j][j+i]=k;</span><br><span class="line">            &#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>状压dp</p>
</blockquote>
<p>把储存原始状态时应该用逆状态存放，判断时可以直接用&amp;</p>
<hr>
<h3 id="二分"><a href="#二分" class="headerlink" title="二分"></a>二分</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//求在满足条件下最大或最小的值的题目，满足单调性和有序性</span></span><br><span class="line"><span class="comment">//整数while(l&lt;r)，小数一般for500次,具体次数具体分析</span></span><br><span class="line"><span class="comment">//时间复杂度 O(logn)，最后得到的是可行域的闭区间[l,r]</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> (r&gt;l)</span><br><span class="line">&#123;</span><br><span class="line">    mid=(l+r+<span class="number">1</span>)/<span class="number">2</span>;                       <span class="comment">//注意是l+r+1</span></span><br><span class="line">    <span class="keyword">if</span>(check(mid)==<span class="literal">true</span>) l=mid;</span><br><span class="line">    <span class="keyword">else</span> r=mid<span class="number">-1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<hr>
<h3 id="三分"><a href="#三分" class="headerlink" title="三分"></a>三分</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 用于单峰函数求极值</span></span><br><span class="line"><span class="comment">// 整数用while(l&lt;=r)，浮点数用for</span></span><br><span class="line"><span class="comment">// 每次选择区间内的两个点，算完一次后去掉距离标准答案的值更远的那个点到原区间的端点的区间</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">f</span><span class="params">(<span class="keyword">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// 求值</span></span><br><span class="line">    <span class="keyword">int</span> ans;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 适用于上凸型函数</span></span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">    <span class="comment">// 下凸型函数可以用INF减去f(x)</span></span><br><span class="line">    <span class="comment">// return INF - ans;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">threeDivideInt</span><span class="params">(<span class="keyword">int</span> L, <span class="keyword">int</span> R)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">while</span> (L &lt; R - <span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">auto</span> mid = (L + R) / <span class="number">2</span>;</span><br><span class="line">        <span class="keyword">auto</span> mmid = (mid + R) / <span class="number">2</span>;</span><br><span class="line">        <span class="keyword">if</span> (f(mid) &gt; f(mmid)) R = mmid;</span><br><span class="line">        <span class="keyword">else</span> L = mid;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 返回x</span></span><br><span class="line">    <span class="keyword">return</span> f(L) &gt; f(R) ? L : R;</span><br><span class="line">    <span class="comment">// 上凸型返回f(x)</span></span><br><span class="line">    <span class="comment">// return f(f(L) &gt; f(R) ? L : R);</span></span><br><span class="line">    <span class="comment">// 下凸型返回f(x)</span></span><br><span class="line">    <span class="comment">// return INF - f(f(L) &gt; f(R) ? L : R);</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">threeDivideDouble</span><span class="params">(<span class="keyword">double</span> low, <span class="keyword">double</span> up)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">double</span> m1, m2;</span><br><span class="line">    <span class="keyword">while</span> (up - low &gt;= eps)</span><br><span class="line">    &#123;</span><br><span class="line">        m1 = low + (up - low) / <span class="number">3</span>;</span><br><span class="line">        m2 = up - (up - low) / <span class="number">3</span>;</span><br><span class="line">        <span class="keyword">if</span> (f(m1) &lt;= f(m2)) low = m1;</span><br><span class="line">        <span class="keyword">else</span> up = m2;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> (m1 + m2) / <span class="number">2</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<hr>
<h3 id="数据结构"><a href="#数据结构" class="headerlink" title="数据结构"></a>数据结构</h3><h4 id="并查集"><a href="#并查集" class="headerlink" title="并查集"></a>并查集</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 均摊O(1)的查找、合并</span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">100000</span> + <span class="number">50</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 1下标</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">union_set</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="keyword">int</span> par[MAXN];</span><br><span class="line"></span><br><span class="line">    <span class="comment">//递归查询，可能会爆栈</span></span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">find_res</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123; <span class="keyword">return</span> x == par[x] ? x : par[x] = find_res(par[x]); &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//非递归查询</span></span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">find</span><span class="params">(<span class="keyword">int</span> x)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">auto</span> root = x;</span><br><span class="line">        <span class="keyword">while</span> (root != par[root]) root = par[root];</span><br><span class="line">        <span class="keyword">while</span> (x != root)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">const</span> <span class="keyword">auto</span> temp = par[x];</span><br><span class="line">            par[x] = root;</span><br><span class="line">            x = temp;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> root;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    union_set() &#123; <span class="keyword">for</span> (<span class="keyword">auto</span> i = <span class="number">1</span>; i &lt; MAXN; i++) par[i] = i; &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//连接，par[a]=b，a的祖先指向b的祖先，b的祖先为共同的root</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">link</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> </span>&#123; par[find(x)] = find(y); &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">connected</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> </span>&#123; <span class="keyword">return</span> find(x) == find(y); &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 0下标</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">union_set</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; par;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">find_res</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123; <span class="keyword">return</span> x == par[x] ? x : par[x] = find_res(par[x]); &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">find</span><span class="params">(<span class="keyword">int</span> x)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">auto</span> root = x;</span><br><span class="line">        <span class="keyword">while</span> (root != par[root]) root = par[root];</span><br><span class="line">        <span class="keyword">while</span> (x != root)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">const</span> <span class="keyword">auto</span> temp = par[x];</span><br><span class="line">            par[x] = root;</span><br><span class="line">            x = temp;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> root;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    union_set(<span class="keyword">const</span> <span class="keyword">int</span> size) : par(size)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">auto</span> i = <span class="number">0</span>; i &lt; size; i++) par[i] = i;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">link</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> </span>&#123; par[find(x)] = find(y); &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">connected</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> </span>&#123; <span class="keyword">return</span> find(x) == find(y); &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<hr>
<h4 id="单调栈"><a href="#单调栈" class="headerlink" title="单调栈"></a>单调栈</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//用途：O(n)，找到从左/右遍历第一个比它小/大的元素的位置</span></span><br><span class="line"><span class="comment">//一个元素向左遍历的第一个比它小的数的位置就是将它插入单调栈时栈顶元素的值，若栈为空，则说明不存在这么一个数。然后将此元素的下标存入栈，就能类似迭代般地求解后面的元素</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//对于a[i],l[i]表示 第i个数向左遍历的第一个比它小的元素的位置，0表示无</span></span><br><span class="line"><span class="keyword">int</span> a[<span class="number">10</span>], l[<span class="number">10</span>], n;</span><br><span class="line"><span class="built_in">stack</span> &lt;<span class="keyword">int</span>&gt; S;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">while</span> (S.size() &amp;&amp; a[S.top()] &gt;= a[i]) S.pop();</span><br><span class="line">    <span class="keyword">if</span> (S.empty()) l[i] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">else</span> l[i] = S.top();</span><br><span class="line">    S.push(i);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<hr>
<h4 id="区间最值查询-RMQ"><a href="#区间最值查询-RMQ" class="headerlink" title="区间最值查询 RMQ"></a>区间最值查询 RMQ</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//用于离线区间查询最大值和最小值</span></span><br><span class="line"><span class="comment">//ST表实现</span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">static</span> <span class="keyword">int</span> MAXN = <span class="number">50000</span> + <span class="number">100</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">static</span> <span class="keyword">int</span> LOGMAXN = (<span class="keyword">int</span>)(log2(MAXN)) + <span class="number">5</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> n;</span><br><span class="line"><span class="keyword">int</span> d[MAXN] = &#123; <span class="number">0</span> &#125;;</span><br><span class="line"><span class="keyword">int</span> dlog[MAXN] = &#123; <span class="number">0</span> &#125;; <span class="comment">//log表</span></span><br><span class="line"><span class="keyword">int</span> dmax[MAXN][LOGMAXN] = &#123; <span class="number">0</span> &#125;;</span><br><span class="line"><span class="keyword">int</span> dmin[MAXN][LOGMAXN] = &#123; <span class="number">0</span> &#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">//预处理，O(nlogn)</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        dmin[i][<span class="number">0</span>] = d[i];</span><br><span class="line">        dmax[i][<span class="number">0</span>] = d[i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; (<span class="number">1</span> &lt;&lt; j) &lt;= n; j++)</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i + (<span class="number">1</span> &lt;&lt; j) - <span class="number">1</span> &lt;= n; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            dmin[i][j] = min(dmin[i][j - <span class="number">1</span>], dmin[i + (<span class="number">1</span> &lt;&lt; (j - <span class="number">1</span>))][j - <span class="number">1</span>]);</span><br><span class="line">            dmax[i][j] = max(dmax[i][j - <span class="number">1</span>], dmax[i + (<span class="number">1</span> &lt;&lt; (j - <span class="number">1</span>))][j - <span class="number">1</span>]);</span><br><span class="line">        &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= MAXN - <span class="number">100</span>; i++) dlog[i] = dlog[i &gt;&gt; <span class="number">1</span>] + <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 数组0下标！！！</span></span><br><span class="line"><span class="comment">// 注意题目是否是0下标，否则查询的时候应减一后传入函数</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">static</span> <span class="keyword">int</span> MAXN = <span class="number">50000</span> + <span class="number">100</span>;</span><br><span class="line"><span class="keyword">int</span> nums[MAXN] = &#123; <span class="number">0</span> &#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">TStTable</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">static</span> <span class="keyword">int</span> LOGMAXN = (<span class="keyword">int</span>)(log2(MAXN)) + <span class="number">5</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">int</span> stmin[MAXN][LOGMAXN] = &#123; <span class="number">0</span> &#125;;</span><br><span class="line">    <span class="keyword">int</span> stmax[MAXN][LOGMAXN] = &#123; <span class="number">0</span> &#125;;</span><br><span class="line">    <span class="keyword">int</span> XLog[LOGMAXN] = &#123; <span class="number">0</span> &#125;; <span class="comment">//log表</span></span><br><span class="line"></span><br><span class="line">    TStTable()</span><br><span class="line">    &#123;</span><br><span class="line">        XLog[<span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt; LOGMAXN; i++) XLog[i] = XLog[i &gt;&gt; <span class="number">1</span>] + <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//预处理，O(nlogn)，传入数组和数字数量</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">InitSt</span><span class="params">(<span class="keyword">int</span> *nums, <span class="keyword">int</span> n)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            stmin[i][<span class="number">0</span>] = nums[i];</span><br><span class="line">            stmax[i][<span class="number">0</span>] = nums[i];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; (<span class="number">1</span> &lt;&lt; j) &lt;= n; j++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i + (<span class="number">1</span> &lt;&lt; j) - <span class="number">1</span> &lt; n; i++)</span><br><span class="line">            &#123;</span><br><span class="line">                stmin[i][j] = min(stmin[i][j - <span class="number">1</span>], stmin[i + (<span class="number">1</span> &lt;&lt; (j - <span class="number">1</span>))][j - <span class="number">1</span>]);</span><br><span class="line">                stmax[i][j] = max(stmax[i][j - <span class="number">1</span>], stmax[i + (<span class="number">1</span> &lt;&lt; (j - <span class="number">1</span>))][j - <span class="number">1</span>]);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//查询最大值，O(1)，常数较小</span></span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">getmax</span><span class="params">(<span class="keyword">int</span> L, <span class="keyword">int</span> R)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> x = XLog[R - L + <span class="number">1</span>];</span><br><span class="line">        <span class="keyword">return</span> max(stmax[L][x], stmax[R - (<span class="number">1</span> &lt;&lt; x) + <span class="number">1</span>][x]);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//查询最小值，O(1)，常数较小</span></span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">getmin</span><span class="params">(<span class="keyword">int</span> L, <span class="keyword">int</span> R)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> x = XLog[R - L + <span class="number">1</span>];</span><br><span class="line">        <span class="keyword">return</span> min(stmin[L][x], stmin[R - (<span class="number">1</span> &lt;&lt; x) + <span class="number">1</span>][x]);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//查询最大最小值之差，O(1)，常数较小</span></span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">getdelta</span><span class="params">(<span class="keyword">int</span> L, <span class="keyword">int</span> R)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> x = XLog[R - L + <span class="number">1</span>];</span><br><span class="line">        <span class="keyword">return</span> max(stmax[L][x], stmax[R - (<span class="number">1</span> &lt;&lt; x) + <span class="number">1</span>][x]) - min(stmin[L][x], stmin[R - (<span class="number">1</span> &lt;&lt; x) + <span class="number">1</span>][x]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125; stTable;</span><br></pre></td></tr></table></figure>

<hr>
<h3 id="字符串"><a href="#字符串" class="headerlink" title="字符串"></a>字符串</h3><h4 id="最长回文串"><a href="#最长回文串" class="headerlink" title="最长回文串"></a>最长回文串</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Manacher算法</span></span><br><span class="line"><span class="comment">//可进行回文串及信息输出</span></span><br><span class="line"><span class="comment">//返回值为长度</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">Manacher</span><span class="params">(<span class="built_in">string</span> &amp;s)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">string</span> s1 = <span class="string">"$#"</span>;</span><br><span class="line">    <span class="keyword">int</span> len0 = s.size();</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len0; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        s1 += s[i];</span><br><span class="line">        s1 += <span class="string">"#"</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">int</span> mx = <span class="number">0</span>;                <span class="comment">//最大右边界</span></span><br><span class="line">    <span class="keyword">int</span> pos;                <span class="comment">//最大回文串的对称轴</span></span><br><span class="line">    <span class="keyword">int</span> len = s1.size();</span><br><span class="line">    <span class="function"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; <span class="title">p</span><span class="params">(len)</span></span>;        <span class="comment">//回文最长半径数组 p[i]=k 代表在位置i的回文串的最长半径为k</span></span><br><span class="line">    <span class="keyword">int</span> res = <span class="number">-1</span>;            <span class="comment">//最大长度</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; len; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (mx &gt; i) p[i] = min(p[<span class="number">2</span> * pos - i], mx - i); <span class="comment">//i在mx左边</span></span><br><span class="line">        <span class="keyword">else</span> p[i] = <span class="number">1</span>;                                    <span class="comment">//i在mx右边，必须一个个匹配</span></span><br><span class="line">        <span class="keyword">while</span> (s1[i - p[i]] == s1[i + p[i]]) p[i]++;</span><br><span class="line">        <span class="keyword">if</span> (i + p[i] &gt; mx)                                <span class="comment">//更新maxright 最大回文串对称轴位置</span></span><br><span class="line">        &#123;</span><br><span class="line">            pos = i;</span><br><span class="line">            mx = pos + p[i];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (p[i] - <span class="number">1</span> &gt; res) res = p[i] - <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//字符串输出</span></span><br><span class="line">    <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; ans;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="string">"len = "</span> &lt;&lt; res &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; len; i++)</span><br><span class="line">        <span class="keyword">if</span> (p[i] - <span class="number">1</span> == res) ans.push_back((i / <span class="number">2</span>) - ((res + <span class="number">1</span>) / <span class="number">2</span>));</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="string">"num = "</span> &lt;&lt; ans.size() &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">auto</span> it : ans)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; <span class="string">"first char on: "</span> &lt;&lt; it &lt;&lt; <span class="string">" string-&gt;"</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = it; j &lt; it + res; j++) <span class="built_in">cout</span> &lt;&lt; s[j];</span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<hr>
<h4 id="Hash处理"><a href="#Hash处理" class="headerlink" title="Hash处理"></a>Hash处理</h4><h5 id="全字符集"><a href="#全字符集" class="headerlink" title="全字符集"></a>全字符集</h5><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//ASCII全字符集，通用版，不一定完全适用</span></span><br><span class="line"><span class="comment">//BASE1和BASE2应当设置为出现的字符种类数加1及以上</span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">long</span> <span class="keyword">long</span> MAXN = <span class="number">100010</span>; <span class="comment">//字符串长度</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">long</span> <span class="keyword">long</span> BASE1 = <span class="number">257</span>; <span class="comment">//进制</span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">long</span> <span class="keyword">long</span> MOD1 = <span class="number">32031528556843483</span>;</span><br><span class="line"><span class="comment">//MOD数，用这个数的话单hash能过，双hash可以考虑改小这个数</span></span><br><span class="line"><span class="comment">//MOD数要么小于MAX_INT,要么在计算过程用快速乘</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">long</span> <span class="keyword">long</span> p1[MAXN] = &#123; <span class="number">0</span> &#125;;</span><br><span class="line"><span class="keyword">long</span> <span class="keyword">long</span> Hash_1[MAXN] = &#123; <span class="number">0</span> &#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Hash_1_cal</span><span class="params">(<span class="built_in">string</span> s)</span> <span class="comment">//求s的整个字符串的hash</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    p1[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= MAXN - <span class="number">10</span>; i++) p1[i] = (p1[i - <span class="number">1</span>] * BASE1) % MOD1;</span><br><span class="line">    Hash_1[<span class="number">0</span>] = (<span class="keyword">long</span> <span class="keyword">long</span>)s[<span class="number">0</span>] % MOD1;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; s.length(); i++)</span><br><span class="line">        Hash_1[i] = (Hash_1[i - <span class="number">1</span>] * BASE1 + (<span class="keyword">long</span> <span class="keyword">long</span>)s[i]) % MOD1;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">long</span> <span class="keyword">long</span> <span class="title">get_H1</span><span class="params">(<span class="keyword">int</span> l, <span class="keyword">int</span> r)</span> <span class="comment">//求从子串[l,r]的哈希值</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> (Hash_1[r] - (l == <span class="number">0</span> ? <span class="number">0</span> : Hash_1[l - <span class="number">1</span>]) * p1[r - l + <span class="number">1</span>] % MOD1 + MOD1) % MOD1;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//双hash</span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">long</span> <span class="keyword">long</span> BASE2 = <span class="number">233</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">long</span> <span class="keyword">long</span> MOD2 = <span class="number">19260817</span>;</span><br><span class="line"><span class="comment">//MOD数要么小于MAX_INT,要么在计算过程用快速乘</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">long</span> <span class="keyword">long</span> p2[MAXN] = &#123; <span class="number">0</span> &#125;;</span><br><span class="line"><span class="keyword">long</span> <span class="keyword">long</span> Hash_2[MAXN] = &#123; <span class="number">0</span> &#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Hash_2_cal</span><span class="params">(<span class="built_in">string</span> s)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    p2[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= MAXN - <span class="number">10</span>; i++) p2[i] = (p2[i - <span class="number">1</span>] * BASE2) % MOD2;</span><br><span class="line">    Hash_2[<span class="number">0</span>] = (<span class="keyword">long</span> <span class="keyword">long</span>)s[<span class="number">0</span>] % MOD2;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; s.length(); i++)</span><br><span class="line">        Hash_2[i] = (Hash_2[i - <span class="number">1</span>] * BASE2 + (<span class="keyword">long</span> <span class="keyword">long</span>)s[i]) % MOD2;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">long</span> <span class="keyword">long</span> <span class="title">get_H2</span><span class="params">(<span class="keyword">int</span> l, <span class="keyword">int</span> r)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> (Hash_2[r] - (l == <span class="number">0</span> ? <span class="number">0</span> : Hash_2[l - <span class="number">1</span>]) * p2[r - l + <span class="number">1</span>] % MOD2 + MOD2) % MOD2;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<hr>
<h5 id="小写字母集"><a href="#小写字母集" class="headerlink" title="小写字母集"></a>小写字母集</h5><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="keyword">long</span> <span class="keyword">long</span> MAXN = <span class="number">1700</span>; <span class="comment">//字符串长度</span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">long</span> <span class="keyword">long</span> BASE1 = <span class="number">29</span>; <span class="comment">//进制</span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">long</span> <span class="keyword">long</span> MOD1 = <span class="number">1e9</span> + <span class="number">9</span>; <span class="comment">//MOD数</span></span><br><span class="line"><span class="keyword">long</span> <span class="keyword">long</span> p1[MAXN] = &#123; <span class="number">0</span> &#125;;</span><br><span class="line"><span class="keyword">long</span> <span class="keyword">long</span> Hash_1[MAXN] = &#123; <span class="number">0</span> &#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Hash_1_cal</span><span class="params">(<span class="built_in">string</span> s)</span> <span class="comment">//求s的整个字符串的hash</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    p1[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= MAXN - <span class="number">10</span>; i++) p1[i] = (p1[i - <span class="number">1</span>] * BASE1) % MOD1;</span><br><span class="line">    Hash_1[<span class="number">0</span>] = (<span class="keyword">long</span> <span class="keyword">long</span>)(s[<span class="number">0</span>] - <span class="string">'a'</span> + <span class="number">1</span>) % MOD1;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; s.length(); i++)</span><br><span class="line">        Hash_1[i] = (Hash_1[i - <span class="number">1</span>] * BASE1 + (<span class="keyword">long</span> <span class="keyword">long</span>)(s[i] - <span class="string">'a'</span> + <span class="number">1</span>)) % MOD1;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">long</span> <span class="keyword">long</span> <span class="title">get_H1</span><span class="params">(<span class="keyword">int</span> l, <span class="keyword">int</span> r)</span> <span class="comment">//求从子串[l,r]的哈希值</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> (Hash_1[r] - (l == <span class="number">0</span> ? <span class="number">0</span> : Hash_1[l - <span class="number">1</span>]) * p1[r - l + <span class="number">1</span>] % MOD1 + MOD1) % MOD1;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//双hash</span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">long</span> <span class="keyword">long</span> BASE2 = <span class="number">31</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">long</span> <span class="keyword">long</span> MOD2 = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"><span class="keyword">long</span> <span class="keyword">long</span> p2[MAXN] = &#123; <span class="number">0</span> &#125;;</span><br><span class="line"><span class="keyword">long</span> <span class="keyword">long</span> Hash_2[MAXN] = &#123; <span class="number">0</span> &#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Hash_2_cal</span><span class="params">(<span class="built_in">string</span> s)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    p2[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= MAXN - <span class="number">10</span>; i++) p2[i] = (p2[i - <span class="number">1</span>] * BASE2) % MOD2;</span><br><span class="line">    Hash_2[<span class="number">0</span>] = (<span class="keyword">long</span> <span class="keyword">long</span>)(s[<span class="number">0</span>] - <span class="string">'a'</span> + <span class="number">1</span>) % MOD2;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; s.length(); i++)</span><br><span class="line">        Hash_2[i] = (Hash_2[i - <span class="number">1</span>] * BASE2 + (<span class="keyword">long</span> <span class="keyword">long</span>)(s[i] - <span class="string">'a'</span> + <span class="number">1</span>)) % MOD2;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">long</span> <span class="keyword">long</span> <span class="title">get_H2</span><span class="params">(<span class="keyword">int</span> l, <span class="keyword">int</span> r)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> (Hash_2[r] - (l == <span class="number">0</span> ? <span class="number">0</span> : Hash_2[l - <span class="number">1</span>]) * p2[r - l + <span class="number">1</span>] % MOD2 + MOD2) % MOD2;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<hr>
<h4 id="字符串匹配"><a href="#字符串匹配" class="headerlink" title="字符串匹配"></a>字符串匹配</h4><h5 id="KMP"><a href="#KMP" class="headerlink" title="KMP"></a>KMP</h5><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">1000</span>;</span><br><span class="line"><span class="built_in">string</span> s, a; <span class="comment">//在s中找a</span></span><br><span class="line"><span class="keyword">int</span> ans[MAXN] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> f[MAXN], slen, alen;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">getFail</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> i = <span class="number">0</span>, j = <span class="number">-1</span>;</span><br><span class="line">    f[<span class="number">0</span>] = <span class="number">-1</span>;</span><br><span class="line">    <span class="keyword">while</span> (i &lt; alen)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (j == <span class="number">-1</span> || a[i] == a[j])</span><br><span class="line">        &#123;</span><br><span class="line">            i++;</span><br><span class="line">            j++;</span><br><span class="line">            f[i] = j;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> j = f[j];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">KMP</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">memset</span>(f,<span class="number">0</span>,<span class="keyword">sizeof</span>(f));</span><br><span class="line">    <span class="built_in">memset</span>(ans,<span class="number">0</span>,<span class="keyword">sizeof</span>(ans));</span><br><span class="line">    <span class="keyword">int</span> i = <span class="number">0</span>, j = <span class="number">0</span>, temp = <span class="number">1</span>;</span><br><span class="line">    slen = s.length();</span><br><span class="line">    alen = a.length();</span><br><span class="line">    getFail();</span><br><span class="line">    <span class="keyword">while</span> (i &lt; slen)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (j == <span class="number">-1</span> || s[i] == a[j])</span><br><span class="line">        &#123;</span><br><span class="line">            i++;</span><br><span class="line">            j++;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> j = f[j];</span><br><span class="line">        <span class="keyword">if</span> (j == alen)</span><br><span class="line">        &#123;</span><br><span class="line">            ans[temp] = i - alen;</span><br><span class="line">            temp++;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> temp - <span class="number">1</span>; <span class="comment">//成功个数</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; s &gt;&gt; a;</span><br><span class="line">    <span class="keyword">int</span> ansnum = KMP();</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<hr>
<h5 id="扩展KMP"><a href="#扩展KMP" class="headerlink" title="扩展KMP"></a>扩展KMP</h5><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">* 扩展KMP</span></span><br><span class="line"><span class="comment">* next[i]:x[i...m-1]的最长公共前缀</span></span><br><span class="line"><span class="comment">* extend[i]:y[i...n-1]与x[0...m-1]的最长公共前缀</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">preEKMP</span><span class="params">(<span class="keyword">char</span> x[], <span class="keyword">int</span> m, <span class="keyword">int</span> next[])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    next[<span class="number">0</span>] = m;</span><br><span class="line">    <span class="keyword">int</span> j = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (j + <span class="number">1</span> &lt; m &amp;&amp; x[j] == x[j + <span class="number">1</span>]) j++;</span><br><span class="line">    next[<span class="number">1</span>] = j;</span><br><span class="line">    <span class="keyword">int</span> k = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt; m; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">int</span> p = next[k] + k - <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">int</span> L = next[i - k];</span><br><span class="line">        <span class="keyword">if</span> (i + L &lt; p + <span class="number">1</span>) next[i] = L;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            j = <span class="built_in">std</span>::max(<span class="number">0</span>, p - i + <span class="number">1</span>);</span><br><span class="line">            <span class="keyword">while</span> (i + j &lt; m &amp;&amp; x[i + j] == x[j]) j++;</span><br><span class="line">            next[i] = j;</span><br><span class="line">            k = i;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">EKMP</span><span class="params">(<span class="keyword">char</span> x[], <span class="keyword">int</span> m, <span class="keyword">char</span> y[], <span class="keyword">int</span> n, <span class="keyword">int</span> next[], <span class="keyword">int</span> extend[])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    preEKMP(x, m, next);</span><br><span class="line">    <span class="keyword">int</span> j = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (j &lt; n &amp;&amp; j &lt; m &amp;&amp; x[j] == y[j]) j++;</span><br><span class="line">    extend[<span class="number">0</span>] = j;</span><br><span class="line">    <span class="keyword">int</span> k = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; n; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">int</span> p = extend[k] + k - <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">int</span> L = next[i - k];</span><br><span class="line">        <span class="keyword">if</span> (i + L &lt; p + <span class="number">1</span>) extend[i] = L;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            j = <span class="built_in">std</span>::max(<span class="number">0</span>, p - i + <span class="number">1</span>);</span><br><span class="line">            <span class="keyword">while</span> (i + j &lt; n &amp;&amp; j &lt; m &amp;&amp; y[i + j] == x[j]) j++;</span><br><span class="line">            extend[i] = j;</span><br><span class="line">            k = i;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<hr>
<h5 id="AC自动机"><a href="#AC自动机" class="headerlink" title="AC自动机"></a>AC自动机</h5><h6 id="快速版"><a href="#快速版" class="headerlink" title="快速版"></a>快速版</h6><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//适用于小写字母</span></span><br><span class="line"><span class="comment">//统计单词出现次数或者个数</span></span><br><span class="line"><span class="comment">//较快</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Aho_Corasick_Automaton</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="meta">#<span class="meta-keyword">define</span> N 500010 <span class="comment">//单词的长度*单词个数</span></span></span><br><span class="line">    <span class="built_in">queue</span>&lt;<span class="keyword">int</span>&gt; q;</span><br><span class="line">    <span class="keyword">int</span> c[N][<span class="number">26</span>],val[N],fail[N],cnt=<span class="number">0</span>;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="built_in">memset</span>(c,<span class="number">0</span>,<span class="keyword">sizeof</span>(c));</span><br><span class="line">        <span class="built_in">memset</span>(val,<span class="number">0</span>,<span class="keyword">sizeof</span>(val));</span><br><span class="line">        <span class="built_in">memset</span>(fail,<span class="number">0</span>,<span class="keyword">sizeof</span>(fail));</span><br><span class="line">        cnt=<span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">ins</span><span class="params">(<span class="keyword">char</span> *s)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> len=<span class="built_in">strlen</span>(s);</span><br><span class="line">        <span class="keyword">int</span> now=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;len; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">int</span> v=s[i]-<span class="string">'a'</span>; </span><br><span class="line">            <span class="keyword">if</span> (!c[now][v])c[now][v]=++cnt;</span><br><span class="line">            now=c[now][v];</span><br><span class="line">        &#125;</span><br><span class="line">        val[now]++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">build</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;<span class="number">26</span>; i++)</span><br><span class="line">            <span class="keyword">if</span> (c[<span class="number">0</span>][i]) fail[c[<span class="number">0</span>][i]]=<span class="number">0</span>,q.push(c[<span class="number">0</span>][i]);</span><br><span class="line">        <span class="keyword">while</span> (!q.empty())</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">int</span> u=q.front();</span><br><span class="line">            q.pop();</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;<span class="number">26</span>; i++)</span><br><span class="line">                <span class="keyword">if</span> (c[u][i]) fail[c[u][i]]=c[fail[u]][i],q.push(c[u][i]);</span><br><span class="line">                <span class="keyword">else</span> c[u][i]=c[fail[u]][i];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">query</span><span class="params">(<span class="keyword">char</span> *s)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> len=<span class="built_in">strlen</span>(s);</span><br><span class="line">        <span class="keyword">int</span> now=<span class="number">0</span>,ans=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;len; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            now=c[now][s[i]-<span class="string">'a'</span>];</span><br><span class="line">            <span class="comment">//每个单词出现次数最多为1</span></span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> t=now; t&amp;&amp;~val[t]; t=fail[t]) ans+=val[t],val[t]=<span class="number">-1</span>;</span><br><span class="line">            <span class="comment">//每个单词出现次数最多为不限</span></span><br><span class="line">            <span class="comment">//for (int t=now; t; t=fail[t]) ans+=val[t];</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">&#125; AC;</span><br><span class="line"><span class="keyword">char</span> p[<span class="number">1000005</span>]; <span class="comment">//缓冲区</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">AUTO</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> T;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;T);</span><br><span class="line">    <span class="keyword">while</span> (T--)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">int</span> n;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;n);</span><br><span class="line">        AC.init();</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">1</span>; i&lt;=n; i++) <span class="built_in">scanf</span>(<span class="string">"%s"</span>,p),AC.ins(p);</span><br><span class="line">        AC.build();</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%s"</span>,p);</span><br><span class="line">        <span class="keyword">int</span> ans=AC.query(p);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%d\n"</span>,ans);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<hr>
<h6 id="完整版"><a href="#完整版" class="headerlink" title="完整版"></a>完整版</h6><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//适用字符多</span></span><br><span class="line"><span class="comment">//答案详见输出</span></span><br><span class="line"><span class="comment">//较慢</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Aho_Corasick</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">static</span> <span class="keyword">int</span> TEXTNUM = <span class="number">500</span> + <span class="number">50</span>; <span class="comment">//单词数量</span></span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">static</span> <span class="keyword">int</span> TEXTLEN = <span class="number">250</span>; <span class="comment">//单词长度</span></span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">static</span> <span class="keyword">int</span> maxnode = TEXTNUM * TEXTLEN; <span class="comment">//节点数</span></span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">static</span> <span class="keyword">int</span> type = <span class="number">128</span>; <span class="comment">//单词字符数</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">char</span> str[TEXTNUM * TEXTLEN * <span class="number">100</span>]; <span class="comment">//缓冲区</span></span><br><span class="line">    <span class="keyword">char</span> ss[TEXTNUM][TEXTLEN]; <span class="comment">//单词</span></span><br><span class="line">    <span class="keyword">int</span> num[TEXTNUM]; <span class="comment">//单词出现次数</span></span><br><span class="line">    <span class="keyword">int</span> next[maxnode][type], fail[maxnode], end[maxnode];</span><br><span class="line">    <span class="keyword">int</span> root, L;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">newnode</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">auto</span> i = <span class="number">0</span>; i &lt; type; i++) next[L][i] = <span class="number">-1</span>;</span><br><span class="line">        end[L++] = <span class="number">-1</span>;</span><br><span class="line">        <span class="keyword">return</span> L - <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        L = <span class="number">0</span>;</span><br><span class="line">        root = newnode();</span><br><span class="line">        <span class="built_in">memset</span>(str, <span class="number">0</span>, <span class="keyword">sizeof</span>(str));</span><br><span class="line">        <span class="built_in">memset</span>(ss, <span class="number">0</span>, <span class="keyword">sizeof</span>(ss));</span><br><span class="line">        <span class="built_in">memset</span>(num, <span class="number">0</span>, <span class="keyword">sizeof</span>(num));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">insert</span><span class="params">(<span class="keyword">char</span>* str, <span class="keyword">int</span> idx)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">auto</span> len = <span class="built_in">strlen</span>(str);</span><br><span class="line">        <span class="keyword">int</span> now = root;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">auto</span> i = <span class="number">0</span>; i &lt; len; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">int</span> id = str[i];</span><br><span class="line">            <span class="keyword">if</span> (next[now][id] == <span class="number">-1</span>) next[now][id] = newnode();</span><br><span class="line">            now = next[now][id];</span><br><span class="line">        &#125;</span><br><span class="line">        end[now] = idx;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">build</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="built_in">queue</span>&lt;<span class="keyword">int</span>&gt; Q;</span><br><span class="line">        fail[root] = root;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">auto</span> i = <span class="number">0</span>; i &lt; <span class="number">128</span>; i++)</span><br><span class="line">            <span class="keyword">if</span> (next[root][i] == <span class="number">-1</span>) next[root][i] = root;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                fail[next[root][i]] = root;</span><br><span class="line">                Q.push(next[root][i]);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">while</span> (!Q.empty())</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">auto</span> now = Q.front();</span><br><span class="line">            Q.pop();</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">auto</span> i = <span class="number">0</span>; i &lt; type; i++)</span><br><span class="line">                <span class="keyword">if</span> (next[now][i] == <span class="number">-1</span>) next[now][i] = next[fail[now]][i];</span><br><span class="line">                <span class="keyword">else</span></span><br><span class="line">                &#123;</span><br><span class="line">                    fail[next[now][i]] = next[fail[now]][i];</span><br><span class="line">                    Q.push(next[now][i]);</span><br><span class="line">                &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">query</span><span class="params">(<span class="keyword">char</span>* str, <span class="keyword">int</span> n)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">auto</span> len = <span class="built_in">strlen</span>(str);</span><br><span class="line">        <span class="keyword">int</span> now = root;</span><br><span class="line">        <span class="built_in">memset</span>(num, <span class="number">0</span>, <span class="keyword">sizeof</span>(num));</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">auto</span> i = <span class="number">0</span>; i &lt; len; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">int</span> id = str[i];</span><br><span class="line">            now = next[now][id];</span><br><span class="line">            <span class="keyword">int</span> temp = now;</span><br><span class="line">            <span class="keyword">while</span> (temp != root)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span> (end[temp] != <span class="number">-1</span>) num[end[temp]]++;</span><br><span class="line">                temp = fail[temp];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">output</span><span class="params">(<span class="keyword">int</span> n)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> ansnum = <span class="number">0</span>, anstime = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">            <span class="keyword">if</span> (num[i] &gt; <span class="number">0</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                ansnum++;</span><br><span class="line">                anstime += num[i];</span><br><span class="line">                <span class="built_in">printf</span>(<span class="string">"%s times: %d\n"</span>, ss[i], num[i]);</span><br><span class="line">            &#125;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"texts num: %d\n"</span>, ansnum); <span class="comment">//每个单词出现次数最多为1</span></span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"texts times: %d\n"</span>, anstime); <span class="comment">//每个单词出现次数最多为无限</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">output1</span><span class="params">(<span class="keyword">int</span> n, <span class="keyword">int</span> id)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">auto</span> flag = <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">auto</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">            <span class="keyword">if</span> (num[i] &gt; <span class="number">0</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span> (!flag)</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="built_in">cout</span> &lt;&lt; <span class="string">"String "</span> &lt;&lt; id &lt;&lt; <span class="string">":"</span>; <span class="comment">// 匹配成功的串编号</span></span><br><span class="line">                    flag = <span class="literal">true</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="built_in">cout</span> &lt;&lt; <span class="string">" "</span> &lt;&lt; i; <span class="comment">// 匹配到的原串编号</span></span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (flag)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">cout</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125; AC;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">AUTO</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> n;</span><br><span class="line">    <span class="keyword">while</span> (<span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;n) != EOF)</span><br><span class="line">    &#123;</span><br><span class="line">        AC.init();</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">"%s"</span>, AC.ss[i]);</span><br><span class="line">            AC.insert(AC.ss[i], i);</span><br><span class="line">        &#125;</span><br><span class="line">        AC.build();</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%s"</span>, AC.str);</span><br><span class="line">        AC.query(AC.str, n);</span><br><span class="line">        AC.output(n);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">AUTO1</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> n;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n;</span><br><span class="line"></span><br><span class="line">    AC.init();</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">auto</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">cin</span> &gt;&gt; AC.ss[i];</span><br><span class="line">        AC.insert(AC.ss[i], i);</span><br><span class="line">    &#125;</span><br><span class="line">    AC.build();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">int</span> m;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; m;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">auto</span> total = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">auto</span> i = <span class="number">1</span>; i &lt;= m; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">cin</span> &gt;&gt; AC.str;</span><br><span class="line">        AC.query(AC.str, n);</span><br><span class="line">        <span class="keyword">if</span> (AC.output1(n, i)) total++;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="string">"total: "</span> &lt;&lt; total &lt;&lt; <span class="built_in">endl</span>; <span class="comment">// 匹配成功数量</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<hr>
<h4 id="最长上升子序列-LIS"><a href="#最长上升子序列-LIS" class="headerlink" title="最长上升子序列 LIS"></a>最长上升子序列 LIS</h4><h5 id="动态规划"><a href="#动态规划" class="headerlink" title="动态规划"></a>动态规划</h5><p>直接 DP 问题不大，注意一下给你的如果是个空数组就行了</p>
<p>对于位置 i ，dp[i] 表示以 nums[i] 结尾的 LIS 的长度</p>
<p>所以初始化 dp[i]=1, 1&lt;=i&lt;=n 毕竟每个位置自身就是长度为1的 LIS</p>
<p>对于位置 i ，dp[i] 一定是由前面的结尾的值小于 nums[i] 的位置转移过来的</p>
<p>所以 <code>dp[i]=max(dp[j]+1), 1&lt;=j&lt;i, a[j]&lt;a[i]</code></p>
<p>$O(n^2)$ 的时间， $O(n)$ 的空间，最长不降子序列加等号就行</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">lengthOfLIS</span><span class="params">(<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&amp; nums)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="function"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; <span class="title">dp</span><span class="params">(nums.size(), <span class="number">1</span>)</span></span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">auto</span> i = <span class="number">0</span>; i &lt; nums.size(); i++)</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">auto</span> j = <span class="number">0</span>; j &lt; i; j++)</span><br><span class="line">                <span class="keyword">if</span> (nums[i] &gt; nums[j]) dp[i] = max(dp[i], dp[j] + <span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">auto</span> ans = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">auto</span> it : dp) ans = max(ans, it);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h5 id="二分查找优化"><a href="#二分查找优化" class="headerlink" title="二分查找优化"></a>二分查找优化</h5><p>有一个题解是这样说的，道理是这个道理，然而我不知道为什么这样是对的：</p>
<ul>
<li>新建数组 cell，用于保存最长上升子序列</li>
<li>对原序列进行遍历，将每位元素二分插入 cell 中</li>
<li>如果 cell 中元素都比它小，将它插到最后</li>
<li>否则，用它覆盖掉比它大的元素中最小的那个。</li>
<li>总之，思想就是让 cell 中存储比较小的元素。这样，cell 未必是真实的最长上升子序列，但长度是对的。</li>
</ul>
<p>当然还有一个我能理解的办法，不然我也不会写这个东西了</p>
<p>这个办法的核心是维护一个数组，d[i] 表示长度为 i 的 LIS 的末尾元素的最小值，初始化 d<a href="https://cdn.luogu.org/upload/pic/28671.png" target="_blank" rel="noopener">1</a>=nums[0] 。同时维护一个变量 len 标记目前的 LIS 长度</p>
<p>遍历数组，对于每一个元素 nums[i]：</p>
<ul>
<li>如果这个元素大于已知的最长 LIS 的末尾元素，那么我们就找到了一个更长的 LIS ，因此 len++, d[len]=nums[i]</li>
<li>否则二分查找数组 d ，找到第一个比 nums[i] 小的位置 j，j 就是这个元素前面能用的最大 LIS 长度，d[j+1] 肯定是大于nums[i] ，那么现在长度为 j+1 的 LIS 末尾元素最小值就应该是 nums[i]，d[j+1]=nums[i]</li>
</ul>
<p>这样操作数组 d 肯定是单调的，所以可以用二分查找</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">lengthOfLIS</span><span class="params">(<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&amp; nums)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (nums.empty()) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; <span class="title">d</span><span class="params">(nums.size() + <span class="number">1</span>, <span class="number">0</span>)</span></span>;</span><br><span class="line">        <span class="keyword">auto</span> len = <span class="number">1</span>;</span><br><span class="line">        d[<span class="number">1</span>] = nums[<span class="number">0</span>];</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">auto</span> it : nums)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (it &gt; d[len])</span><br><span class="line">            &#123;</span><br><span class="line">                len++;</span><br><span class="line">                d[len] = it;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">const</span> <span class="keyword">auto</span> index = lower_bound(d.begin() + <span class="number">1</span>, d.begin() + <span class="number">1</span> + len, it) - d.begin();</span><br><span class="line">                d[index] = it;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> len;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<hr>
<h4 id="后缀数组"><a href="#后缀数组" class="headerlink" title="后缀数组"></a>后缀数组</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//rrank:rrank[i]为起始位置为i的后缀的排名，i:[0,len)</span></span><br><span class="line"><span class="comment">// sa:sa[i]为排名为i的后缀的起始位置，i:[0,len)</span></span><br><span class="line"><span class="comment">//height:height[i]排名为i和i-1的后缀的lcp，i:(0,len)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">233333</span>;</span><br><span class="line"><span class="keyword">char</span> s[maxn];</span><br><span class="line"><span class="keyword">int</span> t1[maxn], t2[maxn], cc[maxn], x[maxn], sa[maxn], rrank[maxn], height[maxn];</span><br><span class="line"><span class="keyword">int</span> len;</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">cmp</span><span class="params">(<span class="keyword">int</span> *y, <span class="keyword">int</span> a, <span class="keyword">int</span> b, <span class="keyword">int</span> k)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> a1 = y[a];</span><br><span class="line">    <span class="keyword">int</span> b1 = y[b];</span><br><span class="line">    <span class="keyword">int</span> a2 = a + k &gt;= len ? <span class="number">-1</span> : y[a + k];</span><br><span class="line">    <span class="keyword">int</span> b2 = b + k &gt;= len ? <span class="number">-1</span> : y[b + k];</span><br><span class="line">    <span class="keyword">return</span> a1 == b1 &amp;&amp; a2 == b2;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">make_sa</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> *x = t1, *y = t2;</span><br><span class="line">    <span class="keyword">int</span> m = <span class="number">256</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; m; i++) cc[i] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len; i++) ++cc[x[i] = s[i]];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; m; i++) cc[i] += cc[i - <span class="number">1</span>];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = len - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i--) sa[--cc[x[i]]] = i;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">1</span>; k &lt;= len; k &lt;&lt;= <span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">int</span> p = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = len - k; i &lt; len; i++) y[p++] = i;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len; i++)</span><br><span class="line">            <span class="keyword">if</span> (sa[i] &gt;= k) y[p++] = sa[i] - k;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; m; i++) cc[i] = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len; i++) ++cc[x[y[i]]];</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; m; i++) cc[i] += cc[i - <span class="number">1</span>];</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = len - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i--) sa[--cc[x[y[i]]]] = y[i];</span><br><span class="line"></span><br><span class="line">        swap(x, y);</span><br><span class="line">        m = <span class="number">1</span>;</span><br><span class="line">        x[sa[<span class="number">0</span>]] = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; len; i++)</span><br><span class="line">            x[sa[i]] = cmp(y, sa[i], sa[i - <span class="number">1</span>], k) ? m - <span class="number">1</span> : m++;</span><br><span class="line">        <span class="keyword">if</span> (m &gt;= len) <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">make_height</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len; i++) rrank[sa[i]] = i;</span><br><span class="line">    height[<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">int</span> k = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (!rrank[i]) <span class="keyword">continue</span>;</span><br><span class="line">        <span class="keyword">int</span> j = sa[rrank[i] - <span class="number">1</span>];</span><br><span class="line">        <span class="keyword">if</span> (k) k--;</span><br><span class="line">        <span class="keyword">while</span> (s[i + k] == s[j + k]) k++;</span><br><span class="line">        height[rrank[i]] = k;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">memset</span>(s, <span class="number">0</span>, <span class="keyword">sizeof</span>(s));</span><br><span class="line">    <span class="built_in">memset</span>(t1, <span class="number">0</span>, <span class="keyword">sizeof</span>(t1));</span><br><span class="line">    <span class="built_in">memset</span>(t2, <span class="number">0</span>, <span class="keyword">sizeof</span>(t2));</span><br><span class="line">    <span class="built_in">memset</span>(cc, <span class="number">0</span>, <span class="keyword">sizeof</span>(cc));</span><br><span class="line">    <span class="built_in">memset</span>(x, <span class="number">0</span>, <span class="keyword">sizeof</span>(x));</span><br><span class="line">    <span class="built_in">memset</span>(sa, <span class="number">0</span>, <span class="keyword">sizeof</span>(sa));</span><br><span class="line">    <span class="built_in">memset</span>(rrank, <span class="number">0</span>, <span class="keyword">sizeof</span>(rrank));</span><br><span class="line">    <span class="built_in">memset</span>(height, <span class="number">0</span>, <span class="keyword">sizeof</span>(height));</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%s"</span>, s);</span><br><span class="line">    len = <span class="built_in">strlen</span>(s);</span><br><span class="line">    make_sa();</span><br><span class="line">    make_height();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<hr>
<h4 id="编辑距离"><a href="#编辑距离" class="headerlink" title="编辑距离"></a>编辑距离</h4><h5 id="定义-2"><a href="#定义-2" class="headerlink" title="定义"></a>定义</h5><p>编辑距离（Edit Distance），又称 Levenshtein 距离。</p>
<p>编辑距离是指两个字符串之间，由一个字符串转化为另一个字符串所需的<strong>最小</strong>编辑操作次数。</p>
<p>许可的编辑操作包括：</p>
<ul>
<li>在原串中添加一个字符</li>
<li>在原串中删除一个字符</li>
<li>在原串中修改一个字符</li>
</ul>
<h5 id="解法"><a href="#解法" class="headerlink" title="解法"></a>解法</h5><p>解法当然是 DP 了！</p>
<p>先来看看操作，设原串为 A 新串为 B，A 串的长度为 n，B 串的长度为 m，那么现在就有对两个串的 6 种操作。</p>
<p>然而我们可以把操作简化为三种：</p>
<ul>
<li>在 A 中添加一个字符（等价于在 B 中删除一个字符）</li>
<li>在 B 中添加一个字符（等价于在 A 中删除一个字符）</li>
<li>在 A 中修改一个字符（等价于在 B 中修改一个字符） </li>
</ul>
<p>然后看看转移，这里用 <code>dp[i][j]</code> 表示 A 从头开始的 i 个字符与 B 从头开始的 j 个字符。</p>
<p><strong>i 和 j 为 0 的时候就表示空串。所以这个二维数组应该开到 <code>dp[n + 1][m + 1]</code> 。</strong></p>
<p>对于 <code>dp[i][j]</code> 可以由下面三种方式转移得到：</p>
<ul>
<li><code>dp[i - 1][j] + 1</code> 只需要在现有 A 串的末尾添加一个字符即可</li>
<li><code>dp[i][j - 1] + 1</code> 只需要在现有 B 串的末尾添加一个字符即可</li>
<li><code>dp[i - 1][j - 1] + (A[i - 1] == B[i - 1] ? 0 : 1)</code> 这里需要判断 A 串中第 i 个字符（下标 i - 1）和 B 串中第 j 个字符（下标 j - 1）是否相同。相同的话直接转移，不同的话需要把 A[i - 1] 修改为 B[j - 1]，因此编辑距离增加 1</li>
</ul>
<p>因此</p>
<p>$$<br>dp[i][j]=min(dp[i-1][j]+1,dp[i][j-1]+1,dp[i][j]+(A[i - 1] == B[i - 1] ? 0 : 1))<br>$$</p>
<p>最后看看边界条件，由于空串到任意一个串只需要不断加加加，一个串到空串只需要不断减减减，所以：</p>
<ul>
<li><code>dp[i][0] = i</code> 在 B 中添加 i 个字符</li>
<li><code>dp[0][j] = j</code> 在 A 中添加 j 个字符</li>
</ul>
<p>条件齐了，将 i 和 j 从 0 推到 n 和 m 即可，正推时所有前置条件都已经算完了。</p>
<p>时空复杂度均为 $O(nm)$。</p>
<h5 id="实现"><a href="#实现" class="headerlink" title="实现"></a>实现</h5><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">minDistance</span><span class="params">(<span class="built_in">string</span> word1, <span class="built_in">string</span> word2)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="function"><span class="built_in">vector</span>&lt;<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&gt; <span class="title">dp</span><span class="params">(word1.size() + <span class="number">1</span>, <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;(word2.size() + <span class="number">1</span>))</span></span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">auto</span> i = <span class="number">0</span>; i &lt; dp.size(); i++) dp[i][<span class="number">0</span>] = i;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">auto</span> j = <span class="number">0</span>; j &lt; dp[<span class="number">0</span>].size(); j++) dp[<span class="number">0</span>][j] = j;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">auto</span> i = <span class="number">1</span>; i &lt; dp.size(); i++)</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">auto</span> j = <span class="number">1</span>; j &lt; dp[<span class="number">0</span>].size(); j++)</span><br><span class="line">                dp[i][j] = min(&#123;</span><br><span class="line">                    dp[i - <span class="number">1</span>][j] + <span class="number">1</span>,</span><br><span class="line">                    dp[i][j - <span class="number">1</span>] + <span class="number">1</span>,</span><br><span class="line">                    dp[i - <span class="number">1</span>][j - <span class="number">1</span>] + (word1[i - <span class="number">1</span>] == word2[j - <span class="number">1</span>] ? <span class="number">0</span> : <span class="number">1</span>)</span><br><span class="line">                &#125;);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> dp[word1.size()][word2.size()];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<hr>
<h3 id="排序"><a href="#排序" class="headerlink" title="排序"></a>排序</h3><h4 id="快速排序"><a href="#快速排序" class="headerlink" title="快速排序"></a>快速排序</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 0下标</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">quicksort</span><span class="params">(<span class="keyword">int</span> b, <span class="keyword">int</span> e, <span class="keyword">int</span> a[])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">auto</span> i = b, j = e, x = a[(b + e) / <span class="number">2</span>];</span><br><span class="line">    <span class="keyword">do</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">while</span> (a[i] &lt; x) i++;</span><br><span class="line">        <span class="keyword">while</span> (a[j] &gt; x) j--;</span><br><span class="line">        <span class="keyword">if</span> (i &lt;= j) swap(a[i++], a[j--]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> (i &lt; j);</span><br><span class="line">    <span class="keyword">if</span> (i &lt; e) quicksort(i, e, a);</span><br><span class="line">    <span class="keyword">if</span> (j &gt; b) quicksort(b, j, a);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">quicksort</span><span class="params">(<span class="keyword">int</span> b, <span class="keyword">int</span> e, <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&amp; a)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">auto</span> i = b, j = e, x = a[(b + e) / <span class="number">2</span>];</span><br><span class="line">    <span class="keyword">do</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">while</span> (a[i] &lt; x) i++;</span><br><span class="line">        <span class="keyword">while</span> (a[j] &gt; x) j--;</span><br><span class="line">        <span class="keyword">if</span> (i &lt;= j) swap(a[i++], a[j--]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> (i &lt; j);</span><br><span class="line">    <span class="keyword">if</span> (i &lt; e) quicksort(i, e, a);</span><br><span class="line">    <span class="keyword">if</span> (j &gt; b) quicksort(b, j, a);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 开始选中间的数为 flag，把 flag 位置和最后一个位置交换</span></span><br><span class="line"><span class="comment">// lpos 为比 flag 小的最后一个位置，rpos 从 L 扫到 R-1，遇到一个比 flag 小的就 lpos++，交换 lpos 和 rpos</span></span><br><span class="line"><span class="comment">// 一轮完了 lpos++，此时的 lpos 为 flag 的正确位置，交换 lpos 和 R</span></span><br><span class="line"><span class="comment">// 递归处理 L 到 lpos-1 和 lpos+1 到 R</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">qksort</span><span class="params">(<span class="keyword">const</span> <span class="keyword">int</span> L, <span class="keyword">const</span> <span class="keyword">int</span> R, <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&amp; v)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (L &gt;= R) <span class="keyword">return</span>;</span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">auto</span> flag = v[(L + R) / <span class="number">2</span>];</span><br><span class="line">    swap(v[R], v[(L + R) / <span class="number">2</span>]);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">auto</span> lpos = L - <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">auto</span> rpos = L; rpos &lt; R; rpos++)</span><br><span class="line">        <span class="keyword">if</span> (v[rpos] &lt; flag)</span><br><span class="line">        &#123;</span><br><span class="line">            lpos++;</span><br><span class="line">            swap(v[lpos], v[rpos]);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    lpos++;</span><br><span class="line">    swap(v[lpos], v[R]);</span><br><span class="line"></span><br><span class="line">    qksort(L, lpos - <span class="number">1</span>, v);</span><br><span class="line">    qksort(lpos + <span class="number">1</span>, R, v);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<hr>
<h4 id="归并排序"><a href="#归并排序" class="headerlink" title="归并排序"></a>归并排序</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">200000</span>;</span><br><span class="line"><span class="keyword">int</span> a[MAXN];<span class="comment">//待排序</span></span><br><span class="line"><span class="keyword">int</span> t[MAXN];<span class="comment">//额外空间</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">msort</span><span class="params">(<span class="keyword">int</span> b, <span class="keyword">int</span> e)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (e - b &lt;= <span class="number">0</span>) <span class="keyword">return</span>;</span><br><span class="line">    <span class="keyword">int</span> mid = (b + e) / <span class="number">2</span>, p1 = b, p2 = mid + <span class="number">1</span>, i = b;</span><br><span class="line">    msort(b, mid);</span><br><span class="line">    msort(mid + <span class="number">1</span>, e);</span><br><span class="line">    <span class="keyword">while</span> (p1 &lt;= mid || p2 &lt;= e)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (p2 &gt; e || (p1 &lt;= mid &amp;&amp; a[p1] &lt;= a[p2])) t[i++] = a[p1++];</span><br><span class="line">        <span class="keyword">else</span> t[i++] = a[p2++];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = b; i &lt;= e; i++) a[i] = t[i];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<hr>
<h3 id="搜索"><a href="#搜索" class="headerlink" title="搜索"></a>搜索</h3><h4 id="N皇后"><a href="#N皇后" class="headerlink" title="N皇后"></a>N皇后</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">queen</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> n, i, odd;</span><br><span class="line">    <span class="keyword">while</span> (<span class="built_in">cin</span> &gt;&gt; n)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (n &lt; <span class="number">4</span>) <span class="built_in">cout</span> &lt;&lt; <span class="string">"Impossible"</span>;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> ((n / <span class="number">2</span>) % <span class="number">3</span> != <span class="number">1</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">cout</span> &lt;&lt; <span class="number">2</span>;</span><br><span class="line">            <span class="keyword">for</span> (i = <span class="number">4</span>; i &lt;= n; i += <span class="number">2</span>) <span class="built_in">cout</span> &lt;&lt; <span class="string">" "</span> &lt;&lt; i;</span><br><span class="line">            <span class="keyword">for</span> (i = <span class="number">1</span>; i &lt;= n; i += <span class="number">2</span>) <span class="built_in">cout</span> &lt;&lt; <span class="string">" "</span> &lt;&lt; i;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (n % <span class="number">2</span> == <span class="number">0</span>) odd = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                n--;</span><br><span class="line">                odd = <span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="built_in">cout</span> &lt;&lt; n / <span class="number">2</span>;</span><br><span class="line">            <span class="keyword">for</span> (i = n / <span class="number">2</span> + <span class="number">1</span>; i != n / <span class="number">2</span> - <span class="number">1</span>; i = (i + <span class="number">2</span>) % n) <span class="built_in">cout</span> &lt;&lt; <span class="string">" "</span> &lt;&lt; i + <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">for</span> (i = (i + n - <span class="number">2</span>) % n; i != n / <span class="number">2</span> - <span class="number">1</span>; i = (i + n - <span class="number">2</span>) % n) <span class="built_in">cout</span> &lt;&lt; <span class="string">" "</span> &lt;&lt; n - i;</span><br><span class="line">            <span class="built_in">cout</span> &lt;&lt; <span class="string">" "</span> &lt;&lt; n - i;</span><br><span class="line">            <span class="keyword">if</span> (odd) <span class="built_in">cout</span> &lt;&lt; <span class="string">" "</span> &lt;&lt; n + <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<hr>
<h4 id="BFS-队列版本"><a href="#BFS-队列版本" class="headerlink" title="BFS 队列版本"></a>BFS 队列版本</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; P; <span class="comment">//点的坐标</span></span><br><span class="line"><span class="keyword">char</span> <span class="built_in">map</span>[MAXN][MAXM]; <span class="comment">//地图数组</span></span><br><span class="line"><span class="keyword">int</span> n, m; <span class="comment">//地图行列数</span></span><br><span class="line"><span class="keyword">int</span> start_s, start_y, end_x, end_y; <span class="comment">//起点终点坐标</span></span><br><span class="line"><span class="keyword">int</span> d[MAXN][MAXM] = &#123;<span class="number">0</span>&#125;; <span class="comment">//记录走到该坐标需要的最短步数</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">bfs</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">queue</span>&lt;P&gt; q;</span><br><span class="line">    q.push(P(start_s, start_y)); <span class="comment">//将起点放进队列中</span></span><br><span class="line">    d[start_s][start_y] = <span class="number">0</span>; <span class="comment">//到起点步数为0</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> (!q.empty())</span><br><span class="line">    &#123;</span><br><span class="line">        P p = q.front(); <span class="comment">//定义当前队列顶端坐标为P</span></span><br><span class="line">        q.pop();<span class="comment">//将P弹出 @</span></span><br><span class="line">        <span class="keyword">if</span> (p.first == end_x &amp;&amp; p.second == end_y) <span class="keyword">break</span>;<span class="comment">//判断该坐标是否是终点，是的话结束</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">4</span>; i++)<span class="comment">//使坐标不断向四个方向移动</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">int</span> x = p.first + dx[i];</span><br><span class="line">            <span class="keyword">int</span> y = p.second + dy[i];</span><br><span class="line">            <span class="keyword">if</span> (<span class="number">0</span> &lt;= x &amp;&amp; x &lt; n &amp;&amp; <span class="number">0</span> &lt;= y &amp;&amp; y &lt;= m &amp;&amp; <span class="built_in">map</span>[x][y] != <span class="string">'#'</span> &amp;&amp; d[x][y] == <span class="number">0</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">//当前坐标某方位是否可移动判断</span></span><br><span class="line">                q.push(P(x, y)); <span class="comment">//如果坐标当前某方向可移动，则将该位置该点坐标放入队列中</span></span><br><span class="line">                d[x][y] = d[p.first][p.second] + <span class="number">1</span>; <span class="comment">//记录该位置的最短步数 = 上一位置到达步数 + 1</span></span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">//如果四个方位都不行则将顶点位置弹出，直到返回上一个有多个出口的位置</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<hr>
<h3 id="C"><a href="#C" class="headerlink" title="C++"></a>C++</h3><h4 id="引用"><a href="#引用" class="headerlink" title="引用"></a>引用</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//引用(reference)为对象起了另一个名字，将引用与初始值绑定(bind)在一起，二者类型需相同</span></span><br><span class="line"><span class="comment">//引用及别名</span></span><br><span class="line"><span class="comment">//必须初始化，初始化后无法重新绑定</span></span><br><span class="line"><span class="comment">//使用 &amp;d 其中d为变量</span></span><br><span class="line"><span class="keyword">int</span> a;</span><br><span class="line"><span class="keyword">char</span> b;</span><br><span class="line"><span class="keyword">int</span> &amp;aa = a;</span><br><span class="line"><span class="keyword">auto</span> &amp;bb = b;<span class="comment">//auto将自动识别类型 C++11</span></span><br></pre></td></tr></table></figure>

<hr>
<h4 id="范围for"><a href="#范围for" class="headerlink" title="范围for"></a>范围for</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//C++ 11</span></span><br><span class="line"><span class="comment">//for (变量 : 序列) 语句</span></span><br><span class="line"><span class="comment">//范围for可以在不知道开始和结尾的情况下进行遍历</span></span><br><span class="line"><span class="comment">//序列均可返回迭代器的begin和end成员</span></span><br><span class="line"><span class="comment">//可以为 初始值列表(&#123;1,2,3&#125;) 数组 string vector map set...</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//声明变量若未使用引用，则只读不可写</span></span><br><span class="line"><span class="built_in">map</span>&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; <span class="built_in">map</span> = &#123; &#123;<span class="number">1</span>,<span class="number">1</span>&#125;,&#123;<span class="number">2</span>,<span class="number">2</span>&#125; &#125;;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">auto</span> i : <span class="built_in">map</span>)</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; i.first &lt;&lt; <span class="built_in">endl</span> &lt;&lt; i.second &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//使用引用，可写</span></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">auto</span> &amp;i : <span class="built_in">map</span>) i.second++;</span><br></pre></td></tr></table></figure>

<hr>
<h4 id="列表"><a href="#列表" class="headerlink" title="列表"></a>列表</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//c++11</span></span><br><span class="line"><span class="comment">//循环可以使用列表，类似Python list</span></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i:&#123;<span class="number">2</span>, <span class="number">3</span>, <span class="number">7</span>, <span class="number">61</span>, <span class="number">24251</span>&#125;) &#123;<span class="built_in">cout</span>&lt;&lt;i;&#125;</span><br><span class="line"><span class="comment">//多个最值的比较</span></span><br><span class="line"><span class="keyword">int</span> x = max(&#123; <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span> &#125;);</span><br></pre></td></tr></table></figure>

<hr>
<h4 id="二进制读写"><a href="#二进制读写" class="headerlink" title="二进制读写"></a>二进制读写</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 将int以二进制输出（四个字节）</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="title">output_int</span><span class="params">(ofstream&amp; out, <span class="keyword">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">auto</span> i = <span class="number">3</span>; i &gt;= <span class="number">0</span>; i--)</span><br><span class="line">    &#123;</span><br><span class="line">        out &lt;&lt; *(<span class="keyword">reinterpret_cast</span>&lt;<span class="keyword">char</span>*&gt;(&amp;x) + i);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 将int以二进制输入（四个字节）</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">input_int</span><span class="params">(ifstream&amp; in)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">auto</span> ans = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">auto</span> i = <span class="number">0</span>; i &lt; <span class="number">4</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        ans &lt;&lt;= <span class="number">8</span>;</span><br><span class="line">        <span class="keyword">char</span> temp;</span><br><span class="line">        in &gt;&gt; temp;</span><br><span class="line">        ans |= <span class="keyword">static_cast</span>&lt;<span class="keyword">unsigned</span> <span class="keyword">char</span>&gt;(temp);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<hr>
<h4 id="头文件"><a href="#头文件" class="headerlink" title="头文件"></a>头文件</h4><h5 id="lt-builtin-gt-内建函数"><a href="#lt-builtin-gt-内建函数" class="headerlink" title="&lt; __builtin &gt; 内建函数"></a>&lt; __builtin &gt; 内建函数</h5><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">__builtin_clz(x)         <span class="comment">//返回x的二进制前导0的个数</span></span><br><span class="line">__builtin_ctz(x)         <span class="comment">//返回x的二进制末尾0的个数</span></span><br><span class="line">__builtin_popcount(x)    <span class="comment">//返回x的二进制中1的个数</span></span><br><span class="line">__builtin_parity(x)      <span class="comment">//返回x的二进制中1的个数的奇偶性，0偶1奇</span></span><br><span class="line">__builtin_ffs(x)         <span class="comment">//返回x的二进制中末尾最后一个1的位置，编号从1开始</span></span><br><span class="line"><span class="comment">//以上函数的long long版本：</span></span><br><span class="line">__builtin_clzll</span><br><span class="line">__builtin_ctzll</span><br><span class="line">__builtin_popcountll</span><br></pre></td></tr></table></figure>

<hr>
<h5 id="lt-cmath-gt-数学函数"><a href="#lt-cmath-gt-数学函数" class="headerlink" title="&lt; cmath &gt; 数学函数"></a>&lt; cmath &gt; 数学函数</h5><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//基础运算</span></span><br><span class="line"><span class="built_in">abs</span>(x)          <span class="comment">//x的绝对值，整型</span></span><br><span class="line"><span class="built_in">fabs</span>(x)         <span class="comment">//x的绝对值，浮点</span></span><br><span class="line"><span class="built_in">ceil</span>(x)         <span class="comment">//x向上取整</span></span><br><span class="line"><span class="built_in">floor</span>(x)        <span class="comment">//x向下取整</span></span><br><span class="line">round(x)        <span class="comment">//x的四舍五入值</span></span><br><span class="line">trunc(x)        <span class="comment">//截取x的整数部分</span></span><br><span class="line"><span class="built_in">fmod</span>(x, y)      <span class="comment">//x/y的浮点数余数</span></span><br><span class="line"><span class="comment">//指数/对数</span></span><br><span class="line"><span class="built_in">pow</span>(x, y)       <span class="comment">//x的y次幂</span></span><br><span class="line"><span class="built_in">exp</span>(x)          <span class="comment">//e的x次幂</span></span><br><span class="line"><span class="built_in">sqrt</span>(x)         <span class="comment">//x的平方根</span></span><br><span class="line">cbrt(x)         <span class="comment">//x的立方根 C++11</span></span><br><span class="line">(<span class="keyword">int</span>)(<span class="built_in">pow</span>(x,<span class="number">1.0</span>/<span class="number">3.0</span>)+<span class="number">0.5</span>) <span class="comment">//等价，0.5用于四舍五入</span></span><br><span class="line"><span class="built_in">log</span>(x)          <span class="comment">//x以e为底的对数</span></span><br><span class="line"><span class="built_in">log10</span>(x)        <span class="comment">//x以10为底的对数</span></span><br><span class="line">log2(x)         <span class="comment">//x以2为底的对数</span></span><br><span class="line"><span class="comment">//三角函数</span></span><br><span class="line"><span class="built_in">acos</span>(x)         <span class="comment">//x的反余弦</span></span><br><span class="line"><span class="built_in">asin</span>(x)         <span class="comment">//x的反正弦</span></span><br><span class="line"><span class="built_in">atan</span>(x)         <span class="comment">//x的反正切</span></span><br><span class="line"><span class="built_in">atan2</span>(y, x)     <span class="comment">//点(x, y)与x轴正方向的夹角(返回值范围(-π, π])</span></span><br><span class="line">hypot(x, y)     <span class="comment">//返回直角三角形斜边的长度：√(x2+y^2)</span></span><br></pre></td></tr></table></figure>

<hr>
<h5 id="lt-random-gt-随机函数"><a href="#lt-random-gt-随机函数" class="headerlink" title="&lt; random &gt; 随机函数"></a>&lt; random &gt; 随机函数</h5><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">mt19937 <span class="title">mt_rand</span><span class="params">(time(<span class="number">0</span>))</span>        <span class="comment">//初始化随机数生成器</span></span></span><br><span class="line"><span class="function"><span class="title">mt_rand</span><span class="params">()</span>                       <span class="comment">//返回一个随机的unsigned int值(0 ~ 4294967295)</span></span></span><br><span class="line"><span class="function"><span class="comment">//法二</span></span></span><br><span class="line"><span class="function"><span class="comment">//&lt;cstdlib&gt; &lt;ctime&gt; </span></span></span><br><span class="line"><span class="function"><span class="title">srand</span><span class="params">((<span class="keyword">unsigned</span>)time(<span class="literal">NULL</span>))</span></span>;</span><br><span class="line">a = rand() % <span class="number">9000</span> + <span class="number">1000</span>;</span><br></pre></td></tr></table></figure>

<hr>
<h5 id="lt-cctype-gt-字符类型"><a href="#lt-cctype-gt-字符类型" class="headerlink" title="&lt; cctype &gt; 字符类型"></a>&lt; cctype &gt; 字符类型</h5><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">isalnum</span>()     <span class="comment">//如果参数是字母或数字，该函数返回true</span></span><br><span class="line"><span class="built_in">isalpha</span>()     <span class="comment">//如果参数是字母，该函数返回true</span></span><br><span class="line"><span class="built_in">isdigit</span>()     <span class="comment">//如果参数是数字，该函数返回true</span></span><br><span class="line"><span class="built_in">islower</span>()     <span class="comment">//如果参数是小写字母，该函数返回true</span></span><br><span class="line"><span class="built_in">isupper</span>()     <span class="comment">//如果参数是大写字母，该函数返回true</span></span><br><span class="line"><span class="built_in">isxdigit</span>()    <span class="comment">//如果参数是十六进制的数字，即0～9、a~f、A~F，该函数返回true</span></span><br><span class="line"><span class="built_in">tolower</span>()     <span class="comment">//如果参数是大写字符，则返回其小写，否则返回该参数</span></span><br><span class="line"><span class="built_in">toupper</span>()     <span class="comment">//如果参数是小写字母，则返回其大写，否则返回该参数</span></span><br></pre></td></tr></table></figure>

<hr>
<h5 id="lt-cstring-gt-C字符串"><a href="#lt-cstring-gt-C字符串" class="headerlink" title="&lt; cstring &gt; C字符串"></a>&lt; cstring &gt; C字符串</h5><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">memset</span>(a, <span class="number">0</span>, <span class="keyword">sizeof</span>(a)) <span class="comment">//将数组a清零，理论上只能将数组全部变成0或-1,其他数也行，原因未知</span></span><br><span class="line"><span class="built_in">strlen</span>(str)             <span class="comment">//返回字符串str的长度（不包括'\0'）</span></span><br><span class="line"><span class="built_in">strcpy</span>(s1, s2)          <span class="comment">//复制字符串 s2 到字符串 s1</span></span><br><span class="line"><span class="built_in">strcat</span>(s1, s2)          <span class="comment">//把s2复制到s1已有的字符之后，形成连起的串</span></span><br><span class="line"><span class="built_in">strchr</span>(s1, ch)          <span class="comment">//返回一个指针，指向字符串 s1中字符 ch 的第一次出现的位置</span></span><br><span class="line"><span class="built_in">strstr</span>(s1, s2)          <span class="comment">//返回一个指针，指向字符串 s1 中字符串 s2 的第一次出现的位置</span></span><br><span class="line"><span class="built_in">strcmp</span>(s1, s2)          <span class="comment">//如果相同，则返回 0；如果 s1&lt;s2 则返回值小于 0；反之大于 0</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//数字与字符串转换 C++11</span></span><br><span class="line"><span class="built_in">string</span> s=to_string(x)   <span class="comment">//把数字x转换为字符串，x可以为任意数的类型</span></span><br><span class="line"><span class="keyword">int</span> n=stoi(s)           <span class="comment">//把字符串s转换为int类型</span></span><br><span class="line"><span class="keyword">long</span> <span class="keyword">long</span> n=stoll(s)    <span class="comment">//把字符串s转换为long long类型</span></span><br></pre></td></tr></table></figure>

<hr>
<h5 id="lt-algorithm-gt-算法"><a href="#lt-algorithm-gt-算法" class="headerlink" title="&lt; algorithm &gt; 算法"></a>&lt; algorithm &gt; 算法</h5><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">swap(a, b)    <span class="comment">//交换两个变量的值。</span></span><br><span class="line">max(a, b)     <span class="comment">//返回两个数中的较大值。</span></span><br><span class="line">min(a, b)     <span class="comment">//返回两个数中的较小值。</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//最值+列表，C++11</span></span><br><span class="line">max(&#123;<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>&#125;)    <span class="comment">//大括号中多个值用逗号隔开</span></span><br><span class="line">min(&#123;<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>&#125;)    <span class="comment">//大括号中多个值用逗号隔开</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//以下函数对STL类型的操作，(a, a + n) 改为 (a.begin(), a.end())</span></span><br><span class="line">max_element(a, a + n)        <span class="comment">//返回序列中最大值的地址。序列中最大值：*max_element(a, a + n)</span></span><br><span class="line">min_element(a, a + n)        <span class="comment">//返回序列中最小值的地址。序列中最小值：*min_element(a, a + n)</span></span><br><span class="line">reverse(a, a + n)            <span class="comment">//翻转一个n个元素的数组</span></span><br><span class="line">random_shuffle(a, a + n)     <span class="comment">//随机打乱一个n个元素的数组</span></span><br><span class="line">sort(a, a + n)               <span class="comment">//对n个元素的数组进行从小到大排序</span></span><br><span class="line">sort(a, a + n, greater&lt;<span class="keyword">int</span>&gt;())               <span class="comment">//对n个元素的数组进行从大到小排序</span></span><br><span class="line">sort(a, a + n, [](<span class="keyword">const</span> <span class="keyword">auto</span> &amp;a,<span class="keyword">const</span> <span class="keyword">auto</span> &amp;b) &#123;<span class="keyword">return</span> a&gt;b;&#125;)          <span class="comment">//自定义排序，排序方法由Lambda表达式的返回值决定（这里是从大到小），c++14，此时可用auto</span></span><br><span class="line"></span><br><span class="line">unique(a, a + n)             <span class="comment">//去除序列中相邻的重复元素，返回去重后的尾地址</span></span><br><span class="line">binary_search(a, a + n, x)   <span class="comment">//查找有序序列中是否存在元素x，找到返回1，否则返回0</span></span><br><span class="line">lower_bound(a, a + n, x, cmp)     <span class="comment">//返回有序序列中第一个≥x的值的迭代器</span></span><br><span class="line">upper_bound(a, a + n, x, cmp)     <span class="comment">//返回有序序列中第一个&gt;x的值的迭代器</span></span><br><span class="line">lower_bound(a, a + n, x, cmp) - a <span class="comment">//第一个≥x的值的数组下标</span></span><br><span class="line">upper_bound(a, a + n, x, cmp) – a <span class="comment">//第一个&gt;x的值的数组下标</span></span><br><span class="line"></span><br><span class="line">equal_range(a, a + n, x, cmp)     <span class="comment">//返回pair(x,y) ,x对应value的开始迭代器，y对应value的结束迭代器，左闭右开</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//取值前先判断：若不存在≥x的值，则会造成非法内存访问(Runtime Error)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//全排列</span></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">next_permutation</span><span class="params">(iterator start,iterator end)</span> </span></span><br><span class="line"><span class="function"><span class="comment">//逆序是最大的一个，为假则已经是逆序</span></span></span><br><span class="line">int a[5] = &#123; 5,4,3,2,1 &#125;;</span><br><span class="line">sort(a, a + <span class="number">5</span>);<span class="comment">//顺序是最小的一个</span></span><br><span class="line">next_permutation(a, a + <span class="number">5</span>);<span class="comment">//下一个</span></span><br><span class="line">prev_permutation(a, a + <span class="number">5</span>);<span class="comment">//前一个</span></span><br></pre></td></tr></table></figure>

<hr>
<h5 id="lt-numeric-gt-数值序列"><a href="#lt-numeric-gt-数值序列" class="headerlink" title="&lt; numeric &gt; 数值序列"></a>&lt; numeric &gt; 数值序列</h5><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//使用vector时应用v.begin()和v.end()</span></span><br><span class="line"></span><br><span class="line">iota(numbers, numbers + <span class="number">5</span>, <span class="number">-2.5</span>)</span><br><span class="line"><span class="comment">//从2.5开始生成++的递增序列放入numbers</span></span><br><span class="line"><span class="comment">// Values are -2.5 -1.5 -0.5 0.5 1.5 2.5 3.5 4.5 5.5</span></span><br><span class="line"></span><br><span class="line">accumulate(numbers, numbers + <span class="number">5</span>, init)</span><br><span class="line"><span class="comment">//求number的数列和 + init</span></span><br><span class="line"></span><br><span class="line">inner_product(series1, series1 + <span class="number">5</span>, series2, init)</span><br><span class="line"><span class="comment">//求series1和series2的内积/叉积</span></span><br><span class="line"></span><br><span class="line">adjacent_difference(numbers, numbers + <span class="number">5</span>, result)</span><br><span class="line"><span class="comment">//求相邻两个元素差放入result中</span></span><br><span class="line"></span><br><span class="line">partial_sum(numbers, numbers + <span class="number">5</span>, result)</span><br><span class="line"><span class="comment">//求前缀和放入result中</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> val[] = &#123;<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>&#125;;</span><br><span class="line">partial_sum(val, val+<span class="number">5</span>, result, multiplies&lt;<span class="keyword">int</span>&gt;());</span><br><span class="line"><span class="comment">//求阶乘</span></span><br></pre></td></tr></table></figure>

<hr>
<h5 id="lt-utility-gt-二元组"><a href="#lt-utility-gt-二元组" class="headerlink" title="&lt; utility &gt; 二元组"></a>&lt; utility &gt; 二元组</h5><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">pair&lt;<span class="built_in">string</span>, <span class="keyword">int</span>&gt; planet;        <span class="comment">//定义一个&lt;string, int&gt;二元组</span></span><br><span class="line">pair&lt;int, double&gt; p1(1, 2.4);    //声明并初始化</span><br><span class="line">planet.first = <span class="string">"Earth"</span>;</span><br><span class="line">planet.second = <span class="number">6371</span>;            <span class="comment">//给二元组中的两个元素单独赋值</span></span><br><span class="line">planet = &#123;<span class="string">"Earth"</span>, <span class="number">6371</span>&#125;;        <span class="comment">//给二元组整体赋值</span></span><br><span class="line">p4 = make_pair(<span class="number">1</span>, <span class="number">2.4</span>);          <span class="comment">//赋值</span></span><br></pre></td></tr></table></figure>

<hr>
<h5 id="lt-string-gt-字符串"><a href="#lt-string-gt-字符串" class="headerlink" title="&lt; string &gt; 字符串"></a>&lt; string &gt; 字符串</h5><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">s.size()</span><br><span class="line">s.length()      <span class="comment">//字符串s的长度</span></span><br><span class="line">s.clear()       <span class="comment">//清空字符串s</span></span><br><span class="line">s.erase(a,b);   <span class="comment">//从下标a开始，删除b个字符</span></span><br><span class="line">s.find(s1)      <span class="comment">//返回字符串s1在s中第一次出现的位置，如果没有则返回-1</span></span><br><span class="line">s.rfind(s1)     <span class="comment">//返回字符串s1在s中最后一次出现的位置，如果没有则返回-1</span></span><br><span class="line">s.substr(a,b);  <span class="comment">//从下标a开始，生成长度为b的子串</span></span><br><span class="line"><span class="comment">//可以直接比较，字典序</span></span><br></pre></td></tr></table></figure>

<hr>
<h5 id="lt-bitset-gt-01数组"><a href="#lt-bitset-gt-01数组" class="headerlink" title="&lt; bitset &gt; 01数组"></a>&lt; bitset &gt; 01数组</h5><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">bitset</span>&lt;10000&gt; s;   <span class="comment">//定义一个10000位二进制数，&lt;&gt;中填写位数。</span></span><br><span class="line">~, &amp;, |, ^         <span class="comment">//按位与、或、异或</span></span><br><span class="line">&lt;&lt;、&gt;&gt;             <span class="comment">//左移、右移</span></span><br><span class="line">==、!=             <span class="comment">//比较两个bitset是否相等</span></span><br><span class="line">s[k]               <span class="comment">//表示s的第k位，最低位是第0位</span></span><br><span class="line">s.count()          <span class="comment">//返回s中有多少位为1。</span></span><br><span class="line">s.any()</span><br><span class="line">s.none()</span><br><span class="line"><span class="comment">//若s所有位都为0，则s.any()返回false，s.none()返回true</span></span><br><span class="line"><span class="comment">//若s至少一位为1，则s.any()返回true，s.none()返回false</span></span><br><span class="line">s.<span class="built_in">set</span>() / s.reset() / s.flip()</span><br><span class="line"><span class="comment">//把s的所有位变为1 / 变为0 / 取反</span></span><br></pre></td></tr></table></figure>

<hr>
<h5 id="lt-iterator-gt-迭代器"><a href="#lt-iterator-gt-迭代器" class="headerlink" title="&lt; iterator &gt; 迭代器"></a>&lt; iterator &gt; 迭代器</h5><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//迭代器为指针</span></span><br><span class="line"><span class="comment">//该头文件实际可以不带</span></span><br><span class="line"><span class="comment">//用迭代器it遍历容器中的元素（这里it是指向当前元素的指针）</span></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">auto</span> it = A.begin(); it != A.end(); it++) <span class="built_in">cout</span>&lt;&lt;*it&lt;&lt;<span class="built_in">endl</span>;</span><br></pre></td></tr></table></figure>

<hr>
<h5 id="lt-vector-gt-动态数组"><a href="#lt-vector-gt-动态数组" class="headerlink" title="&lt; vector &gt; 动态数组"></a>&lt; vector &gt; 动态数组</h5><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">vector</span>&lt;<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&gt; v;            <span class="comment">//二维整型动态数组</span></span><br><span class="line"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; v1[n];                <span class="comment">//包含n个元素，二维数组</span></span><br><span class="line"><span class="function"><span class="built_in">vector</span>&lt;<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&gt; <span class="title">v2</span><span class="params">(n, val)</span></span>;   <span class="comment">//包含n个元素，且值为val</span></span><br><span class="line"><span class="built_in">vector</span>&lt;<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&gt;::iterator it; <span class="comment">//迭代器</span></span><br><span class="line"><span class="comment">//可以以字典序进行比较</span></span><br><span class="line"></span><br><span class="line">v.push_back(a)             <span class="comment">//向尾端插入a</span></span><br><span class="line">v.emplace_back(a)          <span class="comment">//向尾端插入a，c++11优化版，可以自动组成pair</span></span><br><span class="line">v.pop_back()               <span class="comment">//删除尾端元素</span></span><br><span class="line">v.empty()                  <span class="comment">//为空返回真</span></span><br><span class="line">v.size()                   <span class="comment">//返回元素个数</span></span><br><span class="line">v.clear()                  <span class="comment">//清空</span></span><br><span class="line">v.front()                  <span class="comment">//返回首元素值的引用</span></span><br><span class="line">v.back()                   <span class="comment">//返回尾元素值的引用</span></span><br><span class="line">v.begin()                  <span class="comment">//首元素指针</span></span><br><span class="line">v.end()                    <span class="comment">//v的尾元素的下一位置指针</span></span><br><span class="line">v.rbegin()                 <span class="comment">//尾元素指针</span></span><br><span class="line">v.end()                    <span class="comment">//v的首元素上一位置指针</span></span><br><span class="line">v.insert(it,i)             <span class="comment">//在迭代器it位置插入插入元素i</span></span><br><span class="line">v.emplace(it,i)            <span class="comment">//在迭代器it位置插入插入元素i，优化版</span></span><br><span class="line">v1 = v2;                   <span class="comment">//用v2中的元素拷贝替换v1</span></span><br><span class="line">v[i][j]                    <span class="comment">//引用，但不能以此方法添加</span></span><br><span class="line">reverse(v.begin(),v.end());<span class="comment">//翻转数组</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//排序后可以二分查找，返回迭代器，指向第一个不小于k的元素，O(n)</span></span><br><span class="line">lower_bound(v.begin(), v.end(), k, cmp)  </span><br><span class="line"><span class="comment">//排序后可以二分查找，返回迭代器，指向第一个大于k的元素，O(n)</span></span><br><span class="line">upper_bound(v.begin(), v.end(), k, cmp)  </span><br><span class="line"></span><br><span class="line"><span class="comment">//将数组里的元素随机排列，概率相同，O(n)</span></span><br><span class="line">random_shuffle(v.begin(), v.end());</span><br><span class="line"></span><br><span class="line"><span class="comment">//元素去重并删除，需要先排序</span></span><br><span class="line">v.erase(unique(v.begin(), v.end()), v.end());</span><br></pre></td></tr></table></figure>

<hr>
<h5 id="lt-map-gt-映射表"><a href="#lt-map-gt-映射表" class="headerlink" title="&lt; map &gt; 映射表"></a>&lt; map &gt; 映射表</h5><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//map</span></span><br><span class="line"><span class="comment">//key-value组成，key唯一，升序排列</span></span><br><span class="line"><span class="comment">//value为数的时候，初始化可能不为0，需要clear（出现情况未知）</span></span><br><span class="line"><span class="comment">//遍历时key为const</span></span><br><span class="line"><span class="comment">//八倍常数</span></span><br><span class="line"><span class="comment">//不要使用数组下标m[i]进行访问，如果没有这个元素会自动创建，导致大小改变</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">map</span>&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; m = &#123; &#123;<span class="number">1</span>,<span class="number">3</span>&#125; &#125;;        <span class="comment">//初始化</span></span><br><span class="line">m.insert(&#123; <span class="number">2</span>,<span class="number">3</span> &#125;)                   <span class="comment">//插入元素</span></span><br><span class="line">m.insert(b, e)                      <span class="comment">//插入迭代器从b到e，返回值为成功数量</span></span><br><span class="line">m.emplcace(&#123; <span class="number">2</span>,<span class="number">3</span> &#125;)                 <span class="comment">//插入元素，优化版</span></span><br><span class="line">m[<span class="number">3</span>] = <span class="number">4</span>                            <span class="comment">//插入元素或者更改元素</span></span><br><span class="line">m.empty()                           <span class="comment">//为空返回真</span></span><br><span class="line">m.size()                            <span class="comment">//返回元素个数</span></span><br><span class="line">m.clear()                           <span class="comment">//清空</span></span><br><span class="line">m.find(k)                           <span class="comment">//寻找第一个关键值k，失败返回m.end()</span></span><br><span class="line">m.count(k)                          <span class="comment">//统计关键值k的数量</span></span><br><span class="line">m.begin()                           <span class="comment">//m的首元素（key值最小记录）指针</span></span><br><span class="line">m.end()                             <span class="comment">//m的尾元素（key值最大记录）的下一位置指针</span></span><br><span class="line">m.rbegin()                          <span class="comment">//m的尾元素（key值最大记录）指针</span></span><br><span class="line">m.rend()                            <span class="comment">//m的首元素（key值最小记录）的上一位置指针</span></span><br><span class="line">m.erase(k)                          <span class="comment">//删除元素k</span></span><br><span class="line"><span class="built_in">map</span>&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt;::iterator it;         <span class="comment">//迭代器，-&gt;first -&gt;second引用</span></span><br><span class="line">m.erase(it, it + <span class="number">5</span>);                <span class="comment">//删除元素并改变长度，删除后要重置迭代器，返回值为删除成功的数量</span></span><br><span class="line">m.lower_bound(k);                   <span class="comment">//二分查找，返回迭代器，指向第一个不小于k的元素</span></span><br><span class="line">m.upper_bound(k);                   <span class="comment">//二分查找，返回迭代器，指向第一个大于k的元素</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//unordered_map 无序的映射，基本同map</span></span><br><span class="line"><span class="built_in">unordered_map</span>&lt;<span class="keyword">int</span>&gt; m;</span><br><span class="line"></span><br><span class="line"><span class="comment">//multimap 可重复的映射，一个key值对应多个value，并存放在一起，基本同map</span></span><br><span class="line"><span class="built_in">multimap</span>&lt;<span class="keyword">int</span>&gt; m;</span><br><span class="line">m.equal_range(x);                   <span class="comment">//返回pair(x,y) ,x对应value的开始迭代器，y对应value的结束迭代器，左闭右开</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//unordered_multimap 无序可重复的映射，基本同map</span></span><br><span class="line"><span class="built_in">unordered_multimap</span>&lt;<span class="keyword">int</span>&gt; m;</span><br></pre></td></tr></table></figure>

<hr>
<h5 id="lt-set-gt-集合"><a href="#lt-set-gt-集合" class="headerlink" title="&lt; set &gt; 集合"></a>&lt; set &gt; 集合</h5><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//set</span></span><br><span class="line"><span class="comment">//key组成，key唯一，升序排列</span></span><br><span class="line"><span class="comment">//遍历时key为const</span></span><br><span class="line"><span class="built_in">set</span>&lt;<span class="keyword">int</span>&gt; s = &#123; <span class="number">1</span>,<span class="number">3</span> &#125;      <span class="comment">//初始化</span></span><br><span class="line"><span class="built_in">set</span>&lt;<span class="keyword">int</span>,less&lt;<span class="keyword">int</span>&gt;&gt; s;     <span class="comment">//初始化降序排列</span></span><br><span class="line"><span class="built_in">set</span>&lt;<span class="keyword">int</span>,greater&lt;<span class="keyword">int</span>&gt;&gt; s;  <span class="comment">//初始化升序排列</span></span><br><span class="line">s.insert(&#123; <span class="number">2</span>,<span class="number">3</span> &#125;)         <span class="comment">//插入元素</span></span><br><span class="line">s.emplcace(&#123; <span class="number">2</span>,<span class="number">3</span> &#125;)       <span class="comment">//插入元素，优化版</span></span><br><span class="line">s.insert(b, e)            <span class="comment">//插入迭代器从b到e，返回值为成功数量</span></span><br><span class="line">s.empty()                 <span class="comment">//为空返回真</span></span><br><span class="line">s.size()                  <span class="comment">//返回元素个数</span></span><br><span class="line">s.clear()                 <span class="comment">//清空</span></span><br><span class="line">s.find(k)                 <span class="comment">//寻找第一个关键值k，失败返回s.end()</span></span><br><span class="line">s.count(k)                <span class="comment">//统计关键值k的数量</span></span><br><span class="line">s.begin()                 <span class="comment">//s的首元素（最小元素）指针</span></span><br><span class="line">s.end()                   <span class="comment">//s的尾元素（最大元素）的下一位置指针</span></span><br><span class="line">s.rbegin()                <span class="comment">//s的尾元素（最大元素）指针</span></span><br><span class="line">s.rend()                  <span class="comment">//s的首元素（最小元素）的上一位置指针</span></span><br><span class="line"><span class="built_in">set</span>&lt;<span class="keyword">int</span>&gt;::iterator it；   <span class="comment">//迭代器</span></span><br><span class="line">s.erase(it, it + <span class="number">5</span>)       <span class="comment">//删除元素并改变长度，删除后需重置迭代器，返回值为删除成功的数量</span></span><br><span class="line">s.lower_bound(k)          <span class="comment">//二分查找，返回迭代器，指向第一个不小于k的元素</span></span><br><span class="line">s.upper_bound(k)          <span class="comment">//二分查找，返回迭代器，指向第一个大于k的元素</span></span><br><span class="line">set_union(A.begin(), A.end(), B.begin(), B.end(), C.begin())</span><br><span class="line"><span class="comment">//将集合A和集合B取并集存入集合C中，记得清空用于存放的集合</span></span><br><span class="line">set_intersection(A.begin(), A.end(), B.begin(), B.end(), C.begin())</span><br><span class="line"><span class="comment">//将集合A和集合B取交集存入集合C中，记得清空用于存放的集合</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//unordered_set 无序的集合，基本同set</span></span><br><span class="line"><span class="built_in">unordered_set</span>&lt;<span class="keyword">int</span>&gt; s = &#123; <span class="number">1</span>,<span class="number">3</span> &#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">//multiset 可重复的集合，基本同set</span></span><br><span class="line"><span class="built_in">multiset</span>&lt;<span class="keyword">int</span>&gt; s = &#123; <span class="number">1</span>,<span class="number">3</span>,<span class="number">3</span> &#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">//unordered_multiset 无序可重复的集合，基本同set</span></span><br><span class="line"><span class="built_in">unordered_multiset</span>&lt;<span class="keyword">int</span>&gt; s = &#123; <span class="number">1</span>,<span class="number">3</span>,<span class="number">3</span> &#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">//自定义set，需要重载运算符</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">set_type</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="keyword">int</span> num;</span><br><span class="line">    <span class="keyword">friend</span> <span class="keyword">bool</span> <span class="keyword">operator</span> &lt; (<span class="keyword">const</span> set_type&amp; x, <span class="keyword">const</span> set_type&amp; y)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> x.num &lt; y.num;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="built_in">set</span>&lt;set_type&gt; s;</span><br></pre></td></tr></table></figure>

<hr>
<h5 id="lt-stack-gt-栈"><a href="#lt-stack-gt-栈" class="headerlink" title="&lt; stack &gt; 栈"></a>&lt; stack &gt; 栈</h5><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">stack</span>&lt;<span class="keyword">int</span>&gt; s;  <span class="comment">//定义一个int类型的栈</span></span><br><span class="line">s.push(x)      <span class="comment">//将元素x压入栈顶</span></span><br><span class="line">s.pop()        <span class="comment">//弹出栈顶元素</span></span><br><span class="line">s.top()        <span class="comment">//访问栈顶元素</span></span><br><span class="line">s.empty()      <span class="comment">//判断栈s是否为空</span></span><br><span class="line">s.size()       <span class="comment">//栈s中的元素个数</span></span><br></pre></td></tr></table></figure>

<hr>
<h5 id="lt-queue-gt-队列"><a href="#lt-queue-gt-队列" class="headerlink" title="&lt; queue&gt; 队列"></a>&lt; queue&gt; 队列</h5><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//先进先出队列</span></span><br><span class="line"><span class="built_in">queue</span>&lt;<span class="keyword">int</span>&gt; q;   <span class="comment">//定义一个int类型的队列</span></span><br><span class="line">q.push(x)       <span class="comment">//将元素x放入队尾</span></span><br><span class="line">q.pop()         <span class="comment">//移除队首元素</span></span><br><span class="line">q.front()       <span class="comment">//访问队首元素</span></span><br><span class="line">q.back()        <span class="comment">//访问队尾元素</span></span><br><span class="line">q.empty()       <span class="comment">//判断队列q是否为空</span></span><br><span class="line">q.size()        <span class="comment">//队列q中的元素个数</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//优先队列/堆</span></span><br><span class="line"><span class="comment">//int类型，大的优先，从大到小取出数值的优先队列（堆）</span></span><br><span class="line">priority_queue&lt;<span class="keyword">int</span>&gt; q;</span><br><span class="line"><span class="comment">//int类型，小的优先，从小到大取出数值的优先队列（堆）</span></span><br><span class="line">priority_queue&lt;<span class="keyword">int</span>, <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;, greater&lt;<span class="keyword">int</span>&gt;&gt; q;</span><br><span class="line"><span class="comment">//int类型，小的优先，自定义顺序</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">cmp1</span> &#123;</span> <span class="function"><span class="keyword">bool</span> <span class="title">operator</span> <span class="params">()</span><span class="params">(<span class="keyword">int</span> &amp;a, <span class="keyword">int</span> &amp;b)</span> </span>&#123; <span class="keyword">return</span> a &gt; b; &#125; &#125;;</span><br><span class="line">priority_queue&lt;<span class="keyword">int</span>, <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;, cmp1&gt;pq3;</span><br><span class="line"></span><br><span class="line"><span class="keyword">auto</span> cmp = [](<span class="keyword">const</span> <span class="keyword">auto</span>&amp; x, <span class="keyword">const</span> <span class="keyword">auto</span>&amp; y)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">return</span> x.first &gt; y.first;</span><br><span class="line">&#125;;</span><br><span class="line">priority_queue&lt;pair&lt;int, int&gt;, vector&lt;pair&lt;int, int&gt;&gt;, decltype(cmp)&gt; pq(cmp);</span><br><span class="line"></span><br><span class="line">q.push(x)       <span class="comment">//将元素x放入队列（堆）中</span></span><br><span class="line">q.pop()         <span class="comment">//移除堆顶元素</span></span><br><span class="line">q.top()         <span class="comment">//访问堆顶元素</span></span><br><span class="line">q.empty()       <span class="comment">//判断堆q是否为空</span></span><br><span class="line">q.size()        <span class="comment">//堆q中的元素个数</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//deque 双向队列</span></span><br><span class="line"><span class="comment">//两边都是开口的，均可进可出</span></span><br><span class="line"><span class="comment">//基本操作同queue</span></span><br><span class="line"><span class="built_in">deque</span>&lt;<span class="keyword">int</span>&gt; dq;</span><br><span class="line">dq.front()              <span class="comment">//访问首端元素</span></span><br><span class="line">dq.back()               <span class="comment">//访问尾端元素</span></span><br><span class="line">dq.push_front(i)        <span class="comment">//首端压入i</span></span><br><span class="line">dq.emplace_front(i)     <span class="comment">//首端压入i，c++11优化版</span></span><br><span class="line">dq.push_back(i)         <span class="comment">//尾端压入i</span></span><br><span class="line">dq.emplace_back(i)      <span class="comment">//尾端压入i，c++11优化版</span></span><br><span class="line">dq.pop_fron()           <span class="comment">//首端弹出元素</span></span><br><span class="line">dq.pop_back()           <span class="comment">//尾端弹出元素</span></span><br></pre></td></tr></table></figure>

<hr>
<h3 id="Python"><a href="#Python" class="headerlink" title="Python"></a>Python</h3><h4 id="输入"><a href="#输入" class="headerlink" title="输入"></a>输入</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#存放列表</span></span><br><span class="line">a=[]</span><br><span class="line"></span><br><span class="line"><span class="comment">#整数</span></span><br><span class="line"><span class="keyword">for</span> x <span class="keyword">in</span> input().split():</span><br><span class="line">    a.append(int(x))</span><br><span class="line"></span><br><span class="line"><span class="comment">#浮点数</span></span><br><span class="line"><span class="keyword">for</span> x <span class="keyword">in</span> input().split():</span><br><span class="line">    a.append(float(x))</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line"><span class="comment">#读</span></span><br><span class="line"><span class="keyword">with</span> open(<span class="string">'C:/Users/dongs/Desktop/qwer.txt'</span>, <span class="string">'r'</span>, encoding = <span class="string">'utf-8'</span>) <span class="keyword">as</span> cin:</span><br><span class="line">    L = cin.readlines()</span><br><span class="line">    <span class="keyword">for</span> lines <span class="keyword">in</span> L:</span><br><span class="line">        x = lines.split()[<span class="number">-1</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment">#写</span></span><br><span class="line"><span class="keyword">with</span> open(<span class="string">'C:/Users/dongs/Desktop/test.txt'</span>, <span class="string">'w'</span>, encoding = <span class="string">'utf-8'</span>) <span class="keyword">as</span> cout:</span><br><span class="line">    cout.write(<span class="string">'!'</span>)</span><br></pre></td></tr></table></figure>

<hr>
<h3 id="留坑"><a href="#留坑" class="headerlink" title="留坑"></a>留坑</h3><ul>
<li>尺取法</li>
<li>威佐夫</li>
<li>nim K</li>
<li>容斥原理</li>
<li>隔板法</li>
<li>斯特林数（第一类第二类）</li>
<li>矩阵快速幂</li>
<li>高斯消元</li>
<li>等价类计数</li>
<li>卡特兰数应用</li>
<li>Lucas定理</li>
<li>莫比乌斯反演</li>
<li>矩阵运算</li>
<li>矩阵快速幂</li>
<li>母函数</li>
<li>NTT</li>
<li>回文自动机</li>
<li>莫比乌斯 函数 反演</li>
<li>字典树</li>
<li>线段树</li>
<li>堆</li>
</ul>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">make_heap(v.begin(),v.end(), cmp);<span class="comment">//创建堆，无cmp时默认大根堆</span></span><br><span class="line">sort_heap(v.begin(),v.end());     <span class="comment">//堆排序</span></span><br><span class="line">push_heap(v.begin(),v.end());     <span class="comment">//先push一个元素到v的最后，再调用该函数</span></span><br><span class="line">pop_heap(v.begin(),v.end());      <span class="comment">//把堆顶元素和最后一个元素，然后维护堆，对顶元素仍可访问</span></span><br></pre></td></tr></table></figure>

<hr>
</div><div class="post-footer"><div class="meta"><div class="info"><i class="fa fa-sun-o"></i><span class="date">2023-04-23</span><i class="fa fa-tag"></i><a class="tag" href="/tags/Leetcode/" title="Leetcode">Leetcode </a><a class="tag" href="/tags/Some-Useful-Documents/" title="Some Useful Documents">Some Useful Documents </a></div></div></div></div><div class="share"><div class="weibo"><a class="fa fa-weibo" href="javascript:void((function(s,d,e){try{}catch(e){}var f='http://service.weibo.com/share/share.php?',u=d.location.href,p=['url=',e(u),'&amp;title=',e(d.title),'&amp;appkey=2924220432'].join('');function a(){if(!window.open([f,p].join(''),'mb',['toolbar=0,status=0,resizable=1,width=620,height=450,left=',(s.width-620)/2,',top=',(s.height-450)/2].join('')))u.href=[f,p].join('');};if(/Firefox/.test(navigator.userAgent)){setTimeout(a,0)}else{a()}})(screen,document,encodeURIComponent));"></a></div><div class="twitter"><a class="fa fa-twitter" href="https://twitter.com/intent/tweet?url=https://ry.huaji.store/2023/04/Some-useful-documents-template/&amp;text=一些有用的文档：2020-5-12 %版 · 无存在感小透明" target="_blank" rel="noopener"></a></div></div><div class="pagination"><ul class="clearfix"><li class="pre pagbuttons"><a class="btn" role="navigation" href="/2023/06/Sunday/" title="周日">上一篇</a></li><li class="next pagbuttons"><a class="btn" role="navigation" href="/2023/04/Some-useful-documents-git-tips/" title="一些有用的文档：Git Tips">下一篇</a></li></ul></div><a id="comments"></a><div id="vcomments" style="margin:0 30px;"></div><span class="leancloud_visitors" id="/2023/04/Some-useful-documents-template/" data-flag-title="一些有用的文档：2020-5-12 %版"></span><script src="//cdn.jsdelivr.net/npm/leancloud-storage@4.15.2/dist/av-min.js"></script><script src="//cdn.jsdelivr.net/npm/valine@1.5.3/dist/Valine.min.js"></script><script>var valine = new Valine({
  el:'#vcomments',
  appId:'CV2PYOHXSB2oApmkqHGUKSzj-MdYXbMMI',
  appKey:'RcyttO7brDSawuxt4FfSUtPM',
  placeholder:'中国有句古话叫「闷声大发财」，但是见到你们这样热情，一句话不说也不好，你说是吧？',
  avatar:'identicon',
  visitor:'true',
  recordIP:'true',
  serverURLs:'https://valine.huaji.store',
  meta:['nick','mail','link'],
  requiredFields:['nick','mail']
})

</script></div></div></div></div><script src="/js/jquery.js"></script><script src="/js/jquery-migrate-1.2.1.min.js"></script><script src="/js/jquery.appear.js"></script></body></html>